<div id="S001" class="NLM_sec NLM_sec-type_intro NLM_sec_level_1">
 <h2 id="_i2" class="section-heading-2">1. Introduction</h2>
 <p>HVAC systems account for 20% of the total primary energy consumption in Major Economies Forum (MEF) countries (Metrics&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0031" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2015</a></span>). Therefore, advanced controls for those systems can help reduce environmental impact as well as help renewable penetration by unlocking load flexibility potential in buildings (Roth et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0040" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2002</a></span>; del Mar Castilla et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0012" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2014</a></span>). For the last decades there has been a lot of research on advanced control, including Model Predictive Control (MPC), for the optimal operation of building HVAC systems (Drgoňa et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0013" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2020</a></span>; Kathirgamanathan et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0019" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2021</a></span>; Rockett and Hathway&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0039" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2017</a></span>).</p>
 <p>For MPC, the optimal control problem can be formulated mathematically in a variety of different ways, even for identical HVAC systems. The primary reasons for the variety include:</p>
 <ul class="NLM_list NLM_list-list_type-bullet">
  <li><p class="inline">A general optimization problem could have multiple <i>equivalent</i><span class="ref-lnk fn-ref-lnk lazy-ref"><a data-rid="EN0001" href="#" data-reflink="fn"><span class="off-screen">Footnote</span><sup>1</sup></a></span> problems, e.g. by introducing slack variables, elimination procedure, hard or soft constraints and the epigraph problem formulation (Boyd, Boyd, and Vandenberghe&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0007" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2004</a></span>).</p></li>
  <li><p class="inline">There are various approximation techniques, e.g. the McCormick convex relaxation of a bilinear function (McCormick&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0030" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>1976</a></span>), piecewise linear approximation for a nonlinear function, and linear programming (LP) relaxation of a mixed integer linear program (MILP), which relaxes the integer constraints.</p></li>
  <li><p class="inline">MPC itself has different theoretical approaches, such as centralized versus decentralized/distributed or stochastic versus deterministic.</p></li>
  <li><p class="inline">The objective and constraints of a MPC can be formulated in different ways regarding the quantification, relative importance, and constraints on energy use, carbon emissions, energy cost, load flexibility, and thermal comfort.</p></li>
  <li><p class="inline">Each component of an HVAC system can be modelled in several ways, which affects the performance of the prediction accuracy, robustness and computing time. For example, modelling the Coefficient of Performance (COP) of an air to water heat pump ranges from the constant COP approach to the DOE-2 (Research Group LBL, S&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0037" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>1991</a></span>) like performance mapping as a function of part load ratio, outdoor air temperature and supply water temperature.</p></li>
  <li><p class="inline">The selection of MPC optimization variables is a control design factor. For example, one may select either controllable inputs that are the same as those of the physical system, such as percent valve position, or that are abstracted from the system model, such as heat flow rates. In the latter case, a strategy is needed to convert optimal solutions to control inputs that are available in the physical system.</p></li>
 </ul>
 <p></p>
 <p>The significance of these variations of MPC formulations is that they could change not only the accuracy/physical reliability of a model and computation time, but also the class of optimization problems (e.g. from convex to nonconvex, from NLP to LP or MILP, and vice versa), affecting mathematical properties of global optimality, feasibility, uniqueness of a solution, convergence of numerical optimization algorithms, and MPC closed-loop stability. Consequently, it could considerably impact the overall MPC performance (e.g. energy consumption, comfort, computational time, and the rate of change of control inputs). As a consequence, a significant amount of time could be spent iterating to identify the most suitable optimization formulation for each HVAC system. Despite this importance, there are very few well-documented papers that investigate different MPC formulations. This is especially true for non convex MINL MPC, which is one of the most natural and straightforward ways to formulate optimal control problems for many HVAC applications. This paper tries to partially fill this gap in the literature by providing comparisons of multiple MPC formulations for an HVAC system that has both binary and continuous control variables. In addition, this paper investigates the practical applicability of MINL MPC approaches, but not MILP and more in general Mixed Integer Convex Programming (MICP) problems. The reasons for excluding MICP are twofold. First Mixed Integer Linear (MIL) and Mixed Integer Convex (MIC) problems can be solved reliably with commercial and open source tools. Second, there are several ways to approximate an MINLP into an MICP or MILP, such as piecewise linearization or McComik methods. Therefore, to avoid dispersing the manuscript focus, a separate work should be carried out to test the different approximation methods on building HVAC control related problems.</p>
 <p>Section&nbsp;<a href="#S002">2</a> reports the case study details, MPC formulations, optimization solvers and the co-simulation setup. Section&nbsp;<a href="#S003">3</a> presents the results for the MPC formulations comparison. Finally, Section&nbsp;<a href="#S004">4</a> reports the main conclusions of this study.</p>
 <div id="S001-S2001" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i3">1.1. Literature review</h3>
  <p>Equivalent formulations for building applications can be found in many papers. One example is when peak demand is considered in a control objective. This approach replaces the maximum power or demand cost over a prediction horizon with linear constraints and a slack variable, namely the target peak or demand cost (ASHRAE <span class="ref-lnk lazy-ref"><a data-rid="CIT0002" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2019</a></span>, Chapter 43). Depending on applications, this approach could convert NLP to LP or MINLP to MILP (Kim and Braun&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0020" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2018</a></span>).</p>
  <p>Approximation techniques have also been widely applied to HVAC systems. Risbeck et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0038" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2017</a></span>) applied a piecewise linearization technique for optimal scheduling of operations of chillers, pumps, cooling towers, boilers and thermal energy storages. The introduced approach approximates a nonlinear chiller performance map with a set of piecewise linear models, converting MINLP to MILP. Kim et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0021" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2015</a></span>) applied a linear programming relaxation approach that relaxes integer constraints for coordinating operations of multiple rooftop units. This approach converts an IP to LP for better computation efficiency. Atam and Helsen&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0003" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2015</a></span>) applied a convex relaxation technique to handle the bilinearity that naturally appears in thermal energy systems. The proposed method converts a nonconvex optimization problem to a convex problem to ensure global optimality.</p>
  <p>Considering MPC architecture and the theoretical approach, Scherer et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0041" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2014</a></span>) and Walker et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0047" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2017</a></span>) compared centralized and distributed MPC architectures, highlighting that distributed approaches have slightly worse KPI performance but better computational time. Oldewurtel et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0032" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2012</a></span>), Drgoňa et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0015" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2013</a></span>), Ma, Matuško, and Borrelli&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0028" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2014</a></span>) and Maasoumy et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0029" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2014</a></span>) compared deterministic versus robust or stochastic MPC, showing that a robust or stochastic MPC performs better in scenarios of high uncertainty and is comparable in other cases. Rather than focussing on architecture and theoretical approach, Cigler et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0010" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2013</a></span>) and Drgona and Kvasnica&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0014" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2013</a></span>) instead analysed the formulation of the MPC problem, focusing on different cost functions and constraints, assessing which formulations are more robust and computationally efficient, but limiting their analysis to LP, QP and MILP.</p>
  <p>Considerable effort was also put into analysing different building envelope thermal modelling approaches. Prívara et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0036" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2013</a></span>) compared several black-box and grey-box model structures to model building envelope systems and concluded that black box models are more computationally efficient for larger case studies but become less reliable for longer prediction horizons. Sourbron, Verhelst, and Helsen&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0044" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2013</a></span>) analysed the effects of grey box model order on the performance of MPC for concrete core activated buildings. Blum et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0004" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2019</a></span>) also shows that model order has a strong influence on the model quality. Furthermore, Blum et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0004" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2019</a></span>) identified seven factors that play an important role in the accuracy of the building envelope model. Picard et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0034" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2017</a></span>) and Picard et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0035" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2016</a></span>) show that a purely physical driven white box approach can be viable in certain building types. Kim et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0022" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2016</a></span>,&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0023" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2018</a></span>) pointed out that a typical identification algorithm with any model structure would likely result in a biased model when significant unmeasured disturbances (e.g. unmeasured internal heat gain, in/exfiltration, door/window openings, zonal plug load) presented in a training dataset, and proposed a new identification approach for a typical grey box model structure to mitigate this negative effect.</p>
  <p>Drgoňa et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0013" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2020</a></span>) and Serale et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0042" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2018</a></span>) provided comprehensive reviews on building MPC literature. For the papers that they reviewed, many works address the benefit and applicability of their own MPC formulations compared with rule-based controls. Less comprehensive work is available on comparisons between different HVAC modelling approaches, optimization variable choices, and their impacts on the resulting MPC performance. Verhelst et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0045" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2012</a></span>) performed an extensive analysis of different COP formulations in the MPC problem leading to LP and NLP problems, highlighting the potential benefit of a nonlinear formulation. Pčolka et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0033" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2016</a></span>) compares a linear time invariant MPC, a linear time variant and a nonlinear MPC in a case study for a heat pump and domestic hot water system. It reports that the nonlinear solution is the best, but the linear time variant gets close and remains more robust. In both studies of Pčolka et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0033" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2016</a></span>) and Verhelst et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0045" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2012</a></span>), binary variables were not taken into account to avoid MILNP formulations, although MINLP arises fairly naturally when dealing with HVAC systems. Indeed, very few studies can be found comparing MINLP with other formulations. To the authors' knowledge, only Burger et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0008" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2018</a></span>) introduces a custom MINLP solver compared with Bonami et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0006" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2008</a></span>) for a solar thermal system. Furthermore, it is hard to cross-compare to different works due to the unique case study system and lack of common metrics.</p>
 </div>
 <div id="S001-S2002" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i4">1.2. Objectives and contributions</h3>
  <p>This work aims to partially fill this literature gap by presenting comparisons of ten MPC formulations with a greater focus on MINL MPCs, for a relatively common HVAC system that requires control decisions on valve on/off and supply water temperature setpoint. The diversity of formulations is due to two issues that appear in a broad range of HVAC systems: (1) the nonlinearity arising from modelling heat pump COP and (2) the binary on-off physical control inputs for distribution circuit valves. Depending on modelling and approximation approaches to handle them, the resulting optimal control problem formulations become QP, NLP or MINLP. Each formulation encompasses a trade-off between accuracy in the prediction, robustness to find an optimal solution, computational requirements, the rate of change of control inputs, energy consumption, and comfort violation.</p>
  <p>The contributions of this paper are:</p>
  <ul class="NLM_list NLM_list-list_type-bullet">
   <li><p class="inline">Present a well-documented work on how HVAC performance can vary with MPC formulations</p></li>
   <li><p class="inline">Understand the benefits of increased prediction accuracy from increased model complexity and the corresponding trade-offs</p></li>
   <li><p class="inline">Introduce a new Key Performance Indicator (KPI) to quantify the rate of change of a control input</p></li>
   <li><p class="inline">Survey, introduce, and test available optimization solvers of each problem formulation, especially novel MINLP-specific solvers, that were not comprehensively investigated, but could potentially be useful for typical building HVAC optimal control problems</p></li>
   <li><p class="inline">Share lessons-learned for designing MINL MPC</p></li>
  </ul>
  <p></p>
 </div>
</div>
<div id="S002" class="NLM_sec NLM_sec_level_1">
 <h2 id="_i5" class="section-heading-2">2. Methodology</h2>
 <div id="S002-S2001" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i6">2.1. Case study description</h3>
  <p>The chosen case study is a newly built two-room apartment in Milan, Italy. The HVAC system is a two-circuit radiant floor heating system connected to an air source heat pump. A diagram of the HVAC system is presented in Figure&nbsp;<a href="#F0001">1</a>.</p>
  <div class="figure figureViewer" id="F0001">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>16 September 2022
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 1. </span> Scheme of the case study HVAC.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0001image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/medium/tbps_a_2120631_f0001_ob.jpg" loading="lazy" height="440" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0001">
   <p class="captionText"><span class="captionLabel">Figure 1. </span> Scheme of the case study HVAC.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0001">
   <div class="figureFootNote-F0001"></div>
  </div>
  <p></p>
  <p>Each thermal zone is independently controlled via its own on/off valve. The pump works with a constant head tuned to provide the nominal water mass flow rate to each floor heating circuit when a valve is open. Control decisions are the two valves' statuses and the heat pump supply water set point. Despite its simplicity, the case study includes the HVAC hydronic system components that allow for several optimal control models, and lead to three different optimization problem classes to be solved: QP, NLP, and MINLP.</p>
  <p>The emulator model for the apartment and HVAC system was developed in Modelica using the IBPSA 3.0 (master branch commit 8a0d237) (Wetter, Blum, and Hu&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0048" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2019</a></span>), Buildings 8.0 (master branch commit 69bb7cf) (Wetter et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0049" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2014</a></span>) and IDEAS 2.2.1 (master branch commit 32860ea) (Jorissen et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0018" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2018</a></span>) libraries. The MPC algorithms were implemented using the Python-based optimization modelling language Pyomo (Bynum et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0009" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2021</a></span>). Finally the various MPC formulations were co-simulated with the emulator model thanks to the Application Performance Interfaces (APIs) and run-time environment provided by the BOPTEST software framework (Blum et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0005" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2021</a></span>), which also provides as output a standard subset of KPIs, including thermal discomfort, energy consumption, cost of the energy and computational time ratio. In this way, it will be possible to consistently compare all MPC formulations on the same emulator, highlight the pros and cons of each approach, and make the emulator publicly available for continued usage and further comparison of control approaches.</p>
 </div>
 <div id="S002-S2002" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i8">2.2. Introduction of optimization solvers</h3>
  <p>Different solvers and not different algorithms were compared on the same platform because comparing the solvers can be considered the state of the art of available algorithmic implementations, while a custom implementation could be criticized. Furthermore, great care was taken in choosing the optimization and co-simulation toolchain to make the comparison as fair as possible. Pyomo allows to easily couple different solvers through the AMPL interface (AMPL&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0001" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2003</a></span>) which is supported by a wide variety of solvers. Table&nbsp;<button class="ref showTableEventRef" data-id="T0001">1</button> summarizes all the solver used for the study.</p>
  <div class="tableViewerArticleInfo hidden">
   <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>16 September 2022
    </div>
   </div>
  </div>
  <div class="tableView">
   <div class="tableCaption">
    <div class="short-legend">
     <h3><p class="captionText"><span class="captionLabel">Table 1. </span> Optimization solver summary.</p></h3>
    </div>
   </div>
   <div class="tableDownloadOption" data-hascsvlnk="true" id="T0001-table-wrapper">
    <a class="downloadButton btn btn-sm" role="button" href="/action/downloadTable?id=T0001&amp;doi=10.1080%2F19401493.2022.2120631&amp;downloadType=CSV"> Download CSV</a><a data-id="T0001" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
   </div>
  </div>
  <p></p>
  <p>The QP and NLP solver, IPOPT (Wachter&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0046" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2002</a></span>) was chosen due to the popularity and widespread usage. IPOPT uses MA57 as linear subsolver. The MINLP solvers were chosen by looking at the results from Kronqvist et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0025" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2019</a></span>), which analysed solver performance on a set of 335 convex MINLP problems and included both open source and commercial solvers. The subset of solvers chosen for this study includes some of the best performing and most popular choices for open source and commercial alternatives. BONMIN (Bonami et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0006" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2008</a></span>) is an open source project belonging to the project COIN-OR foundation (COIN-OR Foundation&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0011" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2006</a></span>), as does IPOPT, and it is a MINLP solver mainly used for convex MINLP problems. MINLP solvers divide the optimization problem into a MILP or MIQP problem and NLP sub problems. In our setup, BONMIN uses CBC (Forrest and Lougee-Heimer&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0016" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2005</a></span>) as the MIQP subsolver and IPOPT as the NLP solver. In particular, two algorithms are tested from BONMIN. The first is BONMIN-BB, which uses a variation of the Branch and Bound algorithm to convert the problem. The second one is BONMIN-Hyb, which is a hybrid approach between Branch and Cut and Outer Approximation algorithms, which is faster than BONMIN-BB, but suffers more from the issue of falling into a local minima when the objective function is not convex. As a commercial alternative, Baron (Kılınç and Sahinidis&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0024" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2018</a></span>) was used since, differently from BONMIN, it should be able to guarantee a close to global optimum even when the objective function is not convex. Baron uses a variation of the Branch and Bound algorithm to reduce the MINLP problem into a subset of NLP problems and a MIQP problem. The MIQP solver is CPLEX and the NLP solver is IPOPT. Lastly an open source alternative to Baron, SCIP, is also tested, which is a global solver that uses a variation of the Branch and Bound algorithm. In our setup, SCIP uses CBC as the MIQP subsolver and IPOPT as the NLP solver.</p>
 </div>
 <div id="S002-S2003" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i9">2.3. Emulator model</h3>
  <p>In Figure&nbsp;<a href="#F0002">2</a>, a schematic of the apartment is presented, while in Figures&nbsp;<a href="#F0003 F0004 F0005">3–5</a>, the yearly frequency plot of the dry bulb temperature, humidity ratio and global horizontal radiation for the location (Milan, Italy) are shown. Milan can be considered a continental temperate humid climate. The maximum T<span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0001.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0001.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi></mi>
      <mrow>
       <mi>
        D
       </mi>
       <mi>
        r
       </mi>
       <mi>
        y
       </mi>
       <mi>
        B
       </mi>
       <mi>
        u
       </mi>
       <mi>
        l
       </mi>
       <mi>
        b
       </mi>
      </mrow>
     </msub>
    </math></span> is 32 [<span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0002.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0002.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msup>
      <mrow></mrow>
      <mrow>
       <mo>
        ∘
       </mo>
      </mrow>
     </msup><mrow>
      <mi mathvariant="normal">
       C
      </mi>
     </mrow>
    </math></span>], the minimum is −7.4 [<span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0003.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0003.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msup>
      <mrow></mrow>
      <mrow>
       <mo>
        ∘
       </mo>
      </mrow>
     </msup><mrow>
      <mi mathvariant="normal">
       C
      </mi>
     </mrow>
    </math></span>] and the average 11.7 [<span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0004.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0004.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msup>
      <mrow></mrow>
      <mrow>
       <mo>
        ∘
       </mo>
      </mrow>
     </msup><mrow>
      <mi mathvariant="normal">
       C
      </mi>
     </mrow>
    </math></span>]. In Figure&nbsp;<a href="#F0006">6</a>, a brief validation of the emulator model is shown, which used experimental data coming from a globe thermometer positioned in the centre of the living room, while the boundary conditions were determined from local weather stations and localized forecast services. For an in depth description of the envelope, the reader can access the test case (two zone hydronic apartment) documentation at the BOPTEST repository <a class="ext-link" href="https://github.com/ibpsa/project1-boptest/pull/411" target="_blank">Two zone hydronic apartment</a> (IBPSA&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0017" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2019</a></span>). In Table&nbsp;<button class="ref showTableEventRef" data-id="T0002">2</button>, a summary of the main features of the case study is reported.</p>
  <div class="figure figureViewer" id="F0002">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>16 September 2022
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 2. </span> Case study apartment scheme.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0002image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/medium/tbps_a_2120631_f0002_oc.jpg" loading="lazy" height="413" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0002">
   <p class="captionText"><span class="captionLabel">Figure 2. </span> Case study apartment scheme.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0002">
   <div class="figureFootNote-F0002"></div>
  </div>
  <div class="figure figureViewer" id="F0003">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>16 September 2022
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 3. </span> Dry Bulb temperature yearly frequency for Milan typical year weather data.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0003image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/medium/tbps_a_2120631_f0003_ob.jpg" loading="lazy" height="368" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0003">
   <p class="captionText"><span class="captionLabel">Figure 3. </span> Dry Bulb temperature yearly frequency for Milan typical year weather data.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0003">
   <div class="figureFootNote-F0003"></div>
  </div>
  <div class="figure figureViewer" id="F0004">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>16 September 2022
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 4. </span> Humidity ratio yearly frequency for Milan typical year weather data.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0004image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/medium/tbps_a_2120631_f0004_ob.jpg" loading="lazy" height="363" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0004">
   <p class="captionText"><span class="captionLabel">Figure 4. </span> Humidity ratio yearly frequency for Milan typical year weather data.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0004">
   <div class="figureFootNote-F0004"></div>
  </div>
  <div class="figure figureViewer" id="F0005">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>16 September 2022
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 5. </span> Global horizontal radiation yearly frequency for Milan typical year weather data.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0005image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/medium/tbps_a_2120631_f0005_ob.jpg" loading="lazy" height="368" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0005">
   <p class="captionText"><span class="captionLabel">Figure 5. </span> Global horizontal radiation yearly frequency for Milan typical year weather data.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0005">
   <div class="figureFootNote-F0005"></div>
  </div>
  <div class="figure figureViewer" id="F0006">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>16 September 2022
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 6. </span> Validation of the living room mean radiant temperature for a week free floating experiment in September. TSIM corresponds to the simulation temperature and TEXP corresponds to the experimental measurement done with a globe thermometer. The dashed line <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0005.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0005.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mo>
          ±
         </mo><mn>
          0.5
         </mn>
        </math></span> (<span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0006.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0006.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msup>
          <mrow></mrow>
          <mrow>
           <mo>
            ∘
           </mo>
          </mrow>
         </msup><mrow>
          <mi mathvariant="normal">
           C
          </mi>
         </mrow>
        </math></span>)corresponds to an estimation of the error the instrument, namely <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0007.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0007.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mo>
          ±
         </mo><mn>
          0.25
         </mn>
        </math></span> (<span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0008.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0008.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msup>
          <mrow></mrow>
          <mrow>
           <mo>
            ∘
           </mo>
          </mrow>
         </msup><mrow>
          <mi mathvariant="normal">
           C
          </mi>
         </mrow>
        </math></span>) and the other measurements used.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0006image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/medium/tbps_a_2120631_f0006_oc.jpg" loading="lazy" height="163" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0006">
   <p class="captionText"><span class="captionLabel">Figure 6. </span> Validation of the living room mean radiant temperature for a week free floating experiment in September. TSIM corresponds to the simulation temperature and TEXP corresponds to the experimental measurement done with a globe thermometer. The dashed line <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0005.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0005.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <mo>
       ±
      </mo><mn>
       0.5
      </mn>
     </math></span> (<span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0006.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0006.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msup>
       <mrow></mrow>
       <mrow>
        <mo>
         ∘
        </mo>
       </mrow>
      </msup><mrow>
       <mi mathvariant="normal">
        C
       </mi>
      </mrow>
     </math></span>)corresponds to an estimation of the error the instrument, namely <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0007.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0007.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <mo>
       ±
      </mo><mn>
       0.25
      </mn>
     </math></span> (<span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0008.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0008.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msup>
       <mrow></mrow>
       <mrow>
        <mo>
         ∘
        </mo>
       </mrow>
      </msup><mrow>
       <mi mathvariant="normal">
        C
       </mi>
      </mrow>
     </math></span>) and the other measurements used.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0006">
   <div class="figureFootNote-F0006"></div>
  </div>
  <div class="tableViewerArticleInfo hidden">
   <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>16 September 2022
    </div>
   </div>
  </div>
  <div class="tableView">
   <div class="tableCaption">
    <div class="short-legend">
     <h3><p class="captionText"><span class="captionLabel">Table 2. </span> Apartment properties.</p></h3>
    </div>
   </div>
   <div class="tableDownloadOption" data-hascsvlnk="false" id="T0002-table-wrapper">
    <a data-id="T0002" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
   </div>
  </div>
  <p></p>
  <p>The thermal zones and floor heating system are modelled using the Buildings library. The remainder of the hydronic system is modelled using the IBPSA library apart from the heat pump, where a dynamic performance map model from the IDEAS library is used. The baseline controller in the emulator is an on-off controller with a 1[<span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0015.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0015.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msup>
      <mrow></mrow>
      <mrow>
       <mo>
        ∘
       </mo>
      </mrow>
     </msup><mrow>
      <mi mathvariant="normal">
       C
      </mi>
     </mrow>
    </math></span>] hysteresis on the room set point temperature. The zone valve fully opens when the hysteresis controller gives an on signal and remains closed otherwise. Each thermal zone has its own thermostat and is controlled independently. The pump works to provide a constant head, tuned to provide each floor heating circuit the respective nominal water mass flow rate. The heat pump supply water set point temperature is calculated via a climatic curve that depends on the external temperature. The baseline results shown in the Results Section&nbsp;<a href="#S003">3</a>, refer to the emulator running the simulation with this baseline controller. The external Python-Pyomo based MPC is able to override both the zone valve on-off signal, <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0016.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0016.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       u
      </mi>
      <mi>
       i
      </mi>
     </msub>
    </math></span>, and the heat pump supply water set point <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0017.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0017.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
       <mo>
        ,
       </mo>
       <mi>
        s
       </mi>
       <mi>
        e
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span>.</p>
 </div>
 <div id="S002-S2004" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i15">2.4. Reduced order model</h3>
  <p>A grey-box model based on the resistance-capacitance (RC) analogy was identified using the Matlab identification toolbox (Ljung and Singh&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0027" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2012</a></span>) for use within the MPC controller. Looking at Table&nbsp;<button class="ref showTableEventRef" data-id="T0002">2</button>, the apartment can be considered to be well insulated and with heavy construction. Different combinations of resistors and capacitors were tried, leading to a 3C7R scheme that was adopted for each thermal zone. The scheme of the resulting RC circuit for each thermal zone is shown in Figure&nbsp;<a href="#F0007">7</a>. The three capacities are related to the room temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0018.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0018.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mi>
       r
      </mi>
     </msub>
    </math></span>, wall temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0019.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0019.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mi>
       w
      </mi>
     </msub>
    </math></span> and floor temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0020.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0020.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mi>
       f
      </mi>
     </msub>
    </math></span>. Resistances connect the capacities nodes to each other and furthermore, two resistances connect <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0021.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0021.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       C
      </mi>
      <mi>
       r
      </mi>
     </msub>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0022.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0022.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       C
      </mi>
      <mi>
       w
      </mi>
     </msub>
    </math></span> to the external temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0023.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0023.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        e
       </mi>
       <mi>
        x
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span>. The wall has a resistance that connects also with the sky temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0024.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0024.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        s
       </mi>
       <mi>
        k
       </mi>
       <mi>
        y
       </mi>
      </mrow>
     </msub>
    </math></span>. The sky temperature allows the low-order model to better treat the radiative heat exchange with the external environment, especially in the presence or absence of clouds. Lastly, the capacitors of the rooms are connected to each other through a resistor as a proxy for air exchange between the two thermal zones.</p>
  <div class="figure figureViewer" id="F0007">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>16 September 2022
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 7. </span> Thermal zone reduced order model, the red dots are the temperatures, the blue parallel lines are the capacitors associated with the temperature states, the resistances are the thermal resistances between the temperatures and the red lines indicate a heat flow into the node.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0007image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/medium/tbps_a_2120631_f0007_oc.jpg" loading="lazy" height="208" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0007">
   <p class="captionText"><span class="captionLabel">Figure 7. </span> Thermal zone reduced order model, the red dots are the temperatures, the blue parallel lines are the capacitors associated with the temperature states, the resistances are the thermal resistances between the temperatures and the red lines indicate a heat flow into the node.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0007">
   <div class="figureFootNote-F0007"></div>
  </div>
  <p></p>
  <p>The solar heat source <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0025.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0025.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi mathvariant="normal">
       Φ
      </mi>
      <mi>
       s
      </mi>
     </msub><mo stretchy="false">
      [
     </mo><msup>
      <mrow>
       <mi mathvariant="normal">
        W
       </mi>
       <mrow>
        <mo>
         /
        </mo>
       </mrow>
       <mi mathvariant="normal">
        m
       </mi>
      </mrow>
      <mn>
       2
      </mn>
     </msup><mo stretchy="false">
      ]
     </mo>
    </math></span> is the hemispherical global radiation hitting the external wall and window. It is divided between the wall and the floor and multiplied respectively by the opaque area <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0026.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0026.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       A
      </mi>
      <mrow>
       <mi>
        w
       </mi>
       <mi>
        a
       </mi>
       <mi>
        l
       </mi>
       <mi>
        l
       </mi>
      </mrow>
     </msub>
    </math></span> and the windows area <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0027.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0027.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       A
      </mi>
      <mrow>
       <mi>
        w
       </mi>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span>. <i>a</i> and <i>c</i> are tuning parameters that can be assumed as proxy of absorptance and trasmittance. <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0028.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0028.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi mathvariant="normal">
       Φ
      </mi>
      <mrow>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub><mo stretchy="false">
      [
     </mo><mi>
      W
     </mi><mo stretchy="false">
      ]
     </mo>
    </math></span> are the internal gains divided between sensible and radiative by the parameter <i>b</i>. The sensible part goes to the room <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0029.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0029.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       C
      </mi>
      <mi>
       r
      </mi>
     </msub>
    </math></span> and radiative goes to the wall <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0030.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0030.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       C
      </mi>
      <mi>
       w
      </mi>
     </msub>
    </math></span>. Finally, the heat flow rate to the floor heating system, injected in the floor capacity <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0031.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0031.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       C
      </mi>
      <mi>
       f
      </mi>
     </msub>
    </math></span>, is shown in Figure <a href="#F0007">7</a> as <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0032.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0032.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mi mathvariant="normal">
      Δ
     </mi><mrow>
      <mrow>
       <mover>
        <mi>
         H
        </mi>
        <mo>
         ˙
        </mo>
       </mover>
      </mrow>
     </mrow><mo>
      =
     </mo><msub>
      <mrow>
       <mover>
        <mi>
         H
        </mi>
        <mo>
         ˙
        </mo>
       </mover>
      </mrow>
      <mrow>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub><mo>
      −
     </mo><msub>
      <mrow>
       <mover>
        <mi>
         H
        </mi>
        <mo>
         ˙
        </mo>
       </mover>
      </mrow>
      <mrow>
       <mi>
        o
       </mi>
       <mi>
        u
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span>. It is modelled in four different ways resulting in different classes of optimization problems:</p>
  <p></p>
  <ol class="NLM_list NLM_list-list_type-order">
   <li><p class="inline">Linear formulation where <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0033.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0033.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mi mathvariant="normal">
        Δ
       </mi><mrow>
        <mrow>
         <mover>
          <mi>
           H
          </mi>
          <mo>
           ˙
          </mo>
         </mover>
        </mrow>
       </mrow>
      </math></span> itself is treated as an optimization variable (in this case, we let <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0034.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0034.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mi mathvariant="normal">
        Δ
       </mi><mrow>
        <mrow>
         <mover>
          <mi>
           H
          </mi>
          <mo>
           ˙
          </mo>
         </mover>
        </mrow>
       </mrow><mo>
        :=
       </mo><mrow>
        <mrow>
         <mover>
          <mi>
           Q
          </mi>
          <mo>
           ˙
          </mo>
         </mover>
        </mrow>
       </mrow>
      </math></span>).</p></li>
   <li><p class="inline">Linear formulation where <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0035.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0035.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mi mathvariant="normal">
        Δ
       </mi><mrow>
        <mrow>
         <mover>
          <mi>
           H
          </mi>
          <mo>
           ˙
          </mo>
         </mover>
        </mrow>
       </mrow>
      </math></span> is modelled with the supply water temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0036.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0036.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         T
        </mi>
        <mrow>
         <mi>
          i
         </mi>
         <mi>
          n
         </mi>
        </mrow>
       </msub>
      </math></span>, return water temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0037.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0037.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         T
        </mi>
        <mrow>
         <mi>
          o
         </mi>
         <mi>
          u
         </mi>
         <mi>
          t
         </mi>
        </mrow>
       </msub>
      </math></span> and the nominal value of mass flow <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0038.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0038.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mrow>
          <mover>
           <mi>
            m
           </mi>
           <mo>
            ˙
           </mo>
          </mover>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           n
          </mi>
          <mi>
           o
          </mi>
          <mi>
           m
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> (in this case <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0039.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0039.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mi mathvariant="normal">
        Δ
       </mi><mrow>
        <mrow>
         <mover>
          <mi>
           H
          </mi>
          <mo>
           ˙
          </mo>
         </mover>
        </mrow>
       </mrow><mo>
        :=
       </mo><mrow>
        <msub>
         <mrow>
          <mover>
           <mi>
            m
           </mi>
           <mo>
            ˙
           </mo>
          </mover>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           n
          </mi>
          <mi>
           o
          </mi>
          <mi>
           m
          </mi>
         </mrow>
        </msub>
        <msub>
         <mi>
          c
         </mi>
         <mi>
          w
         </mi>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           o
          </mi>
          <mi>
           u
          </mi>
          <mi>
           t
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         )
        </mo>
       </mrow>
      </math></span>)</p></li>
   <li><p class="inline">Nonlinear formulation where <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0040.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0040.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mi mathvariant="normal">
        Δ
       </mi><mrow>
        <mrow>
         <mover>
          <mi>
           H
          </mi>
          <mo>
           ˙
          </mo>
         </mover>
        </mrow>
       </mrow>
      </math></span> is modelled with the energy balance in 2., but multiplied by the valve position <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0041.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0041.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mi>
         i
        </mi>
       </msub>
      </math></span>, and with the continuous relaxation of the integer constraint, i.e. <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0042.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0042.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mi>
         i
        </mi>
       </msub><mo>
        ∈
       </mo><mo stretchy="false">
        [
       </mo><mn>
        0
       </mn><mo>
        ,
       </mo><mn>
        1
       </mn><mo stretchy="false">
        ]
       </mo>
      </math></span> (in this case <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0043.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0043.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mi mathvariant="normal">
        Δ
       </mi><mrow>
        <mrow>
         <mover>
          <mi>
           H
          </mi>
          <mo>
           ˙
          </mo>
         </mover>
        </mrow>
       </mrow><mo>
        :=
       </mo><mrow>
        <msub>
         <mi>
          u
         </mi>
         <mi>
          i
         </mi>
        </msub>
        <msub>
         <mrow>
          <mover>
           <mi>
            m
           </mi>
           <mo>
            ˙
           </mo>
          </mover>
         </mrow>
         <mrow>
          <mi>
           f
          </mi>
          <mi>
           n
          </mi>
          <mi>
           o
          </mi>
          <mi>
           m
          </mi>
         </mrow>
        </msub>
        <msub>
         <mi>
          c
         </mi>
         <mi>
          w
         </mi>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           o
          </mi>
          <mi>
           u
          </mi>
          <mi>
           t
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         )
        </mo>
       </mrow>
      </math></span>)</p></li>
   <li><p class="inline">Mixed Integer Nonlinear formulation where <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0044.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0044.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mi mathvariant="normal">
        Δ
       </mi><mrow>
        <mrow>
         <mover>
          <mi>
           H
          </mi>
          <mo>
           ˙
          </mo>
         </mover>
        </mrow>
       </mrow>
      </math></span> is modelled as 3. but without the continuous relaxation.</p></li>
  </ol>
  <p></p>
  <p>For formulation 1 the optimal control variable will be the thermal power provided to the floor heating <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0045.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0045.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mrow>
      <mrow>
       <mover>
        <mi>
         Q
        </mi>
        <mo>
         ˙
        </mo>
       </mover>
      </mrow>
     </mrow>
    </math></span>. For formulation 2 the optimal control variables will be the floor heating inlet temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0046.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0046.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span>. For formulations 3-4 the optimal control variables are <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0047.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0047.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span> and the zone valve status <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0048.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0048.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       u
      </mi>
      <mi>
       i
      </mi>
     </msub>
    </math></span>. For the formulations 2-4 using the supply temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0049.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0049.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span> as an optimization variable, the return/outlet temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0050.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0050.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        o
       </mi>
       <mi>
        u
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span> was modelled with the following linear equation to correlate <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0051.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0051.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        o
       </mi>
       <mi>
        u
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span> with <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0052.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0052.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span> and floor temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0053.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0053.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mi>
       f
      </mi>
     </msub>
    </math></span> as shown in Equation&nbsp;(<a href="#M0001">1</a>). <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_m0001.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_m0001.gif&quot;}"><span class="mml-formula"><span class="disp_formula_label_div"><span id="M0001" class="disp-formula-label">(1) </span></span></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        o
       </mi>
       <mi>
        u
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub><mo>
      =
     </mo><msub>
      <mi>
       w
      </mi>
      <mi>
       f
      </mi>
     </msub><msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub><mo>
      +
     </mo><mo stretchy="false">
      (
     </mo><mn>
      1
     </mn><mo>
      −
     </mo><msub>
      <mi>
       w
      </mi>
      <mi>
       f
      </mi>
     </msub><mo stretchy="false">
      )
     </mo><msub>
      <mi>
       T
      </mi>
      <mi>
       f
      </mi>
     </msub>
    </math><span class="mathjaxLabel"><span class="disp_formula_label_div"><span id="M0001" class="disp-formula-label">(1) </span></span></span></span><span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0054.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0054.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       w
      </mi>
      <mi>
       f
      </mi>
     </msub>
    </math></span> is the weighting factor for the identification process. The rationale behind this linear relationship is that the water mass flow rate <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0055.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0055.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mrow>
       <mover>
        <mi>
         m
        </mi>
        <mo>
         ˙
        </mo>
       </mover>
      </mrow>
      <mrow>
       <mi>
        f
       </mi>
       <mi>
        l
       </mi>
       <mi>
        o
       </mi>
       <mi>
        o
       </mi>
       <mi>
        r
       </mi>
      </mrow>
     </msub>
    </math></span> is constant and so if we consider the floor heating system as an heat exchanger <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0056.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0056.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       w
      </mi>
      <mi>
       f
      </mi>
     </msub>
    </math></span> would be equivalent to a constant effectiveness. This equation is valid for this case study since the zones valves can only be open or closed and do not provide variable flow control. The authors would like to point out that this approximation might be more problematic for formulation 3., because with the continuous relaxation the valve will be able to modulate the flow and could lead to a larger error between the reduced order model and the emulator model and instability in the MPC.</p>
  <p>Since the training of RC models is not the focus of the present work, the identification procedure is briefly reported. All the reduced order model parameters shown in Figure <a href="#F0007">7</a>, so not including <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0057.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0057.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       w
      </mi>
      <mi>
       f
      </mi>
     </msub>
    </math></span>, were trained using two weeks of free floating data, simulated using the detailed emulator model, where the boundary conditions were derived from a synthetic profile obtained through a Fourier analysis of the typical year data (Smart and Ballinger&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0043" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>1984</a></span>). In this way all major frequency components are present. After identifying all the model parameters, an additional week of data where the heating system is excited by turning it on and off is used to find the weighting parameter <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0058.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0058.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       w
      </mi>
      <mi>
       f
      </mi>
     </msub>
    </math></span>. The result of the overall identification process leads to a Normalized Root Mean Square Error (NRMSE) goodness of fit of 82%, defined in Equation&nbsp;(<a href="#M0002">2</a>), in open loop simulation for the whole heating season which for Milan is from the 15th of October to the 15th of April, where the heating system was functional. <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_m0002.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_m0002.gif&quot;}"><span class="mml-formula"><span class="disp_formula_label_div"><span id="M0002" class="disp-formula-label">(2) </span></span></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mrow>
      <mi mathvariant="normal">
       NRMSE
      </mi>
      <mspace width="thinmathspace"></mspace>
      <mi mathvariant="normal">
       goodness
      </mi>
      <mspace width="thinmathspace"></mspace>
      <mi mathvariant="normal">
       of
      </mi>
      <mspace width="thinmathspace"></mspace>
      <mi mathvariant="normal">
       fit
      </mi>
     </mrow><mo>
      =
     </mo><mn>
      100
     </mn><mrow>
      <mo>
       (
      </mo>
      <mn>
       1
      </mn>
      <mo>
       −
      </mo>
      <mstyle displaystyle="true" scriptlevel="0">
       <mfrac>
        <mrow>
         <mrow>
          <mo stretchy="false">
           |
          </mo>
         </mrow>
         <msub>
          <mi>
           y
          </mi>
          <mrow>
           <mi>
            d
           </mi>
           <mi>
            a
           </mi>
           <mi>
            t
           </mi>
           <mi>
            a
           </mi>
          </mrow>
         </msub>
         <mo>
          −
         </mo>
         <msub>
          <mi>
           y
          </mi>
          <mrow>
           <mi>
            m
           </mi>
           <mi>
            o
           </mi>
           <mi>
            d
           </mi>
           <mi>
            e
           </mi>
           <mi>
            l
           </mi>
          </mrow>
         </msub>
         <mrow>
          <mo stretchy="false">
           |
          </mo>
         </mrow>
        </mrow>
        <mrow>
         <mrow>
          <mo stretchy="false">
           |
          </mo>
         </mrow>
         <msub>
          <mi>
           y
          </mi>
          <mrow>
           <mi>
            d
           </mi>
           <mi>
            a
           </mi>
           <mi>
            t
           </mi>
           <mi>
            a
           </mi>
          </mrow>
         </msub>
         <mo>
          −
         </mo>
         <msub>
          <mover>
           <mi>
            y
           </mi>
           <mo accent="false">
            ¯
           </mo>
          </mover>
          <mrow>
           <mi>
            d
           </mi>
           <mi>
            a
           </mi>
           <mi>
            t
           </mi>
           <mi>
            a
           </mi>
          </mrow>
         </msub>
         <mo stretchy="false">
          )
         </mo>
         <mrow>
          <mo stretchy="false">
           |
          </mo>
         </mrow>
        </mrow>
       </mfrac>
      </mstyle>
      <mo>
       )
      </mo>
     </mrow><mo stretchy="false">
      [
     </mo><mi mathvariant="normal">
      %
     </mi><mo stretchy="false">
      ]
     </mo>
    </math><span class="mathjaxLabel"><span class="disp_formula_label_div"><span id="M0002" class="disp-formula-label">(2) </span></span></span></span></p>
 </div>
 <div id="S002-S2005" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i19">2.5. MPC formulations</h3>
  <p>Besides the modelling approaches, other constraints and objective functions were specified to complete MPC problem formulations. In Table&nbsp;<button class="ref showTableEventRef" data-id="T0003">3</button>, all formulation elements and MPC implementation parameters that were commonly used for the ten different MPCs are shown. Furthermore, Table&nbsp;<button class="ref showTableEventRef" data-id="T0004">4</button> lists all other optimization variables, constraints and objectives. Finally, in Table&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button>, complete MPC formulations are succinctly summarized with the notations of Table&nbsp;<button class="ref showTableEventRef" data-id="T0004">4</button>.</p>
  <div class="tableViewerArticleInfo hidden">
   <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>16 September 2022
    </div>
   </div>
  </div>
  <div class="tableView">
   <div class="tableCaption">
    <div class="short-legend">
     <h3><p class="captionText"><span class="captionLabel">Table 3. </span> MPC states and disturbances.</p></h3>
    </div>
   </div>
   <div class="tableDownloadOption" data-hascsvlnk="false" id="T0003-table-wrapper">
    <a data-id="T0003" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
   </div>
  </div>
  <div class="tableViewerArticleInfo hidden">
   <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>16 September 2022
    </div>
   </div>
  </div>
  <div class="tableView">
   <div class="tableCaption">
    <div class="short-legend">
     <h3><p class="captionText"><span class="captionLabel">Table 4. </span> List of MPC optimization variables, constraints and objectives.</p></h3>
    </div>
   </div>
   <div class="tableDownloadOption" data-hascsvlnk="false" id="T0004-table-wrapper">
    <a data-id="T0004" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
   </div>
  </div>
  <div class="tableViewerArticleInfo hidden">
   <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>16 September 2022
    </div>
   </div>
  </div>
  <div class="tableView">
   <div class="tableCaption">
    <div class="short-legend">
     <h3><p class="captionText"><span class="captionLabel">Table 5. </span> MPC problem statement.</p></h3>
    </div>
   </div>
   <div class="tableDownloadOption" data-hascsvlnk="false" id="T0005-table-wrapper">
    <a data-id="T0005" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
   </div>
  </div>
  <p></p>
  <p>Table&nbsp;<button class="ref showTableEventRef" data-id="T0003">3</button> contains all common elements across the formulations, including dynamic states, disturbances and implementation choices. In Table&nbsp;<button class="ref showTableEventRef" data-id="T0003">3</button>, only the final choice for control horizon and time step is shown. However, four different control horizons were tried for the optimal control problems from 6 up to 72 [h]. The final choice was 24 [h] since a longer prediction horizon did not show significant improvement on KPIs. This time scale aligns with the fact that we are dealing with a heavy construction and a floor heating with a high thermal inertia. Another parametric study was carried out to identify a suitable time step where a MPC solution updates. Several different time steps were tested ranging 5,10,15 and 30 [min], the results show that bringing it below 15 [min] did not give any significant benefits.The reason is that in this case study the authors considered a floor heating system where the time constant of the floor heating is in the order of magnitude of 3 [h], in case of air systems or radiators the time step should be lower to avoid numerical integration problems. A direct collocation method was implemented using the Pyomo problem statement to convert the continuous optimal control problems into discrete programming problems. The six states include all temperatures in both thermal zones and the disturbances as reported in Section&nbsp;<a href="#S002-S2004">2.4</a>, plus the two room set points and the energy price <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0249.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0249.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       p
      </mi>
      <mrow>
       <mi>
        e
       </mi>
      </mrow>
     </msub><mo stretchy="false">
      [
     </mo>
    </math></span>€<span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0250.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0250.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mo stretchy="false">
      ]
     </mo>
    </math></span> set to 0.20 [€/kWh].</p>
  <p>Table&nbsp;<button class="ref showTableEventRef" data-id="T0004">4</button> lists all other optimization variables, constraints, and objective functions used in different formulations (each MPC formulation is expressed with a combination of those in Table&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button>). <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0251.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0251.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mrow>
      <msub>
       <mi>
        δ
       </mi>
       <mrow>
        <mi>
         l
        </mi>
        <mi>
         i
        </mi>
        <mi>
         v
        </mi>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <mi>
         b
        </mi>
        <mi>
         e
        </mi>
        <mi>
         d
        </mi>
       </mrow>
      </msub>
     </mrow>
    </math></span> is an auxiliary variable representing a temperature deviation from a setpoint, and is coupled with the constraint <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0252.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0252.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       C
      </mi>
      <mrow>
       <mrow>
        <mi mathvariant="normal">
         comf
        </mi>
       </mrow>
      </mrow>
     </msub>
    </math></span> and the objective <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0253.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0253.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mrow>
        <mi mathvariant="normal">
         comf
        </mi>
       </mrow>
      </mrow>
     </msub>
    </math></span>. By looking at the constraint <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0254.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0254.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       C
      </mi>
      <mrow>
       <mrow>
        <mi mathvariant="normal">
         comf
        </mi>
       </mrow>
      </mrow>
     </msub>
    </math></span>, the value of <i>δ</i> will be higher than zero if the room temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0255.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0255.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mi>
       r
      </mi>
     </msub>
    </math></span> is lower than the setpoint temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0256.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0256.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        s
       </mi>
       <mi>
        e
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span>. In this case, it will be penalized by including <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0257.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0257.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msup>
      <mi>
       δ
      </mi>
      <mn>
       2
      </mn>
     </msup>
    </math></span> in the objective <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0258.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0258.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mrow>
        <mi mathvariant="normal">
         comf
        </mi>
       </mrow>
      </mrow>
     </msub>
    </math></span>. This will push the MPC to keep <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0259.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0259.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mi>
       r
      </mi>
     </msub>
    </math></span> higher than the setpoint temperature.</p>
  <p>The other optimization variables, as well as the constraints, are related to the floor heat flow rate models explained in Section&nbsp;<a href="#S002-S2004">2.4</a>. <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0260.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0260.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mrow>
      <msub>
       <mi>
        T
       </mi>
       <mrow>
        <mi>
         i
        </mi>
        <mi>
         n
        </mi>
       </mrow>
      </msub>
     </mrow>
    </math></span> is the supply temperature and can go up to the maximum temperature of 45 [<span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0261.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0261.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msup>
      <mrow></mrow>
      <mrow>
       <mo>
        ∘
       </mo>
      </mrow>
     </msup><mrow>
      <mi mathvariant="normal">
       C
      </mi>
     </mrow>
    </math></span>] to avoid high temperatures in the floor, down to a minimum temperature, defined as the adiabatic mixing temperature in constraint <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0262.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0262.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       C
      </mi>
      <mrow>
       <mi>
        T
       </mi>
       <mi>
        m
       </mi>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span>. The formulation of constraint <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0263.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0263.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       C
      </mi>
      <mrow>
       <mi>
        T
       </mi>
       <mi>
        m
       </mi>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span> comes from a local energy and mass balance at the return outlet of the floor heating system under the assumption that the nominal flow rate is the same for all circuits. <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0264.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0264.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        f
       </mi>
       <mo>
        ,
       </mo>
       <mi>
        l
       </mi>
       <mi>
        i
       </mi>
       <mi>
        v
       </mi>
       <mrow>
        <mo>
         /
        </mo>
       </mrow>
       <mi>
        b
       </mi>
       <mi>
        e
       </mi>
       <mi>
        d
       </mi>
      </mrow>
     </msub>
    </math></span> is the floor temperature and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0265.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0265.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       u
      </mi>
      <mrow>
       <mi>
        l
       </mi>
       <mi>
        i
       </mi>
       <mi>
        v
       </mi>
       <mrow>
        <mo>
         /
        </mo>
       </mrow>
       <mi>
        b
       </mi>
       <mi>
        e
       </mi>
       <mi>
        d
       </mi>
      </mrow>
     </msub>
    </math></span> is the floor heating circuit valve control. <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0266.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0266.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mrow>
      <msub>
       <mi>
        u
       </mi>
       <mrow>
        <mi>
         R
        </mi>
       </mrow>
      </msub>
     </mrow>
    </math></span> represents a continuous relaxation on the valve control, so that the valve can continuously modulate the flow from totally closed to totally opened. <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0267.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0267.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mrow>
      <msub>
       <mi>
        u
       </mi>
       <mrow>
        <mi>
         B
        </mi>
       </mrow>
      </msub>
     </mrow>
    </math></span> indicates the valve controls without the relaxation and are consistent with the actual system and emulator model. <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0268.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0268.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mrow>
      <msub>
       <mi>
        u
       </mi>
       <mrow>
        <mi>
         o
        </mi>
        <mi>
         p
        </mi>
        <mi>
         e
        </mi>
        <mi>
         n
        </mi>
       </mrow>
      </msub>
     </mrow>
    </math></span> means the valve controls under the assumption that the valve is always open and the modulation is carried out only at the supply temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0269.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0269.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span>. Finally, <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0270.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0270.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mrow>
       <mover>
        <mi>
         Q
        </mi>
        <mo>
         ˙
        </mo>
       </mover>
      </mrow>
      <mrow>
       <mi>
        l
       </mi>
       <mi>
        i
       </mi>
       <mi>
        v
       </mi>
       <mrow>
        <mo>
         /
        </mo>
       </mrow>
       <mi>
        b
       </mi>
       <mi>
        e
       </mi>
       <mi>
        d
       </mi>
      </mrow>
     </msub>
    </math></span> is used directly as an optimization variable when the heat flow rate is not modelled explicitly. It can go from zero to a maximum value determined by constraint <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0271.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0271.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       C
      </mi>
      <mrow>
       <mi>
        Q
       </mi>
       <mo movablelimits="true" form="prefix">
        max
       </mo>
      </mrow>
     </msub>
    </math></span>. The constraint on the heat flow rate <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0272.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0272.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       C
      </mi>
      <mrow>
       <mi>
        Q
       </mi>
       <mo movablelimits="true" form="prefix">
        max
       </mo>
      </mrow>
     </msub>
    </math></span> imposes the maximum heat flow rate linearly with the floor temperature as a function of the maximum supply temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0273.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0273.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
       <mo movablelimits="true" form="prefix">
        max
       </mo>
      </mrow>
     </msub>
    </math></span> and the weighting parameter <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0274.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0274.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       w
      </mi>
      <mi>
       f
      </mi>
     </msub>
    </math></span>. This constraint helps to model the behaviour of the floor slab, where, at constant supply temperature, the higher the floor temperature, the lower the heat transfer rate to the floor. Figure&nbsp;<a href="#F0008">8</a> is given as a visual representation of the idea.</p>
  <div class="figure figureViewer" id="F0008">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>16 September 2022
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 8. </span> Visual representation of the <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0275.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0275.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           C
          </mi>
          <mrow>
           <mi>
            Q
           </mi>
           <mo movablelimits="true" form="prefix">
            max
           </mo>
          </mrow>
         </msub>
        </math></span> constraint. In grey is highlighted the admissible control area with <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0276.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0276.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           C
          </mi>
          <mrow>
           <mi>
            Q
           </mi>
           <mo movablelimits="true" form="prefix">
            max
           </mo>
          </mrow>
         </msub>
        </math></span> implemented. It reduces as the floor temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0277.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0277.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           T
          </mi>
          <mi>
           f
          </mi>
         </msub>
        </math></span> since <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0278.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0278.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           T
          </mi>
          <mrow>
           <mi>
            i
           </mi>
           <mi>
            n
           </mi>
           <mo movablelimits="true" form="prefix">
            max
           </mo>
          </mrow>
         </msub>
        </math></span> is a constant value.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0008image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/medium/tbps_a_2120631_f0008_ob.jpg" loading="lazy" height="289" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0008">
   <p class="captionText"><span class="captionLabel">Figure 8. </span> Visual representation of the <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0275.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0275.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        C
       </mi>
       <mrow>
        <mi>
         Q
        </mi>
        <mo movablelimits="true" form="prefix">
         max
        </mo>
       </mrow>
      </msub>
     </math></span> constraint. In grey is highlighted the admissible control area with <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0276.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0276.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        C
       </mi>
       <mrow>
        <mi>
         Q
        </mi>
        <mo movablelimits="true" form="prefix">
         max
        </mo>
       </mrow>
      </msub>
     </math></span> implemented. It reduces as the floor temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0277.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0277.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        T
       </mi>
       <mi>
        f
       </mi>
      </msub>
     </math></span> since <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0278.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0278.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        T
       </mi>
       <mrow>
        <mi>
         i
        </mi>
        <mi>
         n
        </mi>
        <mo movablelimits="true" form="prefix">
         max
        </mo>
       </mrow>
      </msub>
     </math></span> is a constant value.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0008">
   <div class="figureFootNote-F0008"></div>
  </div>
  <p></p>
  <p>The last section of Table&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button> presents all the components that can make up a complete control objective function. The complete objective function <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0279.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0279.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       J
      </mi>
      <mrow>
       <mi>
        t
       </mi>
       <mi>
        o
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span> to be minimized is the sum of these different objective components with some weights, denoted as <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0280.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0280.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       k
      </mi>
      <mi>
       i
      </mi>
     </msub>
    </math></span> where <i>i</i> corresponds to a specific objective component. The weighting parameters <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0281.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0281.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       k
      </mi>
      <mi>
       i
      </mi>
     </msub>
    </math></span> need to be tuned to balance the impact of each objective on the total objective function <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0282.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0282.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       J
      </mi>
      <mrow>
       <mi>
        t
       </mi>
       <mi>
        o
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span>. To find the best values of <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0283.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0283.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       k
      </mi>
      <mi>
       i
      </mi>
     </msub>
    </math></span>, several iterative studies were performed for each MPC formulation and priority was given to the comfort constraint. The objectives <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0284.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0284.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mi>
        C
       </mi>
       <mi>
        O
       </mi>
       <mi>
        P
       </mi>
       <mo>
        ,
       </mo>
       <mi>
        L
       </mi>
      </mrow>
     </msub>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0285.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0285.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mi>
        C
       </mi>
       <mi>
        O
       </mi>
       <mi>
        P
       </mi>
       <mo>
        ,
       </mo>
       <mi>
        N
       </mi>
       <mi>
        L
       </mi>
      </mrow>
     </msub>
    </math></span> are the energy cost and are calculated as the energy price <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0286.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0286.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       p
      </mi>
      <mrow>
       <mi>
        e
       </mi>
      </mrow>
     </msub>
    </math></span> multiplied by the total heat flow rate provided by the heat pump, <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0287.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0287.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mi mathvariant="normal">
      Δ
     </mi><mrow>
      <msub>
       <mrow>
        <mover>
         <mi>
          H
         </mi>
         <mo>
          ˙
         </mo>
        </mover>
       </mrow>
       <mrow>
        <mi>
         l
        </mi>
        <mi>
         i
        </mi>
        <mi>
         v
        </mi>
       </mrow>
      </msub>
     </mrow><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo><mo>
      +
     </mo><mi mathvariant="normal">
      Δ
     </mi><mrow>
      <msub>
       <mrow>
        <mover>
         <mi>
          H
         </mi>
         <mo>
          ˙
         </mo>
        </mover>
       </mrow>
       <mrow>
        <mi>
         b
        </mi>
        <mi>
         e
        </mi>
        <mi>
         d
        </mi>
       </mrow>
      </msub>
     </mrow><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo>
    </math></span>, divided by the heat pump COP. The COP is a function of the external temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0288.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0288.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mi>
      C
     </mi><mi>
      O
     </mi><mi>
      P
     </mi><mo stretchy="false">
      (
     </mo><msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        e
       </mi>
       <mi>
        x
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub><mo stretchy="false">
      )
     </mo>
    </math></span> for <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0289.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0289.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mi>
        C
       </mi>
       <mi>
        O
       </mi>
       <mi>
        P
       </mi>
       <mo>
        ,
       </mo>
       <mi>
        L
       </mi>
      </mrow>
     </msub>
    </math></span>, so the underlying problem remains quadratic. In <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0290.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0290.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mi>
        C
       </mi>
       <mi>
        O
       </mi>
       <mi>
        P
       </mi>
       <mo>
        ,
       </mo>
       <mi>
        N
       </mi>
       <mi>
        L
       </mi>
      </mrow>
     </msub>
    </math></span>, the COP is a function of the external and supply temperatures <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0291.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0291.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mi>
      C
     </mi><mi>
      O
     </mi><mi>
      P
     </mi><mo stretchy="false">
      (
     </mo><msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        e
       </mi>
       <mi>
        x
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub><mo>
      ,
     </mo><msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub><mo stretchy="false">
      )
     </mo>
    </math></span>. Here, the optimization problem becomes nonlinear because a control variable is present in the denominator of a fraction. <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0292.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0292.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mrow>
        <mi mathvariant="normal">
         comf
        </mi>
       </mrow>
      </mrow>
     </msub>
    </math></span> is the temperature mismatch between room temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0293.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0293.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mi>
       r
      </mi>
     </msub>
    </math></span> and setpoint <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0294.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0294.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        s
       </mi>
       <mi>
        e
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span> and works as a comfort proxy. The switching frequency objective <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0295.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0295.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mi>
        s
       </mi>
       <mi>
        w
       </mi>
       <mi>
        i
       </mi>
       <mi>
        t
       </mi>
       <mi>
        c
       </mi>
       <mi>
        h
       </mi>
      </mrow>
     </msub>
    </math></span> is the sum of the squared valve control derivatives. This objectives serves the purpose of penalizing undesirable sudden changes in the control variables. Since the derivative is discretized with forward Euler in the direct collocation method, there is no difference between the formulations that use valve control state as integer <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0296.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0296.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       u
      </mi>
      <mi>
       B
      </mi>
     </msub>
    </math></span> and as continuous <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0297.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0297.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       u
      </mi>
      <mi>
       R
      </mi>
     </msub>
    </math></span>. Finally, the binary constraint, <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0298.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0298.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mi>
       B
      </mi>
     </msub>
    </math></span>, forces <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0299.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0299.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       u
      </mi>
      <mrow>
       <mi>
        l
       </mi>
       <mi>
        i
       </mi>
       <mi>
        v
       </mi>
      </mrow>
     </msub>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0300.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0300.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       u
      </mi>
      <mrow>
       <mi>
        b
       </mi>
       <mi>
        e
       </mi>
       <mi>
        d
       </mi>
      </mrow>
     </msub>
    </math></span> to be close to either 0 or 1 to avoid having an objective greater than 0. The reasoning behind this constraint is to approximate a MINLP as a NLP. However, as was found in this study, care should be taken when initializing this optimization problem because the introduction of the binary constraint causes a significant discontinuity in the solution space.</p>
  <p>Starting from Tables&nbsp;<button class="ref showTableEventRef" data-id="T0003">3</button> and&nbsp;<button class="ref showTableEventRef" data-id="T0004">4</button>, several MPC formulations can be defined, ranging from QP to MINLP. Table&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button> reports the MPC formulations coupled with the solvers and relative options used for the study.</p>
  <p>Table&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button> shows the ten MPC formulations that were tested. The Tag column reports the formulation names. The Formulation column shows the corresponding optimization variables, constraints, and objectives described in Table&nbsp;<button class="ref showTableEventRef" data-id="T0004">4</button>. Note that the auxiliary variable <i>δ</i>, the temperature constraint <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0301.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0301.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       C
      </mi>
      <mrow>
       <mrow>
        <mi mathvariant="normal">
         comf
        </mi>
       </mrow>
      </mrow>
     </msub>
    </math></span>, the temperature mismatch <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0302.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0302.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mrow>
        <mi mathvariant="normal">
         comf
        </mi>
       </mrow>
      </mrow>
     </msub>
    </math></span>, and the switching objective <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0303.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0303.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mi>
        s
       </mi>
       <mi>
        w
       </mi>
       <mi>
        i
       </mi>
       <mi>
        t
       </mi>
       <mi>
        c
       </mi>
       <mi>
        h
       </mi>
      </mrow>
     </msub>
    </math></span> are present in all formulations, apart from MPC2 where <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0304.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0304.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mi>
        s
       </mi>
       <mi>
        w
       </mi>
       <mi>
        i
       </mi>
       <mi>
        t
       </mi>
       <mi>
        c
       </mi>
       <mi>
        h
       </mi>
      </mrow>
     </msub>
    </math></span> is not needed since there is no valve control. The Problem Type column reports the optimization problem type for each MPC formulation, which can be either QP, NLP or MINLP. The Solver column shows the solver chosen, including the MINLP handling algorithm option if present. The Tolerance column is the solver tolerance which was determined through a parametric study as a compromise between quality of the solution and computational time for each solver. The same tolerance must be used for the same solver class to guarantee fairness in the solution and computational time. Furthermore, it is increased for the MINLP solvers since it considers both the reduction in the cost function steps for the NLP sub problems and the integer approximation for the MINLP problem. The Initialization column defines how the optimization problem variables were initialized. Free-floating initialization means that a simulation runs using the reduced order model subject to the same boundary conditions, as in the forecasts used for the optimal control, with the floor heat flow rate set to zero. In other formulations, a slightly randomized solution of a different MPC formulation is used as initialization as indicated. The Post Process column shows the steps needed to convert the optimal control trajectory into the physical control inputs used in the emulator model. The Subsolvers column refers to the solvers used by the solver indicated in the Solver column. Another parameter not included in the table is the Timeout. It corresponds to the maximum time between each control horizon optimization and was fixed at two minutes for all formulations as a compromise between giving the solvers enough time to converge to a solution and the overall computational time.</p>
  <p>Below, a summary for each MPC formulation presented in Table&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button> is provided:</p>
  <ul class="NLM_list NLM_list-list_type-bullet">
   <li><p class="inline">MPC1: This formulation uses heat flow rates directly as optimization variables <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0305.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0305.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mrow>
         <mover>
          <mi>
           Q
          </mi>
          <mo>
           ˙
          </mo>
         </mover>
        </mrow>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span>, and <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0306.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0306.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         j
        </mi>
        <mrow>
         <mi>
          C
         </mi>
         <mi>
          O
         </mi>
         <mi>
          P
         </mi>
         <mo>
          ,
         </mo>
         <mi>
          L
         </mi>
        </mrow>
       </msub>
      </math></span> as the energy objective. In this way, the final constraints are linear in optimization variables, and the objective function is quadratic, making a QP problem. The solver of choice for QP was IPOPT with the MA57 linear subsolver. The tolerance was set to <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0307.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0307.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msup>
        <mn>
         10
        </mn>
        <mrow>
         <mo>
          −
         </mo>
         <mn>
          6
         </mn>
        </mrow>
       </msup>
      </math></span> from the default value of <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0308.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0308.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msup>
        <mn>
         10
        </mn>
        <mrow>
         <mo>
          −
         </mo>
         <mn>
          8
         </mn>
        </mrow>
       </msup>
      </math></span> and the timeout time to 120 [s], and the initialization is free-floating. Some post processing is required to convert the optimal control trajectory into the physical control variables used in the emulator. If <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0309.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0309.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mrow>
         <mover>
          <mi>
           Q
          </mi>
          <mo>
           ˙
          </mo>
         </mover>
        </mrow>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span> is higher than a threshold value, equivalent to the minimum cutoff power of the heat pump set as 20% of the nominal value 800 [W], the valves <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0310.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0310.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span> will be opened otherwise they remain closed. The supply temperature setpoint is calculated using the previous step return temperature plus the delta given by <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0311.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0311.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mrow>
         <mover>
          <mi>
           Q
          </mi>
          <mo>
           ˙
          </mo>
         </mover>
        </mrow>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span>.</p></li>
   <li><p class="inline">MPC2: This formulation uses the supply temperature as an optimization variable <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0312.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0312.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span>, while the circuit valves remain always open <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0313.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0313.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          u
         </mi>
         <mrow>
          <mi>
           o
          </mi>
          <mi>
           p
          </mi>
          <mi>
           e
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span>, and <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0314.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0314.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         j
        </mi>
        <mrow>
         <mi>
          C
         </mi>
         <mi>
          O
         </mi>
         <mi>
          P
         </mi>
         <mo>
          ,
         </mo>
         <mi>
          N
         </mi>
         <mi>
          L
         </mi>
        </mrow>
       </msub>
      </math></span> is used for the energy objective. Together with the linear radiant floor heat modelling approach (see point 2.) in Section&nbsp;<a href="#S002-S2004">2.4</a>, the final constraints are linear in optimization variables, and nonlinear in the objective due to the presence of COP as a function of the supply temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0315.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0315.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span>, making it a NLP problem. The solver of choice for the NLP problem was IPOPT with the linear subsolver MA57. The tolerance was set to <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0316.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0316.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msup>
        <mn>
         10
        </mn>
        <mrow>
         <mo>
          −
         </mo>
         <mn>
          6
         </mn>
        </mrow>
       </msup>
      </math></span> from the default value of <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0317.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0317.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msup>
        <mn>
         10
        </mn>
        <mrow>
         <mo>
          −
         </mo>
         <mn>
          8
         </mn>
        </mrow>
       </msup>
      </math></span> and the timeout time to 120 [s], and the initialization is free-floating. A post process is required to convert the optimal control trajectory into the physical control variables used in the emulator. If the supply temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0318.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0318.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> is higher than a threshold value, the valves <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0319.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0319.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span> will open; otherwise, they remain closed. The threshold is calculated as an estimation of the minimum cutoff power of the heat pump set as 20% of the nominal value, 800 [W]. The minimum heat flow rate <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0320.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0320.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <mover>
         <mi>
          Q
         </mi>
         <mo>
          ˙
         </mo>
        </mover>
       </mrow>
      </math></span> is calculated using the expression in point 2. Section&nbsp;<a href="#S002-S2004">2.4</a>. Then <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0321.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0321.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> is used as setpoint supply temperature in the emulator.</p></li>
   <li><p class="inline">MPC3: Compared to MPC2, this MPC does not assume that the circuit valves are fully open. Instead, it relaxes the on/off binary constraints to a real number set <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0322.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0322.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          u
         </mi>
         <mrow>
          <mi>
           R
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> as mentioned in (3) in Section&nbsp;<a href="#S002-S2004">2.4</a> and in Table&nbsp;<button class="ref showTableEventRef" data-id="T0004">4</button>. The final problem formulation is nonlinear in terms of constraints and optimization variables due to the multiplication between supply temperature and valve control. The objective is also nonlinear due to the presence of COP as a function of the supply temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0323.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0323.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> and the multiplication of two optimization variables in the calculation of the heat flow rate <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0324.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0324.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mi mathvariant="normal">
        Δ
       </mi><mrow>
        <mrow>
         <mover>
          <mi>
           H
          </mi>
          <mo>
           ˙
          </mo>
         </mover>
        </mrow>
       </mrow>
      </math></span>. The added nonlinearity of MPC3 compared to MPC2 makes the problem nonconvex because the solver can change <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0325.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0325.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> or <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0326.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0326.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          u
         </mi>
         <mrow>
          <mi>
           R
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> to modulate the heat flow rate, making the process of finding a global optimum harder. Solver settings were identical to MPC2. MPC also needs to convert the optimal control trajectory into the physical control variables used in the emulator. If the circuit valve <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0327.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0327.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span> value is higher than a threshold value, the most common choice would be 0.4. However, the authors found out that playing around with this parameter and reducing it to 0.3 lead to a more stable solution. So in case the valve control is higher than the threshold the valves <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0328.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0328.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span> will be opened, else they remain closed. Then <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0329.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0329.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> is used as setpoint for the supply temperature in the emulator.</p></li>
   <li><p class="inline">MPC4: This formulation is identical to MPC3, apart from the addition of the binary objective <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0330.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0330.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         j
        </mi>
        <mrow>
         <mi>
          B
         </mi>
        </mrow>
       </msub>
      </math></span>. The idea behind <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0331.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0331.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         j
        </mi>
        <mrow>
         <mi>
          B
         </mi>
        </mrow>
       </msub>
      </math></span> is to force <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0332.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0332.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          u
         </mi>
         <mrow>
          <mi>
           R
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> to be either closed <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0333.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0333.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          u
         </mi>
         <mrow>
          <mi>
           R
          </mi>
         </mrow>
        </msub>
       </mrow><mo>
        =
       </mo><mn>
        0
       </mn>
      </math></span>, or open <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0334.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0334.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          u
         </mi>
         <mrow>
          <mi>
           R
          </mi>
         </mrow>
        </msub>
       </mrow><mo>
        =
       </mo><mn>
        1
       </mn>
      </math></span>, by penalizing all solutions that modulate the flow rate in a continuous manner. This allows for a smaller control space by reducing the optimal operating range of the zone valves. This will serve as an NLP approximation of a MINLP formulation. In this case <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0335.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0335.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span> will be used directly in the emulator, because <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0336.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0336.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span> in the raw solution when using <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0337.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0337.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         j
        </mi>
        <mrow>
         <mi>
          B
         </mi>
        </mrow>
       </msub>
      </math></span> are very close to 0 or very close to 1, making the rounding process trivial and <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0338.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0338.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> is used as setpoint for the supply temperature.</p></li>
   <li><p class="inline">MPC5: This formulation is the same as MPC3 but replacing the continuous relaxation (<span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0339.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0339.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mi>
         R
        </mi>
       </msub>
      </math></span>) with the binary constraint (<span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0340.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0340.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mi>
         B
        </mi>
       </msub>
      </math></span>). In this way the final problem formulation is mixed integer nonlinear due to the multiplication between contnious supply temperature and on/off valve control variables, making a MINLP problem. The additional complexity of MPC5 compared to the previous QP and NLP formulations requires a dedicated MINLP solver. The solver of choice for MPC5 was BONMIN-BB. CBC was used as MIQP subsolver and IPOPT as NLP solver. The tolerance was set to <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0341.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0341.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msup>
        <mn>
         10
        </mn>
        <mrow>
         <mo>
          −
         </mo>
         <mn>
          4
         </mn>
        </mrow>
       </msup>
      </math></span> from the default value of <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0342.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0342.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msup>
        <mn>
         10
        </mn>
        <mrow>
         <mo>
          −
         </mo>
         <mn>
          6
         </mn>
        </mrow>
       </msup>
      </math></span> and the timeout time to 120 [s]. The initialization is done by taking the solution of MPC3 after rounding the values of <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0343.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0343.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span>. The MINLP solution can be directly applied to the emulator with no need for post processing of the solution.In this case <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0344.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0344.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span> will be directly used in the emulator and <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0345.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0345.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> is used as setpoint for the supply temperature.</p></li>
   <li><p class="inline">MPC6: This formulation is identical to MPC5 apart from the addition of the binary objective <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0346.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0346.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         j
        </mi>
        <mrow>
         <mi>
          B
         </mi>
        </mrow>
       </msub>
      </math></span> and the initialization done with MPC4 solution. The rationale is similar as in the transition from MPC3 to MPC4. However, instead of a single NLP problem, it is extended to all subsets of NLP problems generated by the MINLP solver.In this case <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0347.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0347.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span> will be directly used in the emulator and <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0348.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0348.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> is used as setpoint for the supply temperature.</p></li>
   <li><p class="inline">MPC7: This formulation is identical to MPC6, where a different MINLP algorithm option was used for the Bonmin solver BONMIN-Hyb. In this case <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0349.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0349.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span> will be directly used in the emulator and <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0350.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0350.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> is used as setpoint for the supply temperature.</p></li>
   <li><p class="inline">MPC8: This formulation is identical to MPC5, where a different MINLP solver was used named Baron. The MIQP solver is CPLEX and the NLP solver is IPOPT.In this case <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0351.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0351.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span> will be directly used in the emulator and <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0352.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0352.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> is used as setpoint for the supply temperature.</p></li>
   <li><p class="inline">MPC9: This formulation is identical to MPC8 with the addition of the binary constraint <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0353.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0353.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         j
        </mi>
        <mrow>
         <mi>
          B
         </mi>
        </mrow>
       </msub>
      </math></span>.In this case <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0354.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0354.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span> will be directly used in the emulator and <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0355.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0355.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> is used as setpoint for the supply temperature.</p></li>
   <li><p class="inline">MPC10: This formulation is identical to MPC9 with the difference that the MINLP solver of choice was SCIP.In this case <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0356.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0356.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         u
        </mi>
        <mrow>
         <mi>
          l
         </mi>
         <mi>
          i
         </mi>
         <mi>
          v
         </mi>
         <mrow>
          <mo>
           /
          </mo>
         </mrow>
         <mi>
          b
         </mi>
         <mi>
          e
         </mi>
         <mi>
          d
         </mi>
        </mrow>
       </msub>
      </math></span> will be directly used in the emulator and <span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0357.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0357.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <mrow>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           i
          </mi>
          <mi>
           n
          </mi>
         </mrow>
        </msub>
       </mrow>
      </math></span> is used as setpoint for the supply temperature.</p></li>
  </ul>
  <p></p>
 </div>
 <div id="S002-S2006" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i21">2.6. Co-simulation setup</h3>
  <p>All elements shown in previous sections are coupled in a co-simulation, a graphical representation is given in Figure&nbsp;<a href="#F0009">9</a>. The optimal control routine runs on the Pyomo Python toolbox Pyomo (Bynum et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0009" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2021</a></span>) and the detailed emulator model is wrapped in a Docker container using the BOPTEST software (Blum et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0005" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2021</a></span>). all simulations were carried out on a Linux Ubuntu 18 laptop with 16GB of RAM and an Intel(R) Core(TM) i7-8650U CPU @ 1.90GHz. all solvers have multi thread capability so up to 8 threads were used for the simulations. This does not mean that all solvers use multi-thread with equal effectiveness. Different solvers will have different core-allocation mechanisms which may result in very different multi-thread efficiency. However, this is also part of the evaluation in the performance of a solver, since recent core architectures make parallel computing very important.</p>
  <div class="figure figureViewer" id="F0009">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>16 September 2022
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 9. </span> co-simulation setup.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0009image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/medium/tbps_a_2120631_f0009_oc.jpg" loading="lazy" height="177" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0009">
   <p class="captionText"><span class="captionLabel">Figure 9. </span> co-simulation setup.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0009">
   <div class="figureFootNote-F0009"></div>
  </div>
  <p></p>
  <p>All cases mentioned in Table&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button> were directly implemented in Python using a concrete instance modelling feature of Pyomo. The solvers were compiled externally and coupled with Pyomo using the AMPL interface. Finally the Kalman filter from Labbe&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0026" data-reflink="_i37 _i38" href="#"><span class="off-screen">Citation</span>2018</a></span>) was used to update the states of the reduced order model at each time initialization.</p>
  <p>BOPTEST provides an easy to use API interface that allows the optimization scripts to manipulate the control variables of the detailed model, access sensor data and access forecasts, and the KPIs calculated by BOPTEST. The control variables are the supply temperature setpoint and the zone valve open or closed signal. The forecasts are the disturbance variables reported in Table&nbsp;<button class="ref showTableEventRef" data-id="T0003">3</button> and are considered deterministic, which means that the same disturbances will also be used in the emulator model. The measurements are the room temperature, the water supply temperature and the return temperature from each zone, and are used by the Kalman filter to estimate the initial value of room, wall, and floor temperatures for each zone for each prediction horizon. To estimate the performance of each MPC formulation, BOPTEST can calculate many KPIs, though this paper considers the thermal discomfort, computational time ratio, and energy cost. Furthermore, four additional KPIs were used to evaluate the performance of these MPC formulations, namely the total computational time [s] of the MPC solver, the thermal energy used <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0358.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0358.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mo stretchy="false">
      [
     </mo><mi>
      k
     </mi><mi>
      W
     </mi><mi>
      h
     </mi><mo stretchy="false">
      ]
     </mo>
    </math></span>, the control arc length, and the number of MPC solver time-out or error events <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0359.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0359.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mo stretchy="false">
      [
     </mo><mi mathvariant="normal">
      %
     </mi><mo stretchy="false">
      ]
     </mo>
    </math></span> that occurred throughout the evaluation period. The equations and descriptions of the KPIs are reported in Table&nbsp;<button class="ref showTableEventRef" data-id="T0006">6</button>, and the descriptions of their variables are reported below the table. For a fair KPI estimation, the emulator and reduced order model thermal envelope states were initialized to 20[<span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0360.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0360.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msup>
      <mrow></mrow>
      <mrow>
       <mo>
        ∘
       </mo>
      </mrow>
     </msup><mrow>
      <mi mathvariant="normal">
       C
      </mi>
     </mrow>
    </math></span>] temperature, and a warm up period of 5 [days] was used. Only valid solutions are used to update the MPC control trajectory. Time-out solutions are valid when variables values are within the bounds, however, they may be not fully converged, meaning that constraints may not be completely satisfied. Time-out solutions are considered invalid if outside variables bounds. Solutions with an error in the solver status are discarded. When a solution is discarded, the previous solution current time step is used until a new valid solution is found.</p>
  <div class="tableViewerArticleInfo hidden">
   <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>16 September 2022
    </div>
   </div>
  </div>
  <div class="tableView">
   <div class="tableCaption">
    <div class="short-legend">
     <h3><p class="captionText"><span class="captionLabel">Table 6. </span> BOPTEST and MPC specific KPIs.</p></h3>
    </div>
   </div>
   <div class="tableDownloadOption" data-hascsvlnk="false" id="T0006-table-wrapper">
    <a data-id="T0006" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
   </div>
  </div>
  <p></p>
  <p>In the discomfort KPI <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0374.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0374.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        d
       </mi>
       <mi>
        i
       </mi>
       <mi>
        s
       </mi>
      </mrow>
     </msub>
    </math></span> calculation, <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0375.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0375.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mi>
       r
      </mi>
     </msub><mo stretchy="false">
      [
     </mo><mi>
      K
     </mi><mo stretchy="false">
      ]
     </mo>
    </math></span> is the room operative temperature and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0376.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0376.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        r
       </mi>
       <mo>
        ,
       </mo>
       <mi>
        s
       </mi>
       <mi>
        e
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub><mo stretchy="false">
      [
     </mo><mi>
      K
     </mi><mo stretchy="false">
      ]
     </mo>
    </math></span> the heating setpoint, N is the total number of zones, and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0377.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0377.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       t
      </mi>
      <mi>
       o
      </mi>
     </msub>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0378.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0378.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       t
      </mi>
      <mi>
       f
      </mi>
     </msub>
    </math></span> are the initial and final time of the evaluation period. In the computational time ratio KPI <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0379.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0379.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        t
       </mi>
       <mi>
        i
       </mi>
       <mi>
        m
       </mi>
       <mi>
        r
       </mi>
      </mrow>
     </msub>
    </math></span> <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0380.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0380.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mi>
      δ
     </mi><msub>
      <mi>
       T
      </mi>
      <mi>
       k
      </mi>
     </msub><mo stretchy="false">
      [
     </mo><mrow>
      <mi mathvariant="normal">
       s
      </mi>
     </mrow><mo stretchy="false">
      ]
     </mo>
    </math></span> is the MPC computational time at step <i>k</i>, <i>M</i> is the number of control steps and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0381.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0381.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mi>
      δ
     </mi><msub>
      <mi>
       t
      </mi>
      <mi>
       k
      </mi>
     </msub><mo stretchy="false">
      [
     </mo><mrow>
      <mi mathvariant="normal">
       s
      </mi>
     </mrow><mo stretchy="false">
      ]
     </mo>
    </math></span> is the time interval of control step <i>k</i>. In the cost KPI <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0382.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0382.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        c
       </mi>
       <mi>
        o
       </mi>
       <mi>
        s
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span>, <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0383.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0383.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       p
      </mi>
      <mrow>
       <mi>
        e
       </mi>
       <mi>
        l
       </mi>
      </mrow>
     </msub><mo stretchy="false">
      [
     </mo><mrow>
      <mi mathvariant="normal">
       EUR
      </mi>
      <mrow>
       <mo>
        /
       </mo>
      </mrow>
      <mi mathvariant="normal">
       kWh
      </mi>
     </mrow><mo stretchy="false">
      ]
     </mo>
    </math></span> is the electricity price considered as constant, <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0384.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0384.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       Q
      </mi>
      <mrow>
       <mi>
        t
       </mi>
       <mi>
        o
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub><mo stretchy="false">
      [
     </mo><mrow>
      <mi mathvariant="normal">
       kWh
      </mi>
     </mrow><mo stretchy="false">
      ]
     </mo>
    </math></span> is the total energy supplied by the heat pump and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0385.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0385.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       A
      </mi>
      <mrow>
       <mi>
        t
       </mi>
       <mi>
        o
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub><mo stretchy="false">
      [
     </mo><msup>
      <mrow>
       <mi mathvariant="normal">
        m
       </mi>
      </mrow>
      <mn>
       2
      </mn>
     </msup><mo stretchy="false">
      ]
     </mo>
    </math></span> is the total floor area of the apartment. <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0386.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0386.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       Q
      </mi>
      <mrow>
       <mi>
        t
       </mi>
       <mi>
        o
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub><mo stretchy="false">
      [
     </mo><mrow>
      <mi mathvariant="normal">
       kWh
      </mi>
     </mrow><mo stretchy="false">
      ]
     </mo>
    </math></span> is also used to calculate the thermal energy KPI <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0387.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0387.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        e
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span>. <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0388.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0388.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        e
       </mi>
       <mi>
        r
       </mi>
       <mi>
        r
       </mi>
      </mrow>
     </msub>
    </math></span> is the ratio between the number of MPC iterations that had either timeout <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0389.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0389.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       N
      </mi>
      <mrow>
       <mi>
        t
       </mi>
       <mi>
        i
       </mi>
       <mi>
        m
       </mi>
       <mi>
        e
       </mi>
       <mi>
        o
       </mi>
       <mi>
        u
       </mi>
       <mi>
        t
       </mi>
       <mi>
        s
       </mi>
      </mrow>
     </msub>
    </math></span> or errors <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0390.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0390.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       N
      </mi>
      <mrow>
       <mi>
        e
       </mi>
       <mi>
        r
       </mi>
       <mi>
        r
       </mi>
       <mi>
        o
       </mi>
       <mi>
        r
       </mi>
       <mi>
        s
       </mi>
      </mrow>
     </msub>
    </math></span> and the total number of iterations <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0391.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0391.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       N
      </mi>
      <mrow>
       <mi>
        t
       </mi>
       <mi>
        o
       </mi>
       <mi>
        t
       </mi>
       <mi>
        a
       </mi>
       <mi>
        l
       </mi>
      </mrow>
     </msub>
    </math></span>, 2976, for the period considered, the month of January with a time step of 15 [min]. Lastly, a new KPI is introduced in this manuscript called control arc length <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0392.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0392.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        c
       </mi>
       <mi>
        o
       </mi>
       <mi>
        n
       </mi>
       <mi>
        l
       </mi>
       <mi>
        e
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span>. The idea of this KPI is to quantify the frequency of switching for the control system throughout the evaluation period. <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0393.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0393.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        c
       </mi>
       <mi>
        o
       </mi>
       <mi>
        n
       </mi>
       <mi>
        l
       </mi>
       <mi>
        e
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span> is the ratio between the length of the actual control trajectory. It is calculated on the total heat flow rate provided by the heat pump <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0394.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0394.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mrow>
       <mover>
        <mi>
         Q
        </mi>
        <mo>
         ˙
        </mo>
       </mover>
      </mrow>
      <mrow>
       <mi>
        h
       </mi>
       <mi>
        p
       </mi>
      </mrow>
     </msub>
    </math></span> versus a fictional reference trajectory <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0395.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0395.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       u
      </mi>
      <mrow>
       <mi>
        r
       </mi>
       <mi>
        e
       </mi>
       <mi>
        f
       </mi>
      </mrow>
     </msub>
    </math></span> that consider the control variable <i>u</i> to be constant for the evaluation period. A visual representation is given in Figure&nbsp;<a href="#F0010">10</a>.</p>
  <div class="figure figureViewer" id="F0010">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>16 September 2022
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 10. </span> On the y-axis is the value of the control variable <i>u</i> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0396.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0396.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           u
          </mi>
          <mrow>
           <mi>
            r
           </mi>
           <mi>
            e
           </mi>
           <mi>
            f
           </mi>
          </mrow>
         </msub>
        </math></span> is the reference value kept as constant. On the x-axis is time with the evaluation period taken from <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0397.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0397.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           t
          </mi>
          <mn>
           0
          </mn>
         </msub>
        </math></span> to <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0398.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0398.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           t
          </mi>
          <mi>
           f
          </mi>
         </msub>
        </math></span>.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0010image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/medium/tbps_a_2120631_f0010_oc.jpg" loading="lazy" height="170" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0010">
   <p class="captionText"><span class="captionLabel">Figure 10. </span> On the y-axis is the value of the control variable <i>u</i> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0396.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0396.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        u
       </mi>
       <mrow>
        <mi>
         r
        </mi>
        <mi>
         e
        </mi>
        <mi>
         f
        </mi>
       </mrow>
      </msub>
     </math></span> is the reference value kept as constant. On the x-axis is time with the evaluation period taken from <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0397.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0397.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        t
       </mi>
       <mn>
        0
       </mn>
      </msub>
     </math></span> to <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0398.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0398.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        t
       </mi>
       <mi>
        f
       </mi>
      </msub>
     </math></span>.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0010">
   <div class="figureFootNote-F0010"></div>
  </div>
  <p></p>
 </div>
</div>
<div id="S003" class="NLM_sec NLM_sec-type_results NLM_sec_level_1">
 <h2 id="_i24" class="section-heading-2">3. Results</h2>
 <p>Simulation evaluation results for the month of January are shown because similar conclusions were drawn from the rest of the heating season. As mentioned, all MPCs were updated for every 15 [min] time step with the control horizon of 24 [h]. Each MPC was calculated 2976 times for the simulation period and has around 1000 constraints and 600 optimization variables for the linear problems and 1200 optimization variables for the nonlinear problems.</p>
 <div id="S003-S2001" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i25">3.1. KPIs comparison</h3>
  <p>Figures&nbsp;<a href="#F0011">11</a> and&nbsp;<a href="#F0012">12</a> report the KPI results calculated by BOPTEST. From the Discomfort KPI <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0399.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0399.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        d
       </mi>
       <mi>
        i
       </mi>
       <mi>
        s
       </mi>
      </mrow>
     </msub>
    </math></span> in Figure <a href="#F0011">11</a>, most of the formulations outperform the rule based controller with more than 90% decrease in discomfort. The main reason is the ability of MPC to predict the step change in zone heating setpoint temperature and compensate for the delayed response of the floor heating system. However, the MPC7 solution using Bonmin with the Hybrid method led to discomfort similar to the baseline controller. The authors managed to make MPC7 work properly, not shown in the chart. However, it required significant manual tuning effort for the weight on comfort constraints and solver internal options (MINLP approximation relaxation, integer tolerance) to guide the solution. This highlights that Bonmin-Hyb is probably not robust enough for this type of problem.</p>
  <div class="figure figureViewer" id="F0011">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>16 September 2022
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 11. </span> BOPTEST KPIS for the month of January as thermal discomfort <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0400.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0400.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            d
           </mi>
           <mi>
            i
           </mi>
           <mi>
            s
           </mi>
          </mrow>
         </msub>
        </math></span> (top), computational time ratio <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0401.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0401.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            t
           </mi>
           <mi>
            i
           </mi>
           <mi>
            m
           </mi>
           <mi>
            r
           </mi>
          </mrow>
         </msub>
        </math></span> in logarithmic scale (middle), and energy cost <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0402.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0402.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            c
           </mi>
           <mi>
            o
           </mi>
           <mi>
            s
           </mi>
           <mi>
            t
           </mi>
          </mrow>
         </msub>
        </math></span> (bottom). The results are shown for all MPC combinations explained in Table&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button>.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0011image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/medium/tbps_a_2120631_f0011_oc.jpg" loading="lazy" height="445" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0011">
   <p class="captionText"><span class="captionLabel">Figure 11. </span> BOPTEST KPIS for the month of January as thermal discomfort <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0400.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0400.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        K
       </mi>
       <mrow>
        <mi>
         d
        </mi>
        <mi>
         i
        </mi>
        <mi>
         s
        </mi>
       </mrow>
      </msub>
     </math></span> (top), computational time ratio <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0401.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0401.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        K
       </mi>
       <mrow>
        <mi>
         t
        </mi>
        <mi>
         i
        </mi>
        <mi>
         m
        </mi>
        <mi>
         r
        </mi>
       </mrow>
      </msub>
     </math></span> in logarithmic scale (middle), and energy cost <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0402.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0402.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        K
       </mi>
       <mrow>
        <mi>
         c
        </mi>
        <mi>
         o
        </mi>
        <mi>
         s
        </mi>
        <mi>
         t
        </mi>
       </mrow>
      </msub>
     </math></span> (bottom). The results are shown for all MPC combinations explained in Table&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button>.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0011">
   <div class="figureFootNote-F0011"></div>
  </div>
  <div class="figure figureViewer" id="F0012">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>16 September 2022
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 12. </span> MPC specific KPIs for the month of January, Thermal heating power per square meter <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0403.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0403.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            e
           </mi>
           <mi>
            n
           </mi>
          </mrow>
         </msub>
        </math></span> (top), total computational time <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0404.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0404.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            t
           </mi>
           <mi>
            t
           </mi>
           <mi>
            o
           </mi>
           <mi>
            t
           </mi>
          </mrow>
         </msub>
        </math></span> in logarithmic scale (middle), Total number of solver time out or error statuses <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0405.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0405.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            e
           </mi>
           <mi>
            r
           </mi>
           <mi>
            r
           </mi>
          </mrow>
         </msub>
        </math></span> (bottom), the KPI description is presented in Table&nbsp;<button class="ref showTableEventRef" data-id="T0006">6</button>. The results are shown for all MPC combinations explained in Table&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button>.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0012image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/medium/tbps_a_2120631_f0012_oc.jpg" loading="lazy" height="442" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0012">
   <p class="captionText"><span class="captionLabel">Figure 12. </span> MPC specific KPIs for the month of January, Thermal heating power per square meter <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0403.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0403.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        K
       </mi>
       <mrow>
        <mi>
         e
        </mi>
        <mi>
         n
        </mi>
       </mrow>
      </msub>
     </math></span> (top), total computational time <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0404.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0404.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        K
       </mi>
       <mrow>
        <mi>
         t
        </mi>
        <mi>
         t
        </mi>
        <mi>
         o
        </mi>
        <mi>
         t
        </mi>
       </mrow>
      </msub>
     </math></span> in logarithmic scale (middle), Total number of solver time out or error statuses <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0405.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0405.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        K
       </mi>
       <mrow>
        <mi>
         e
        </mi>
        <mi>
         r
        </mi>
        <mi>
         r
        </mi>
       </mrow>
      </msub>
     </math></span> (bottom), the KPI description is presented in Table&nbsp;<button class="ref showTableEventRef" data-id="T0006">6</button>. The results are shown for all MPC combinations explained in Table&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button>.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0012">
   <div class="figureFootNote-F0012"></div>
  </div>
  <p></p>
  <p>Looking at the computational time ratio <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0406.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0406.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        t
       </mi>
       <mi>
        i
       </mi>
       <mi>
        m
       </mi>
       <mi>
        r
       </mi>
      </mrow>
     </msub>
    </math></span> in Figure <a href="#F0011">11</a> and total computational time <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0407.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0407.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        t
       </mi>
       <mi>
        t
       </mi>
       <mi>
        o
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span> in Figure <a href="#F0012">12</a>, QP and NLPs (MPC1 -- MPC4) required less computing time than MINLPs (MPC5-MPC10) as expected. However, all MPC formulations have a <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0408.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0408.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        t
       </mi>
       <mi>
        i
       </mi>
       <mi>
        m
       </mi>
       <mi>
        r
       </mi>
      </mrow>
     </msub>
    </math></span> value much lower than one, meaning that MINLPs could be used for a real time application from the computation perspective. Looking at a relative comparison of <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0409.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0409.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        t
       </mi>
       <mi>
        t
       </mi>
       <mi>
        o
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span>, MPC1 (QP) and MPC2 (NLP) take between 15 and 20 [min] to run for all 2976 optimization iterations, so on average from 0.3 to 0.4 [s] per optimization. MPC3 (NLP) and MPC4 (NLP) take between 50 and 60 [min], so on average from 1 to 1.3 [s] per optimization. The remaining MINLP formulations, i.e. MPC5 to MPC10, instead take from 1 [h] 40 [min] up to 2 [d] and 5 [h], so on average from 2 [s] to 64 [s] per optimization. This big variation of computational times shows that MINLP MPCs are sensitive to a formulation, initialization, and solver selection. In fact, the differences between MPC5 and MPC6 are only the initialization approach and the inclusion of <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0410.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0410.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mi>
        B
       </mi>
      </mrow>
     </msub>
    </math></span>, and the difference between MPC9 and MPC10 is only the solver. However, MPC5 and MPC10 result in much longer computational time (a factor of 10) caused by a lot of errors or timeouts for around 30% of the iterations (see the last subfigure in Figure <a href="#F0012">12</a>), meaning that the MINLP solvers are struggling to converge. Furthermore, SCIP was not able to find a solution without the <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0411.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0411.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mi>
        B
       </mi>
      </mrow>
     </msub>
    </math></span> binary objective. It is very interesting that all MINLP solvers benefit from the introduction of <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0412.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0412.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mi>
        B
       </mi>
      </mrow>
     </msub>
    </math></span> in terms of solver reliability and time, because the objective seems to be redundant for integer formulations and solvers. This might be explained by the fact that by introducing <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0413.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0413.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mi>
        B
       </mi>
      </mrow>
     </msub>
    </math></span>, each NLP approximation of the MINLP is itself an approximation of a MINLP problem. Furthermore, the addition of the binary constraint <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0414.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0414.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       j
      </mi>
      <mrow>
       <mi>
        B
       </mi>
      </mrow>
     </msub>
    </math></span> reduces the available control space, making the MINLP objective function more convex and bringing it closer to a Mixed Integer Convex Programming (MICP) problem.</p>
  <p>The comparisons of energy cost <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0415.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0415.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        c
       </mi>
       <mi>
        o
       </mi>
       <mi>
        s
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span> and thermal energy <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0416.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0416.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        e
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span> are shown in Figure <a href="#F0011">11</a> and in Figure <a href="#F0012">12</a>, respectively. For <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0417.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0417.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        e
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span>, all formulations and the baseline are within 6 % of each other, with MPC2, MPC4, MPC6, MPC7, and MPC9 being marginally better than the baseline, and MPC1, MPC3, MPC8 and MPC10 being marginally worse. The MPCs perform in a similar fashion with respect to the RBC because the case study considered is a newly built low transmittance building with low consumption. Therefore, not much energy can be wasted by a properly tuned RBC. Furthermore, the RBC is under heating the building as it can be seen by looking at the discomfort Kdis. Instead, the MPCs do a better than the RBC in shifting the thermal energy supplied to anticipate the demand of the setpoint to drastically reduce discomfort, while keeping the thermal input lower thanks to better management of the partial loads When looking at cost <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0418.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0418.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        c
       </mi>
       <mi>
        o
       </mi>
       <mi>
        s
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span> however, MPC1 (QP) is the worst performer with 5% increase with respect to the baseline RBC <span class="ref-lnk fn-ref-lnk lazy-ref"><a data-rid="EN0002" href="#" data-reflink="fn"><span class="off-screen">Footnote</span><sup>2</sup></a></span>, while MPC2 (NLP), MPC4 (NLP), MPC6 (MINLP) and MPC9 (MINLP) show the best performance with a 13% decrease in cost with respect to the baseline, which is aligned with other literature results. This is due to the fact that MPC1 adopts a simpler COP model,that is only a function of external temperature since the supply temperature is not a control variable, while the other formulations use a more precise COP definition including supply temperature allowing a more efficient use of the heat pump by keeping on average a lower supply temperature. It is not clear from this analysis alone why the MPC2, MPC4, MPC6 and MPC9 seem to outperform the other nonlinear formulations for these KPIs. For that, we consider a more detailed analysis of time series data in Section&nbsp;<a href="#S003-S2002">3.2</a>.</p>
 </div>
 <div id="S003-S2002" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i28">3.2. Typical day analysis</h3>
  <p>Figure&nbsp;<a href="#F0013">13</a> shows daily temperature and thermal power profiles grouped by similar control patterns based on aggressiveness of switching: medium (left figures): MPC1 and MPC7 with the baseline, smooth (middle figures): MPC2, MPC4, MPC6 and MPC9, aggressive (right figures): MPC3, MPC5,MPC8 and MPC10). The aggressive group's pattern could be explained by the convergence issues as indicated in the last panel of Figure <a href="#F0012">12</a> except for MPC3. Although there are cost savings and comfort improvements for those MPCs (see Figure <a href="#F0011">11</a>), they may not be applicable in practice due to short cycling which increases the wear of components. It is also interesting to see the influence of relaxation schemes for integer constraints: The only difference of MPC3 (NLP) compared with MPC2 (LNP) and MPC4 (NLP) that are in the smooth group (middle figures) is in rounding the MPC decision to enforce it to either 0 or 1. This rounding clearly introduces prediction errors and hence pushes MPC3 to solve an unexpected problem at the next time step. The aggressive result of MPC3 indicates that nonlinear MPC could be sensitive to prediction errors at least for this case study. Lastly, the frequent on-off of the system causes a higher discrepancy between the prediction of the low order model versus the emulator model. The main reason is that the Buildings envelope model is made up of hundreds of states while the reduced order model uses only a handful. The consequence is that the high frequency components for the aggressive case impact the temperature nodes in different ways between the emulator and reduced order models, increasing the error of the prediction. From the comprehensive analysis using KPIs of discomfort <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0419.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0419.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        d
       </mi>
       <mi>
        i
       </mi>
       <mi>
        s
       </mi>
      </mrow>
     </msub>
    </math></span>, cost <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0420.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0420.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        c
       </mi>
       <mi>
        o
       </mi>
       <mi>
        s
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span> and on-off switching <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0421.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0421.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        c
       </mi>
       <mi>
        o
       </mi>
       <mi>
        n
       </mi>
       <mi>
        l
       </mi>
       <mi>
        e
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span>, MPC2 (NLP), MPC4 (NLP), MPC6 (MINLP) and MPC9 (MINLP) that are in the smooth group are superior than other MPCs and the baseline, and MPC9 performs the best. However, as pointed out in Section&nbsp;<a href="#S003-S2001">3.1</a>, MINLP MPC formulations are sensitive to formulations, initialization approaches, solver selections and solver parameters, and the incremental savings of MPC9 are insignificant. Overall, we conclude that increasing the complexity of MINLP-MPC approaches does not bring substantial benefits at least for this case study but only adds computational burden, makes the MPC less robust, and requires more manual tuning efforts. The open-source and commercially available, general purpose MINLP solvers are not yet sufficiently reliable for real time MPC applications for the HVAC system.</p>
  <div class="figure figureViewer" id="F0013">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>16 September 2022
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 13. </span> Results for a typical day 15th of January, in the top row charts are the temperatures in the living room for the different formulations,in the bottom row charts are the total thermal power supplied by the heat pump to the floor heating system.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0013image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/medium/tbps_a_2120631_f0013_oc.jpg" loading="lazy" height="470" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0013">
   <p class="captionText"><span class="captionLabel">Figure 13. </span> Results for a typical day 15th of January, in the top row charts are the temperatures in the living room for the different formulations,in the bottom row charts are the total thermal power supplied by the heat pump to the floor heating system.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0013">
   <div class="figureFootNote-F0013"></div>
  </div>
  <p></p>
  <p>The newly introduced KPI <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0422.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0422.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        c
       </mi>
       <mi>
        o
       </mi>
       <mi>
        n
       </mi>
       <mi>
        l
       </mi>
       <mi>
        e
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span> described in Table&nbsp;<button class="ref showTableEventRef" data-id="T0006">6</button> can compactly indicate the level of short cycling. Indeed, from Figure&nbsp;<a href="#F0014">14</a>, which compares <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0423.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0423.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       K
      </mi>
      <mrow>
       <mi>
        c
       </mi>
       <mi>
        o
       </mi>
       <mi>
        n
       </mi>
       <mi>
        l
       </mi>
       <mi>
        e
       </mi>
       <mi>
        n
       </mi>
      </mrow>
     </msub>
    </math></span>, the same conclusion from the analysis of Figure <a href="#F0013">13</a> can be drawn: the smooth group (middle figures: MPC2, MPC4, MPC6 and MPC9) has half the control arc length of the aggressive group (right figures: MPC3, MPC5, MPC8 and MPC10). However, the difference between baseline and MPC1 which use an on-off approach and MPC2,MPC4,MPC6 and MPC9 which modulate the load more is not highlighted. The reason is that the control variable considered is the total heat pump power <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0424.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0424.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mrow>
      <mover>
       <mi>
        Q
       </mi>
       <mo>
        ˙
       </mo>
      </mover>
     </mrow>
    </math></span>, which partially masks the behaviour of separate control variables, water supply setpoint <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0425.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0425.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        i
       </mi>
       <mi>
        n
       </mi>
       <mo>
        ,
       </mo>
       <mi>
        s
       </mi>
       <mi>
        e
       </mi>
       <mi>
        t
       </mi>
      </mrow>
     </msub>
    </math></span> and valves on-off <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0426.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0426.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       u
      </mi>
      <mi>
       i
      </mi>
     </msub>
    </math></span>. The authors are aware of this simplification and will explore a more comprehensive approach in future work.</p>
  <div class="figure figureViewer" id="F0014">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">Performance comparison of quadratic, nonlinear, and mixed integer nonlinear MPC formulations and solvers on an air source heat pump hydronic floor heating system</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Zanetti%2C+Ettore"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Zanetti%2C+Ettore"><span class="NLM_given-names">Ettore</span> Zanetti</a> <a href="https://orcid.org/0000-0002-9056-3813"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Kim%2C+Donghun"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Kim%2C+Donghun"><span class="NLM_given-names">Donghun</span> Kim</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Blum%2C+David"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Blum%2C+David"><span class="NLM_given-names">David</span> Blum</a> <a href="https://orcid.org/0000-0003-3231-7937"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Scoccia%2C+Rossano"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Scoccia%2C+Rossano"><span class="NLM_given-names">Rossano</span> Scoccia</a> <a href="https://orcid.org/0000-0002-5894-7198"><img src="/templates/jsp/images/orcid.png"></a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Aprile%2C+Marcello"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Aprile%2C+Marcello"><span class="NLM_given-names">Marcello</span> Aprile</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2022.2120631">https://doi.org/10.1080/19401493.2022.2120631</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>16 September 2022
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 14. </span> Control arc length KPI <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0427.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0427.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            c
           </mi>
           <mi>
            o
           </mi>
           <mi>
            n
           </mi>
           <mi>
            l
           </mi>
           <mi>
            e
           </mi>
           <mi>
            n
           </mi>
          </mrow>
         </msub>
        </math></span> specific for the month of January. It allows for estimating the heat pump switching frequency for the different formulations. The KPI description is presented in Table&nbsp;<button class="ref showTableEventRef" data-id="T0006">6</button>. In this case the total power supplied by the heat pump was used to calculate <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0428.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0428.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <msub>
          <mi>
           K
          </mi>
          <mrow>
           <mi>
            c
           </mi>
           <mi>
            o
           </mi>
           <mi>
            n
           </mi>
           <mi>
            l
           </mi>
           <mi>
            e
           </mi>
           <mi>
            n
           </mi>
          </mrow>
         </msub>
        </math></span>.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0014image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/medium/tbps_a_2120631_f0014_oc.jpg" loading="lazy" height="226" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0014">
   <p class="captionText"><span class="captionLabel">Figure 14. </span> Control arc length KPI <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0427.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0427.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        K
       </mi>
       <mrow>
        <mi>
         c
        </mi>
        <mi>
         o
        </mi>
        <mi>
         n
        </mi>
        <mi>
         l
        </mi>
        <mi>
         e
        </mi>
        <mi>
         n
        </mi>
       </mrow>
      </msub>
     </math></span> specific for the month of January. It allows for estimating the heat pump switching frequency for the different formulations. The KPI description is presented in Table&nbsp;<button class="ref showTableEventRef" data-id="T0006">6</button>. In this case the total power supplied by the heat pump was used to calculate <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0428.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0428.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <msub>
       <mi>
        K
       </mi>
       <mrow>
        <mi>
         c
        </mi>
        <mi>
         o
        </mi>
        <mi>
         n
        </mi>
        <mi>
         l
        </mi>
        <mi>
         e
        </mi>
        <mi>
         n
        </mi>
       </mrow>
      </msub>
     </math></span>.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0014">
   <div class="figureFootNote-F0014"></div>
  </div>
  <p></p>
 </div>
</div>
<div id="S004" class="NLM_sec NLM_sec-type_conclusions NLM_sec_level_1">
 <h2 id="_i31" class="section-heading-2">4. Conclusions</h2>
 <p>This manuscript compared ten combinations of MPC formulations and solvers ranging between a QP formulation (MPC1), NLP formulations (MPC2–MPC4), and MINLPs (MPC5–MPC10) with a high focus on the assessment of MINLP MPCs for a residential radiant floor heating system. The performances were evaluated with a detailed emulator model where all MPCs exhibit unmodeled dynamics. The conclusions are summarized as below.</p>
 <ul class="NLM_list NLM_list-list_type-bullet">
  <li><p class="inline">MPC1 and MPC2 are both linear approximations, for the constraints, of the original MINLP problem. However, there is a large performance gap between the two. MPC1 is the most intuitive way to linearize the heat flow rate by combining valve and temperature into thermal power <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0429.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0429.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <mrow>
       <mover>
        <mi>
         Q
        </mi>
        <mo>
         ˙
        </mo>
       </mover>
      </mrow>
     </math></span>. However, in this way, the MPC is not able to accurately estimate the heat pump COP as a function of supply temperature, leading to an on-off operation of the system. MPC2, instead, used a less intuitive approach, keeping the valves always open and modulating only the supply temperature in order to maximize COP. Here, the more detailed COP formulation led to an overall better solution.</p></li>
  <li><p class="inline">MINLP MPC performance is sensitive to formulations, MINLP solvers, solver options and tolerances, and the corresponding tuning process is not trivial. However, a MINLP formulation is natural and more straightforward to implement, since the optimization variables could be consistent with the physical controllable variables and modelling approaches for simulations (e.g. the detailed COP model or use of physical valve positions as optimization variables).</p></li>
  <li><p class="inline">To make MINLP MPC properly work, it often required solving another, approximated MPC problem. In our case, an NLP MPC was solved for initializing an MINLP MPC.</p></li>
  <li><p class="inline">For this case study, no substantial benefits of any MINLP MPC formulation were found over an NLP MPC. Meanwhile, MINLP formulations dramatically increased computational time and were less stable, with time outs or errors occurring for over 30% of MPC control steps. In terms of generalization of the results, the authors think that for residential newly built buildings, the insulation between apartments is high enough, so that they can be considered almost adiabatic. Therefore, controlling the whole building would be almost equivalent to having a specific MPC for each apartment, making the problem very similar to the one dealt with in the manuscript. However, in the case of older buildings where the heat transfer between apartments is important, the coupling between the different MPCs must be done more carefully if using a distributed approach. Instead, a centralized approach would lead to a similar conclusion since more complex problem formulations are needed and MINLP solvers suffer exponentially more, in terms of computational time and robustness, the larger the optimal control problem becomes.</p></li>
  <li><p class="inline">This paper introduced and compared the state-of-the-art, open source MINLP solvers (SCIP, Bonmin) and commercial solver (Baron). They could be viable options for building HVAC optimal control problems with appropriate tuning, but they were not the best solution for this case study.</p></li>
  <li><p class="inline">From the overall analysis, it is shown that the initial effort of finding a suitable linear constraint formulation or reduce the unwanted control space (<i>jB</i>), (in modelling the radiant floor heat transfer) leads to identical energy and discomfort performance compared with a very well tuned MINLP MPC, while being faster and more robust.In fact, a lot of effort went into the optimal control community, other than the building control field, to try and locally approximate the MINLP as MILP or MICP with various approximation methods. Future work will investigate the performance of different approximation methods applied to building HVAC control problems. Therefore, the authors conclude that using a linear formulation for the constraints with a nonlinear objective function and proper initialization method, such as slightly randomized free floating solutions, gives a good balance between the accuracy of the prediction, computational requirements, and robustness. Furthermore, the outcome of this manuscript shows that the introduction of additional sensors, control inputs and network infrastructure to allow for a more complex predictive control system may not necessarily bring significant improvements with respect to a simpler, more robust formulation approach. Therefore, it is important for implementations to consider the reliability of the whole infrastructure.</p></li>
 </ul>
 <p></p>
</div>
<div id="S001a" class="NLM_sec NLM_sec_level_1">
 <h2 id="_i32" class="section-heading-2">Nomenclature</h2>
 <div id="S001b" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i33">Symbol</h3>
  <table summary="" class="NLM_def-list">
   <tbody>
    <tr>
     <td class="NLM_term"><i>δ</i></td>
     <td class="NLM_def"><p>Auxiliary temperature variable <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0430.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0430.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mo stretchy="false">
          [
         </mo><mrow>
          <mi mathvariant="normal">
           K
          </mi>
         </mrow><mo stretchy="false">
          ]
         </mo>
        </math></span></p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0431.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0431.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <mrow>
         <mover>
          <mi>
           H
          </mi>
          <mo>
           ˙
          </mo>
         </mover>
        </mrow>
       </math></span></td>
     <td class="NLM_def"><p>Enthalpy flow rate <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0432.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0432.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mo stretchy="false">
          [
         </mo><mrow>
          <mi mathvariant="normal">
           kW
          </mi>
         </mrow><mo stretchy="false">
          ]
         </mo>
        </math></span></p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0433.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0433.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <mrow>
         <mover>
          <mi>
           Q
          </mi>
          <mo>
           ˙
          </mo>
         </mover>
        </mrow>
       </math></span></td>
     <td class="NLM_def"><p>Heat flow rate <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0434.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0434.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mo stretchy="false">
          [
         </mo><mrow>
          <mi mathvariant="normal">
           kW
          </mi>
         </mrow><mo stretchy="false">
          ]
         </mo>
        </math></span></p></td>
    </tr>
    <tr>
     <td class="NLM_term">Φ</td>
     <td class="NLM_def"><p>Specific heat rate <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0435.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0435.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mo stretchy="false">
          [
         </mo><msup>
          <mrow>
           <mi mathvariant="normal">
            kW
           </mi>
           <mrow>
            <mo>
             /
            </mo>
           </mrow>
           <mi mathvariant="normal">
            m
           </mi>
          </mrow>
          <mn>
           2
          </mn>
         </msup><mo stretchy="false">
          ]
         </mo>
        </math></span></p></td>
    </tr>
    <tr>
     <td class="NLM_term"><i>A</i></td>
     <td class="NLM_def"><p>Flow or surface area <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0436.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0436.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mo stretchy="false">
          [
         </mo><msup>
          <mrow>
           <mi mathvariant="normal">
            m
           </mi>
          </mrow>
          <mn>
           2
          </mn>
         </msup><mo stretchy="false">
          ]
         </mo>
        </math></span></p></td>
    </tr>
    <tr>
     <td class="NLM_term"><i>C</i></td>
     <td class="NLM_def"><p>Heat Capacity <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0437.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0437.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mo stretchy="false">
          [
         </mo><mrow>
          <mi mathvariant="normal">
           kJ
          </mi>
          <mrow>
           <mo>
            /
           </mo>
          </mrow>
          <mi mathvariant="normal">
           K
          </mi>
         </mrow><mo stretchy="false">
          ]
         </mo>
        </math></span></p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0438.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0438.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msub>
         <mi>
          p
         </mi>
         <mi>
          e
         </mi>
        </msub>
       </math></span></td>
     <td class="NLM_def"><p>Electricity price <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0439.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0439.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mo stretchy="false">
          [
         </mo>
        </math></span>€<span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0440.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0440.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mo stretchy="false">
          ]
         </mo>
        </math></span></p></td>
    </tr>
    <tr>
     <td class="NLM_term"><i>R</i></td>
     <td class="NLM_def"><p>Thermal Resistance <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0441.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0441.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mo stretchy="false">
          [
         </mo><mrow>
          <mi mathvariant="normal">
           kW
          </mi>
          <mrow>
           <mo>
            /
           </mo>
          </mrow>
          <mi mathvariant="normal">
           K
          </mi>
         </mrow><mo stretchy="false">
          ]
         </mo>
        </math></span></p></td>
    </tr>
    <tr>
     <td class="NLM_term"><i>T</i></td>
     <td class="NLM_def"><p>Temperature <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0442.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0442.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mo stretchy="false">
          [
         </mo><mrow>
          <mi mathvariant="normal">
           K
          </mi>
         </mrow><mo stretchy="false">
          ]
         </mo>
        </math></span></p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0443.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0443.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msub>
         <mi>
          u
         </mi>
         <mi>
          i
         </mi>
        </msub>
       </math></span></td>
     <td class="NLM_def"><p>Control variable <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0444.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2023/tbps20.v016.i02/19401493.2022.2120631/20230215/images/tbps_a_2120631_ilm0444.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mo stretchy="false">
          [
         </mo><mo>
          −
         </mo><mo stretchy="false">
          ]
         </mo>
        </math></span></p></td>
    </tr>
   </tbody>
  </table>
 </div>
 <div id="S001c" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i34">Acronyms</h3>
  <table summary="" class="NLM_def-list">
   <tbody>
    <tr>
     <td class="NLM_term">API</td>
     <td class="NLM_def"><p>Application Programming Interface</p></td>
    </tr>
    <tr>
     <td class="NLM_term">BOPTEST</td>
     <td class="NLM_def"><p>Building Optimization Performance Test framework</p></td>
    </tr>
    <tr>
     <td class="NLM_term">COP</td>
     <td class="NLM_def"><p>Coefficient Of Performance</p></td>
    </tr>
    <tr>
     <td class="NLM_term">HVAC</td>
     <td class="NLM_def"><p>Heating, Ventilation and Air Conditioning</p></td>
    </tr>
    <tr>
     <td class="NLM_term">I or IP</td>
     <td class="NLM_def"><p>Integer or Integer Programming</p></td>
    </tr>
    <tr>
     <td class="NLM_term">KPI</td>
     <td class="NLM_def"><p>Key Performance Indicator</p></td>
    </tr>
    <tr>
     <td class="NLM_term">L or LP</td>
     <td class="NLM_def"><p>Linear or Linear Programming</p></td>
    </tr>
    <tr>
     <td class="NLM_term">MEF</td>
     <td class="NLM_def"><p>Major Economic Forum</p></td>
    </tr>
    <tr>
     <td class="NLM_term">MIC or MICP</td>
     <td class="NLM_def"><p>Mixed Integer Convex or Mixed Integer Convex Programming</p></td>
    </tr>
    <tr>
     <td class="NLM_term">MIL or MILP</td>
     <td class="NLM_def"><p>Mixed Integer Linear or Mixed Integer Linear Programming</p></td>
    </tr>
    <tr>
     <td class="NLM_term">MINL or MINLP</td>
     <td class="NLM_def"><p>Mixed Integer Nonlinear or Mixed Inger NonLinear Programming</p></td>
    </tr>
    <tr>
     <td class="NLM_term">MPC</td>
     <td class="NLM_def"><p>Model Predictive Control</p></td>
    </tr>
    <tr>
     <td class="NLM_term">NL or NLP</td>
     <td class="NLM_def"><p>Nonlinear or NonLinear Programming</p></td>
    </tr>
    <tr>
     <td class="NLM_term">NRMSE</td>
     <td class="NLM_def"><p>Normalized Root Mean Square Error</p></td>
    </tr>
    <tr>
     <td class="NLM_term">Q or QP</td>
     <td class="NLM_def"><p>Quadratic or Quadratic Programming</p></td>
    </tr>
    <tr>
     <td class="NLM_term">SQP</td>
     <td class="NLM_def"><p>Sequential Quadratic Programming</p></td>
    </tr>
   </tbody>
  </table>
 </div>
</div>