<div id="S001" class="NLM_sec NLM_sec-type_intro NLM_sec_level_1">
 <h2 id="_i3" class="section-heading-2">1. Introduction</h2>
 <p>The growing use of intermittent renewable energy sources has created substantial technical, economic and political challenges. One challenge of particular prominence and importance is the problem of matching uncertain generation with uncertain demand. A possible solution is the use of thermal and electrical storages, which effectively allows for shifting available generation to meet demand (Setlhaolo, Sichilalu, and Zhang&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0001" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2017</a></span>; Appino et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0002" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2018</a></span>). In this work, we concentrate on local storages within buildings, with a particular focus on batteries and hot water storage tanks. Considering the complexity of such distributed, multi-modal energy systems, optimization methods present a viable option for controlling such systems.</p>
 <div id="S001-S2001" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i4">1.1. Model predictive control</h3>
  <p>The optimization of distributed, multi-modal energy systems requires forecasting upcoming thermal and electrical demands, setting up an optimization model that represents the energy system and then solving the optimization model, resulting in control signals that are sent to the systems actuators, e.g. charging a battery, curtailing a photovoltaic array or activating a heat pump. Since each of these steps introduces errors, such as forecasting errors and modelling errors, Model Predictive Control (MPC) is typically applied to such control problems.</p>
  <p>The MPC approach has been in use since the 1980s and has a well-developed theory (Kwon, Bruckstein, and Kailath&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0003" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>1983</a></span>; Mayne et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0004" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2000</a></span>; Qin and Badgwell&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0005" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2003</a></span>). The main idea of MPC is to perform a receding horizon optimal control strategy such that the best controller input over a finite horizon is calculated but only the current time step is implemented. Afterwards, the state is updated and the process repeats for the remaining time steps. This allows for the consideration of future events and real-time flexibility. It is also well known that each new optimization horizon can adjust for some inaccuracies (Garcia, Prett, and Morari&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0006" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>1989</a></span>). Many practical applications such as battery scheduling problems (Arnold and Andersson&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0007" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2011</a></span>), torque control (Geyer&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0008" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2009</a></span>) and building control (Maasoumy et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0009" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2014</a></span>) involve nonlinear effects but the models used in MPC are most frequently only linear. The success of MPC in these applications derives in part from the fact that even though the dynamics of the systems in question are nonlinear, they are approximately linear over sufficiently short time periods, and thus a linear model that is continuously adjusted by empirical data can allow for robust control while still guaranteeing some notion of optimality. There are different approaches to model energy systems in such MPC control models.</p>
 </div>
 <div id="S001-S2002" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i5">1.2. Energy system modelling</h3>
  <p>Considering local storages within buildings, both batteries and hot water tanks have dynamics which are inherently non-linear and thus are generally not accurately modelled via linear equations. However, the degree to which they are inaccurate is only evaluated for static operation (Oliveski, Krenzinger, and Vielmo&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0010" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2003</a></span>).</p>
  <p>While simulation software typically discretizes hot water storage tanks into multiple vertical layers (Oliveski, Krenzinger, and Vielmo&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0010" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2003</a></span>), MPC models follow different approaches. Most commonly, thermal storage units are modelled as thermal capacities that are perfectly mixed and are represented by their homogeneously distributed internal energy (Collazos, Maréchal, and Gähler&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0011" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2009</a></span>; Ashouri et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0012" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2013</a></span>; Wakui and Yokoyama&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0013" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2014</a></span>; D'Ettorre et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0014" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2019</a></span>). This approach therefore neglects thermal stratification that is inherent to these components. Only a few studies tried to represent thermal stratification in mixed-integer linear programs. In Fazlollahi, Becker, and Marchal&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0015" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2014</a></span>), the authors assume the temperatures in the top and bottom layers in their storage model as parameters. Within the optimization model, they discretize the temperature difference and compute the resulting volumes of each layer (Fazlollahi, Becker, and Marchal&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0015" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2014</a></span>). This approach is able to compute the stratification inside the storage, but in most applications, the temperature levels are decision variables of the optimization problem which cannot be computed with this model. Steen et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0016" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2015</a></span>) propose to implement two simple storage models to represent a high temperature (HT) and a low temperature (LT) section within the storage tank. Their model is able to account for the charging of the LT section with HT fluid, but does not consider LT fluid flowing into the HT section if the HT section is discharged.</p>
  <p>Similar to hot water storage tanks, there exist different approaches to model battery storages. There exist nonlinear approaches to model effects such as preventing a simultaneous charging and discharging of the battery (Appino et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0002" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2018</a></span>). Alternatively, Murray, Faulwasser, and Hagenmeyer&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0017" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2018</a></span>);&nbsp;Sass et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0018" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2020</a></span>) illustrate how such nonlinear battery models can be reformulated with mixed-integer linear approaches. In Bösenberg et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0019" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2015</a></span>), it is shown that higher cycling rates can reduce battery lifetime, and thus a controller which avoids this can reduce long term maintenance costs. Smart metering is a highly related topic to battery control and some research has shown that levelling the power profile can help to obscure local load profiles from a centralized controller Yang et al. (<span class="ref-lnk lazy-ref"><a data-rid="CIT0020" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2014</a></span>).</p>
 </div>
 <div id="S001-S2003" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i6">1.3. Contribution</h3>
  <p>As previously mentioned, there exist a number of approaches that seek to solve the optimal control problem of distributed, multi-modal energy systems. Each approach utilizes different models and solution methods, but to date there has been no analysis of how best to formulate and solve this problem. The various combinations of modelling choices result in non-linear, mixed-integer linear and mixed-integer nonlinear systems. The main contribution of the present paper is to provide some insight as to which components of the Battery and Thermal Storage Scheduling (BATSS) problem should be modelled with linear dynamics and which require more complex modelling.</p>
  <p>This paper is organized as follows: Section&nbsp;<a href="#S002">2</a> proposes a number of different modelling alternatives for the combined battery and thermal storage scheduling problem. Section&nbsp;<a href="#S003">3</a> solves the problems posed in Section&nbsp;<a href="#S002">2</a> using state-of-the-art solution methods and these results are discussed in Section&nbsp;<a href="#S004">4</a>. Finally, Section&nbsp;<a href="#S005">5</a> discusses the results of Section&nbsp;<a href="#S003">3</a> and provides an outlook on possible future research directions.</p>
 </div>
</div>
<div id="S002" class="NLM_sec NLM_sec_level_1">
 <h2 id="_i7" class="section-heading-2">2. Models</h2>
 <p>Although there is no standard formulation of the BATSS problem, any formulation will share a number of common features. Namely, there is a cost for total power used, heat pump, thermal storage, electric battery and some coupling of the subsystems. There may be multiple storages and loads, but we will restrict our analysis to the case of a single household (i.e. a heat pump, battery and thermal storages for both domestic hot water and space heating use). All conclusions based on the analysis of the single house case should apply to BATSS problem for multiple households as the form of the problem does not change, except for a linear coupling of the households.</p>
 <p>Sections&nbsp;<a href="#S002-S2001">2.1</a>–&nbsp;<a href="#S002-S2005">2.5</a> give detailed descriptions of each of the major components of the model, which is summarized in Figure&nbsp;<a href="#F0001">1</a>.</p>
 <div class="figure figureViewer" id="F0001">
  <div class="hidden figureViewerArticleInfo">
   <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>05 November 2020
    </div>
   </div>
  </div>
  <div class="figureThumbnailContainer">
   <div class="figureInfo">
    <div class="short-legend">
     <p class="captionText"><span class="captionLabel">Figure 1. </span> Schematic diagram of the system to be optimized.</p>
    </div>
   </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0001image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/medium/tbps_a_1838611_f0001_oc.jpg" loading="lazy" height="500" width="446"></a>
   <div class="figureDownloadOptions">
    <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
   </div>
  </div>
 </div>
 <div class="hidden rs_skip" id="fig-description-F0001">
  <p class="captionText"><span class="captionLabel">Figure 1. </span> Schematic diagram of the system to be optimized.</p>
 </div>
 <div class="hidden rs_skip" id="figureFootNote-F0001">
  <div class="figureFootNote-F0001"></div>
 </div>
 <p></p>
 <div id="S002-S2001" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i9">2.1. Model of connection to main grid</h3>
  <p>The primary objective of any BATSS problem is to minimize electricity costs. Let the power fed into the main grid at time <i>t</i> be denoted by <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0001.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0001.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msubsup>
      <mi>
       P
      </mi>
      <mi>
       G
      </mi>
      <mo>
       +
      </mo>
     </msubsup><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo><mo>
      ≥
     </mo><mn>
      0
     </mn>
    </math></span> and the power drawn from the grid at that time step be likewise denoted by <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0002.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0002.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msubsup>
      <mi>
       P
      </mi>
      <mi>
       G
      </mi>
      <mo>
       −
      </mo>
     </msubsup><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo><mo>
      ≤
     </mo><mn>
      0
     </mn>
    </math></span>. Let the revenue per kW from feed-in at time <i>t</i> be denoted by <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0003.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0003.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msup>
      <mi>
       c
      </mi>
      <mo>
       +
      </mo>
     </msup><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo><mo>
      ≥
     </mo><mn>
      0
     </mn>
    </math></span> and the cost of purchasing from the grid at time <i>t</i> by <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0004.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0004.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msup>
      <mi>
       c
      </mi>
      <mo>
       −
      </mo>
     </msup><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo><mo>
      ≤
     </mo><mn>
      0
     </mn>
    </math></span>. The objective of minimizing electricity costs over the discretized time horizon <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0005.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0005.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mi>
      t
     </mi><mo>
      ∈
     </mo><mo fence="false" stretchy="false">
      {
     </mo><mn>
      1
     </mn><mo>
      ,
     </mo><mo>
      …
     </mo><mo>
      ,
     </mo><mi>
      H
     </mi><mo fence="false" stretchy="false">
      }
     </mo>
    </math></span> can then be formulated as <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0001.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0001.gif&quot;}"><span class="mml-formula"><span class="disp_formula_label_div"><span id="M0001" class="disp-formula-label">(1) </span></span></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
      <mtr>
       <mtd>
        <mo movablelimits="true" form="prefix">
         max
        </mo>
        <mspace width="1em"></mspace>
        <munderover>
         <mo>
          ∑
         </mo>
         <mrow>
          <mi>
           t
          </mi>
          <mo>
           =
          </mo>
          <mn>
           1
          </mn>
         </mrow>
         <mrow>
          <mi>
           H
          </mi>
         </mrow>
        </munderover>
        <mrow>
         <mo>
          (
         </mo>
         <msup>
          <mi>
           c
          </mi>
          <mo>
           +
          </mo>
         </msup>
         <mo stretchy="false">
          (
         </mo>
         <mi>
          t
         </mi>
         <mo stretchy="false">
          )
         </mo>
         <msubsup>
          <mi>
           P
          </mi>
          <mi>
           G
          </mi>
          <mo>
           +
          </mo>
         </msubsup>
         <mo stretchy="false">
          (
         </mo>
         <mi>
          t
         </mi>
         <mo stretchy="false">
          )
         </mo>
         <mo>
          −
         </mo>
         <msup>
          <mi>
           c
          </mi>
          <mo>
           −
          </mo>
         </msup>
         <mo stretchy="false">
          (
         </mo>
         <mi>
          t
         </mi>
         <mo stretchy="false">
          )
         </mo>
         <msubsup>
          <mi>
           P
          </mi>
          <mi>
           G
          </mi>
          <mo>
           −
          </mo>
         </msubsup>
         <mo stretchy="false">
          (
         </mo>
         <mi>
          t
         </mi>
         <mo stretchy="false">
          )
         </mo>
         <mo>
          )
         </mo>
        </mrow>
        <msub>
         <mi mathvariant="normal">
          Δ
         </mi>
         <mi>
          t
         </mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
    </math><span class="mathjaxLabel"><span class="disp_formula_label_div"><span id="M0001" class="disp-formula-label">(1) </span></span></span></span> where <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0006.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0006.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi mathvariant="normal">
       Δ
      </mi>
      <mi>
       t
      </mi>
     </msub>
    </math></span> is the length of each time step. In principle, it is possible for the solution to contain both <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0007.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0007.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msubsup>
      <mi>
       P
      </mi>
      <mi>
       G
      </mi>
      <mo>
       +
      </mo>
     </msubsup><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo><mo>
      &gt;
     </mo><mn>
      0
     </mn>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0008.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0008.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msubsup>
      <mi>
       P
      </mi>
      <mi>
       G
      </mi>
      <mo>
       −
      </mo>
     </msubsup><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo><mo>
      &gt;
     </mo><mn>
      0
     </mn>
    </math></span> for some time step <i>t</i>. To avoid this, one can use complementarity constraints. These may be formulated exactly as mixed-integer linear inequality constraints (Equation&nbsp;(<a href="#M0002">2</a>)) or inexactly via the continuous-valued nonlinear Fischer–Burmeister relaxation (Fischer&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0021" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>1992</a></span>) (Equation&nbsp;(<a href="#M0003">3</a>)): <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0002.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0002.gif&quot;}"><span class="mml-formula"><span class="disp_formula_label_div"><span id="M0002" class="disp-formula-label">(2) </span></span></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
      <mtr>
       <mtd>
        <mn>
         0
        </mn>
        <mo>
         ≤
        </mo>
        <msubsup>
         <mi>
          P
         </mi>
         <mi>
          G
         </mi>
         <mo>
          +
         </mo>
        </msubsup>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
       <mtd>
        <mi></mi>
        <mo>
         ≤
        </mo>
        <mo stretchy="false">
         (
        </mo>
        <mn>
         1
        </mn>
        <mo>
         −
        </mo>
        <mi>
         z
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <msub>
         <mover>
          <mi>
           P
          </mi>
          <mo accent="false">
           ¯
          </mo>
         </mover>
         <mi>
          G
         </mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>
         z
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <msub>
         <munder>
          <mi>
           P
          </mi>
          <mo>
           _
          </mo>
         </munder>
         <mi>
          G
         </mi>
        </msub>
        <mo>
         ≤
        </mo>
        <msubsup>
         <mi>
          P
         </mi>
         <mi>
          G
         </mi>
         <mo>
          −
         </mo>
        </msubsup>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
       <mtd>
        <mi></mi>
        <mo>
         ≤
        </mo>
        <mn>
         0
        </mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow>
         <mi mathvariant="normal">
          where
         </mi>
        </mrow>
        <mspace width="thinmathspace"></mspace>
        <mi>
         z
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
       <mtd>
        <mi></mi>
        <mo>
         ∈
        </mo>
        <mo fence="false" stretchy="false">
         {
        </mo>
        <mn>
         0
        </mn>
        <mo>
         ,
        </mo>
        <mn>
         1
        </mn>
        <mo fence="false" stretchy="false">
         }
        </mo>
       </mtd>
      </mtr>
     </mtable>
    </math><span class="mathjaxLabel"><span class="disp_formula_label_div"><span id="M0002" class="disp-formula-label">(2) </span></span></span></span> <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0003.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0003.gif&quot;}"><span class="mml-formula"><span class="disp_formula_label_div"><span id="M0003" class="disp-formula-label">(3) </span></span></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
      <mtr>
       <mtd>
        <mn>
         0
        </mn>
        <mo>
         ≤
        </mo>
        <msubsup>
         <mi>
          P
         </mi>
         <mi>
          G
         </mi>
         <mo>
          +
         </mo>
        </msubsup>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
       <mtd>
        <mi></mi>
        <mo>
         ≤
        </mo>
        <msub>
         <mover>
          <mi>
           P
          </mi>
          <mo accent="false">
           ¯
          </mo>
         </mover>
         <mi>
          G
         </mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <msub>
         <munder>
          <mi>
           P
          </mi>
          <mo>
           _
          </mo>
         </munder>
         <mi>
          G
         </mi>
        </msub>
        <mo>
         ≤
        </mo>
        <msubsup>
         <mi>
          P
         </mi>
         <mi>
          G
         </mi>
         <mo>
          −
         </mo>
        </msubsup>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
       <mtd>
        <mi></mi>
        <mo>
         ≤
        </mo>
        <mn>
         0
        </mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mi>
         ϵ
        </mi>
        <mo>
         ≤
        </mo>
        <msubsup>
         <mi>
          P
         </mi>
         <mi>
          G
         </mi>
         <mo>
          +
         </mo>
        </msubsup>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <msubsup>
         <mi>
          P
         </mi>
         <mi>
          G
         </mi>
         <mo>
          −
         </mo>
        </msubsup>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
       <mtd>
        <mi></mi>
        <mo>
         ≤
        </mo>
        <mn>
         0
        </mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow>
         <mi mathvariant="normal">
          for
         </mi>
         <mspace width="thinmathspace"></mspace>
         <mi mathvariant="normal">
          some
         </mi>
        </mrow>
        <mspace width="thinmathspace"></mspace>
        <mi>
         ϵ
        </mi>
       </mtd>
       <mtd>
        <mi></mi>
        <mo>
         &lt;
        </mo>
        <mn>
         0
        </mn>
       </mtd>
      </mtr>
     </mtable>
    </math><span class="mathjaxLabel"><span class="disp_formula_label_div"><span id="M0003" class="disp-formula-label">(3) </span></span></span></span> where <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0009.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0009.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mover>
       <mi>
        P
       </mi>
       <mo accent="false">
        ¯
       </mo>
      </mover>
      <mi>
       G
      </mi>
     </msub>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0010.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0010.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <munder>
       <mi>
        P
       </mi>
       <mo>
        _
       </mo>
      </munder>
      <mi>
       G
      </mi>
     </msub>
    </math></span> are the upper and lower bounds on the power to/from the grid. A tighter Fischer–Burmeister relaxation (i.e., where <i>ε</i> is closer to 0) will result in more accurate solutions, but runs the risk of numerical issues for some solution methods.</p>
  <p>As the cost of buying electricity from the main grid typically differs from the price of selling electricity to the grid, an integer decision variable can be used to differentiate between these two cases and enforce a complementarity constraint between them. Alternatively, absolute value functions may be used, but this would imply solving a real-valued Nonlinear Program (NLP) instead of a Mixed Integer Linear Program (MILP). As shown in Murray, Faulwasser, and Hagenmeyer&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0017" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2018</a></span>), the latter generally gives better results for the BATSS problem (Table&nbsp;<button class="ref showTableEventRef" data-id="T0001">1</button>).</p>
  <div class="tableViewerArticleInfo hidden">
   <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>05 November 2020
    </div>
   </div>
  </div>
  <div class="tableView">
   <div class="tableCaption">
    <div class="short-legend">
     <h3><b>Table 1. Grid connection parameters. Based on most recent values for private households in Western Germany.</b></h3>
    </div>
   </div>
   <div class="tableDownloadOption" data-hascsvlnk="false" id="T0001-table-wrapper">
    <a data-id="T0001" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
   </div>
  </div>
  <p></p>
 </div>
 <div id="S002-S2002" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i14">2.2. Models of heat pump</h3>
  <p>One of the major components of the battery and thermal storage system is the heat pump. It is a device that uses electricity to heat water for domestic hot water or space heating usage or for charging either of the thermal storage tanks. We consider a two-point controlled air-to-water heat pump. Using different set-temperatures for domestic hot water and space heating results in three discrete operating modes for each time step, depending on whether it is providing water for domestic or space heating use<span class="ref-lnk fn-ref-lnk lazy-ref"><a data-rid="EN0001" href="#" data-reflink="fn"><span class="off-screen">Footnote</span><sup>1</sup></a></span>, or neither. Thus an integer decision variable is used to model this choice. More information on heat pumps can be found in Langley&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0022" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2002</a></span>);&nbsp;Grassi&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0023" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2017</a></span>).</p>
  <p>Equations:</p>
  <ul class="NLM_list NLM_list-list_type-bullet">
   <li><p class="inline">Power usage of heat pump</p><p><span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0017.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0017.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         P
        </mi>
        <mrow>
         <mi>
          h
         </mi>
         <mi>
          p
         </mi>
        </mrow>
       </msub><mo stretchy="false">
        (
       </mo><mi>
        t
       </mi><mo stretchy="false">
        )
       </mo><mo>
        =
       </mo><msub>
        <mi>
         P
        </mi>
        <mrow>
         <mi>
          d
         </mi>
         <mi>
          h
         </mi>
         <mi>
          w
         </mi>
        </mrow>
       </msub><msub>
        <mi>
         y
        </mi>
        <mrow>
         <mi>
          d
         </mi>
         <mi>
          h
         </mi>
         <mi>
          w
         </mi>
        </mrow>
       </msub><mo stretchy="false">
        (
       </mo><mi>
        t
       </mi><mo stretchy="false">
        )
       </mo><mo>
        +
       </mo><msub>
        <mi>
         P
        </mi>
        <mrow>
         <mi>
          s
         </mi>
         <mi>
          h
         </mi>
        </mrow>
       </msub><msub>
        <mi>
         y
        </mi>
        <mrow>
         <mi>
          s
         </mi>
         <mi>
          h
         </mi>
        </mrow>
       </msub><mo stretchy="false">
        (
       </mo><mi>
        t
       </mi><mo stretchy="false">
        )
       </mo>
      </math></span></p></li>
   <li><p class="inline">Heat output</p><p><span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0018.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0018.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         Q
        </mi>
        <mrow>
         <mi>
          h
         </mi>
         <mi>
          p
         </mi>
        </mrow>
       </msub><mo stretchy="false">
        (
       </mo><mi>
        t
       </mi><mo stretchy="false">
        )
       </mo><mo>
        =
       </mo><mi>
        μ
       </mi><mo stretchy="false">
        (
       </mo><mi>
        t
       </mi><mo>
        ,
       </mo><mi>
        T
       </mi><mo stretchy="false">
        )
       </mo><msub>
        <mi>
         P
        </mi>
        <mrow>
         <mi>
          h
         </mi>
         <mi>
          p
         </mi>
        </mrow>
       </msub><mo stretchy="false">
        (
       </mo><mi>
        t
       </mi><mo stretchy="false">
        )
       </mo>
      </math></span></p></li>
   <li><p class="inline">Only choose one temperature setting</p><p><span class="NLM_disp-formula-image inline-formula rs_preserve">
      <noscript>
       <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0019.gif" alt="">
      </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0019.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
      <math>
       <msub>
        <mi>
         y
        </mi>
        <mrow>
         <mi>
          d
         </mi>
         <mi>
          h
         </mi>
         <mi>
          w
         </mi>
        </mrow>
       </msub><mo stretchy="false">
        (
       </mo><mi>
        t
       </mi><mo stretchy="false">
        )
       </mo><mo>
        +
       </mo><msub>
        <mi>
         y
        </mi>
        <mrow>
         <mi>
          s
         </mi>
         <mi>
          h
         </mi>
        </mrow>
       </msub><mo stretchy="false">
        (
       </mo><mi>
        t
       </mi><mo stretchy="false">
        )
       </mo><mo>
        ≤
       </mo><mn>
        1
       </mn>
      </math></span></p></li>
  </ul>
  <p></p>
  <p>Thereby <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0020.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0020.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       P
      </mi>
      <mrow>
       <mi>
        d
       </mi>
       <mi>
        h
       </mi>
       <mi>
        w
       </mi>
      </mrow>
     </msub>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0021.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0021.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       P
      </mi>
      <mrow>
       <mi>
        s
       </mi>
       <mi>
        h
       </mi>
      </mrow>
     </msub>
    </math></span> are the power usages of the heat pump for water at 60<span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0022.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0022.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msup>
      <mi></mi>
      <mrow>
       <mo>
        ∘
       </mo>
      </mrow>
     </msup>
    </math></span>C and 35 <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0023.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0023.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msup>
      <mi></mi>
      <mrow>
       <mo>
        ∘
       </mo>
      </mrow>
     </msup>
    </math></span>C, respectively. Likewise, <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0024.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0024.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       y
      </mi>
      <mrow>
       <mi>
        d
       </mi>
       <mi>
        h
       </mi>
       <mi>
        w
       </mi>
      </mrow>
     </msub>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0025.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0025.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       y
      </mi>
      <mrow>
       <mi>
        s
       </mi>
       <mi>
        h
       </mi>
      </mrow>
     </msub>
    </math></span> are the controls associated with each of these temperature outputs (cf. Table&nbsp;<button class="ref showTableEventRef" data-id="T0002">2</button>). The heat added to the thermal storage tanks is denoted by <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0026.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0026.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       Q
      </mi>
      <mrow>
       <mi>
        h
       </mi>
       <mi>
        p
       </mi>
      </mrow>
     </msub>
    </math></span>, where the coefficient of performance (COP) <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0027.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0027.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mi>
      μ
     </mi><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo>
      ,
     </mo><mi>
      T
     </mi><mo stretchy="false">
      )
     </mo>
    </math></span> depends on the environment temperature at time <i>t</i> and desired output temperature <i>T</i>. For the domestic hot water tank, this is 60 <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0028.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0028.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msup>
      <mi></mi>
      <mrow>
       <mo>
        ∘
       </mo>
      </mrow>
     </msup>
    </math></span>, and 35 for the space heating tank. If a temperature forecast is given, then these coefficients can be precomputed. The ambient temperature and heating demand are shown in Figure&nbsp;<a href="#F0002">2</a>, and the temperature-dependent COP for the investigated heat pump is illustrated in Figure&nbsp;<a href="#F0003">3</a>. Thereby, the blue curve depicts the COP when providing heat for space heating and the red curve shows the COP for domestic hot water provision.</p>
  <div class="figure figureViewer" id="F0002">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>05 November 2020
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 2. </span> Ambient temperature data taken from Deutscher Wetterdienst&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0024" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2017</a></span>). The time frame spans several days in spring in Aachen. The solid red line is the ambient temperature, the dotted blue line is the domestic hot water demand and the dashed green line is the space heating demand.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0002image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/medium/tbps_a_1838611_f0002_oc.jpg" loading="lazy" height="201" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0002">
   <p class="captionText"><span class="captionLabel">Figure 2. </span> Ambient temperature data taken from Deutscher Wetterdienst&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0024" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2017</a></span>). The time frame spans several days in spring in Aachen. The solid red line is the ambient temperature, the dotted blue line is the domestic hot water demand and the dashed green line is the space heating demand.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0002">
   <div class="figureFootNote-F0002"></div>
  </div>
  <div class="figure figureViewer" id="F0003">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>05 November 2020
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 3. </span> Collected data for the coefficient of performance for a given heat pump <span class="ref-lnk lazy-ref"><a data-rid="CIT0025" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>Dimplex</a></span> with a linear interpolation. The solid blue line denotes the COP given the required <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0029.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0029.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mn>
          60
         </mn><mi>
          deg
         </mi>
        </math></span> output for the domestic hot water tank. Likewise, the dashed red line denotes the COP for the <span class="NLM_disp-formula-image inline-formula rs_preserve">
        <noscript>
         <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0030.gif" alt="">
        </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0030.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
        <math>
         <mn>
          35
         </mn><mi>
          deg
         </mi>
        </math></span> required by the space heating tank.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0003image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/medium/tbps_a_1838611_f0003_oc.jpg" loading="lazy" height="199" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0003">
   <p class="captionText"><span class="captionLabel">Figure 3. </span> Collected data for the coefficient of performance for a given heat pump <span class="ref-lnk lazy-ref"><a data-rid="CIT0025" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>Dimplex</a></span> with a linear interpolation. The solid blue line denotes the COP given the required <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0029.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0029.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <mn>
       60
      </mn><mi>
       deg
      </mi>
     </math></span> output for the domestic hot water tank. Likewise, the dashed red line denotes the COP for the <span class="NLM_disp-formula-image inline-formula rs_preserve">
     <noscript>
      <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0030.gif" alt="">
     </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0030.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
     <math>
      <mn>
       35
      </mn><mi>
       deg
      </mi>
     </math></span> required by the space heating tank.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0003">
   <div class="figureFootNote-F0003"></div>
  </div>
  <div class="tableViewerArticleInfo hidden">
   <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>05 November 2020
    </div>
   </div>
  </div>
  <div class="tableView">
   <div class="tableCaption">
    <div class="short-legend">
     <h3><b>Table 2. Heat pump parameters. Technical data based on Dimplex LA 12TU heat pump <span class="ref-lnk lazy-ref"><a data-rid="CIT0025" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>Dimplex</a></span>.</b></h3>
    </div>
   </div>
   <div class="tableDownloadOption" data-hascsvlnk="false" id="T0002-table-wrapper">
    <a data-id="T0002" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
   </div>
  </div>
  <p></p>
  <p>While the heat pump has discrete settings, one may require these to be applied for the entire time step or just for a fraction. In the first case, the control decisions <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0035.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0035.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       y
      </mi>
      <mrow>
       <mi>
        d
       </mi>
       <mi>
        h
       </mi>
       <mi>
        w
       </mi>
      </mrow>
     </msub>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0036.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0036.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       y
      </mi>
      <mrow>
       <mi>
        s
       </mi>
       <mi>
        h
       </mi>
      </mrow>
     </msub>
    </math></span> will be discrete valued and in the second case, they will be continuous. Both cases are shown in Equations&nbsp;(<a href="#M0004">4</a>) and&nbsp;(<a href="#M0005">5</a>): <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0004.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0004.gif&quot;}"><span class="mml-formula"><span class="disp_formula_label_div"><span id="M0004" class="disp-formula-label">(4) </span></span></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
      <mtr>
       <mtd></mtd>
       <mtd>
        <msub>
         <mi>
          y
         </mi>
         <mrow>
          <mi>
           d
          </mi>
          <mi>
           h
          </mi>
          <mi>
           w
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         ∈
        </mo>
        <mo fence="false" stretchy="false">
         {
        </mo>
        <mn>
         0
        </mn>
        <mo>
         ,
        </mo>
        <mn>
         1
        </mn>
        <mo fence="false" stretchy="false">
         }
        </mo>
        <mo>
         ,
        </mo>
        <mspace width="1em"></mspace>
        <mi mathvariant="normal">
         ∀
        </mi>
        <mspace width="thinmathspace"></mspace>
        <mi>
         t
        </mi>
       </mtd>
      </mtr>
     </mtable>
    </math><span class="mathjaxLabel"><span class="disp_formula_label_div"><span id="M0004" class="disp-formula-label">(4) </span></span></span></span> <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0005.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0005.gif&quot;}"><span class="mml-formula"><span class="disp_formula_label_div"><span id="M0005" class="disp-formula-label">(5) </span></span></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
      <mtr>
       <mtd></mtd>
       <mtd>
        <mn>
         0
        </mn>
        <mo>
         ≤
        </mo>
        <msub>
         <mi>
          y
         </mi>
         <mrow>
          <mi>
           d
          </mi>
          <mi>
           h
          </mi>
          <mi>
           w
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         ≤
        </mo>
        <mn>
         1
        </mn>
        <mo>
         ,
        </mo>
        <mspace width="1em"></mspace>
        <mi mathvariant="normal">
         ∀
        </mi>
        <mspace width="thinmathspace"></mspace>
        <mi>
         t
        </mi>
       </mtd>
      </mtr>
     </mtable>
    </math><span class="mathjaxLabel"><span class="disp_formula_label_div"><span id="M0005" class="disp-formula-label">(5) </span></span></span></span> The advantage of&nbsp;(<a href="#M0004">4</a>) is that the solution is clear and well-defined, however, it can lead to some inefficiency due to overcharging. For&nbsp;(<a href="#M0005">5</a>), the precise amount of heating can be applied, but the exact time when the heatpump is activated is unclear. One could define the activation to always be from the beginning of the time step, however for multiple time steps with partial activations this could lead to cycling losses or increased maintenance costs to sequences of short activations.</p>
 </div>
 <div id="S002-S2003" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i20">2.3. Models of thermal storage tanks</h3>
  <p>Typically, simulation software discretizes thermal energy storages into multiple segments (nodes) in the vertical direction (Powell and Edgar&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0026" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2013</a></span>). Each node has a certain temperature and water mass. The temperature of the tank is constantly losing thermal energy to the environment, based on tank parameters (shown in Table&nbsp;<button class="ref showTableEventRef" data-id="T0003">3</button>) and ambient temperature (shown in Figure&nbsp;<a href="#F0002">2</a>). Furthermore, if the storage is discharged, a net flow from the bottom to the top mixes the storage and vice versa during charging events. Thereby, the top and bottom segments have the largest surface areas; therefore, the top segment can become colder than the second-to-the-top segment in such simulation models. This is not a physical phenomenon; thus simulation software typically sorts the segments after each time-discrete step or at least performs a mixing (Oliveski, Krenzinger, and Vielmo&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0010" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2003</a></span>).</p>
  <div class="tableViewerArticleInfo hidden">
   <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>05 November 2020
    </div>
   </div>
  </div>
  <div class="tableView">
   <div class="tableCaption">
    <div class="short-legend">
     <h3><b>Table 3. Thermal storage tank parameters.</b></h3>
    </div>
   </div>
   <div class="tableDownloadOption" data-hascsvlnk="false" id="T0003-table-wrapper">
    <a data-id="T0003" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
   </div>
  </div>
  <p></p>
  <p>However, simulation of the thermal storage tanks in such granularity is not necessarily useful nor practical in embedded systems. Herein we shall assume that temperature readings <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0064.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0064.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mn>
       1
      </mn>
     </msub>
    </math></span>, <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0065.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0065.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mn>
       2
      </mn>
     </msub>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0066.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0066.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mn>
       3
      </mn>
     </msub>
    </math></span> are available. These correspond to the temperature of the water at the bottom, middle and top of the tank, respectively. Given this information, one way to model the state <i>X</i> of a tank is by using two nodes: the section of the tank with water at a usable temperature and the section with low, unusable temperature. This ‘thermocline’ model is depicted in Equation&nbsp;(<a href="#M0007">7</a>). Another option is to model <i>X</i> as the total energy content of the tank as shown in Equation&nbsp;(<a href="#M0006">6</a>). Doing so may be a poor choice if the temperature difference between the bottom and top of the tank is no longer very large, but can be more accurate if the water temperature in the top of the tank greatly exceeds the fixed temperature assumed in the thermocline model. In other words, if the hot water tank is charged a lot in a short period of time, then Equation&nbsp;(<a href="#M0006">6</a>) will likely be more accurate while a long period without charging will result in the usable water being more accurately modelled by Equation&nbsp;(<a href="#M0007">7</a>). Of course, the nonlinear dynamics of the thermal storages may be explicitly modelled as in Equation (<a href="#M0008">8</a>), however, doing so may lead to longer runtimes. Section&nbsp;<a href="#S004">4</a> will present the results of each of these thermal storage models in combination with several other modelling options for the system.</p>
  <p>The dynamics of thermal storage dynamics involve a number of parameters, which are given in Table&nbsp;<button class="ref showTableEventRef" data-id="T0003">3</button>. Note that the subscripts <i>dhw</i> and <i>sh</i> are omitted in (<a href="#M0006">6</a>),&nbsp;(<a href="#M0007">7</a>) and&nbsp;(<a href="#M0008">8</a>) for brevity, as the same dynamics hold for each tank.</p>
  <p>1. Energy state dynamics <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0006.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0006.gif&quot;}"><span class="mml-formula"><span class="disp_formula_label_div"><span id="M0006" class="disp-formula-label">(6) </span></span></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi>
         ρ
        </mi>
        <mi>
         V
        </mi>
        <mi>
         c
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         X
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo>
         +
        </mo>
        <mn>
         1
        </mn>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <mi>
         X
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <msub>
         <mi mathvariant="normal">
          Δ
         </mi>
         <mi>
          t
         </mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="1em"></mspace>
        <mo>
         =
        </mo>
        <mo>
         −
        </mo>
        <mi>
         m
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <mi>
         c
        </mi>
        <mo>
         +
        </mo>
        <mstyle scriptlevel="0">
         <mrow>
          <mo maxsize="1.623em" minsize="1.623em">
           (
          </mo>
         </mrow>
        </mstyle>
        <msub>
         <mi>
          Q
         </mi>
         <mrow>
          <mi>
           e
          </mi>
          <mi>
           h
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         +
        </mo>
        <msub>
         <mi>
          Q
         </mi>
         <mrow>
          <mi>
           h
          </mi>
          <mi>
           p
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="2em"></mspace>
        <mo>
         −
        </mo>
        <mi>
         U
        </mi>
        <mi>
         A
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          1
         </mn>
        </msub>
        <mo>
         +
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          3
         </mn>
        </msub>
        <mo>
         −
        </mo>
        <mn>
         2
        </mn>
        <msub>
         <mi>
          T
         </mi>
         <mi>
          R
         </mi>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="2em"></mspace>
        <mo>
         −
        </mo>
        <mi>
         U
        </mi>
        <mi>
         π
        </mi>
        <mi>
         d
        </mi>
        <mi>
         h
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          2
         </mn>
        </msub>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mi>
          R
         </mi>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <mstyle scriptlevel="0">
         <mrow>
          <mo maxsize="1.623em" minsize="1.623em">
           )
          </mo>
         </mrow>
        </mstyle>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           t
          </mi>
          <mi>
           s
          </mi>
         </mrow>
        </msub>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          3
         </mn>
        </msub>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         .
        </mo>
       </mtd>
      </mtr>
     </mtable>
    </math><span class="mathjaxLabel"><span class="disp_formula_label_div"><span id="M0006" class="disp-formula-label">(6) </span></span></span></span> 2. Thermocline between usable and unusable water <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0007.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0007.gif&quot;}"><span class="mml-formula"><span class="disp_formula_label_div"><span id="M0007" class="disp-formula-label">(7) </span></span></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi>
         ρ
        </mi>
        <mi>
         V
        </mi>
        <mi>
         c
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         X
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo>
         +
        </mo>
        <mn>
         1
        </mn>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <mi>
         X
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <msub>
         <mi mathvariant="normal">
          Δ
         </mi>
         <mi>
          t
         </mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="1em"></mspace>
        <mo>
         =
        </mo>
        <mo>
         −
        </mo>
        <mi>
         m
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          1
         </mn>
        </msub>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mi>
          R
         </mi>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <mi>
         c
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           t
          </mi>
          <mi>
           s
          </mi>
         </mrow>
        </msub>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mi>
          R
         </mi>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="2em"></mspace>
        <mo>
         +
        </mo>
        <mstyle scriptlevel="0">
         <mrow>
          <mo maxsize="1.623em" minsize="1.623em">
           (
          </mo>
         </mrow>
        </mstyle>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          Q
         </mi>
         <mrow>
          <mi>
           e
          </mi>
          <mi>
           h
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         +
        </mo>
        <msub>
         <mi>
          Q
         </mi>
         <mrow>
          <mi>
           h
          </mi>
          <mi>
           p
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="2em"></mspace>
        <mo>
         −
        </mo>
        <mi>
         U
        </mi>
        <mi>
         A
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          1
         </mn>
        </msub>
        <mo>
         +
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          2
         </mn>
        </msub>
        <mo>
         −
        </mo>
        <mn>
         2
        </mn>
        <msub>
         <mi>
          T
         </mi>
         <mi>
          R
         </mi>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="2em"></mspace>
        <mo>
         −
        </mo>
        <mi>
         U
        </mi>
        <mi>
         π
        </mi>
        <mi>
         d
        </mi>
        <mi>
         h
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          1
         </mn>
        </msub>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mi>
          R
         </mi>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <mstyle scriptlevel="0">
         <mrow>
          <mo maxsize="1.623em" minsize="1.623em">
           )
          </mo>
         </mrow>
        </mstyle>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           t
          </mi>
          <mi>
           s
          </mi>
         </mrow>
        </msub>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mi>
          R
         </mi>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         .
        </mo>
       </mtd>
      </mtr>
     </mtable>
    </math><span class="mathjaxLabel"><span class="disp_formula_label_div"><span id="M0007" class="disp-formula-label">(7) </span></span></span></span> 3. Nonlinear thermocline model. Includes the same state dynamics as in Equation&nbsp;(<a href="#M0007">7</a>), except that <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0067.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0067.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mn>
       1
      </mn>
     </msub><mo>
      ,
     </mo><msub>
      <mi>
       T
      </mi>
      <mn>
       2
      </mn>
     </msub><mo>
      ,
     </mo>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0068.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0068.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mn>
       3
      </mn>
     </msub>
    </math></span> are non-constant and have the following dynamics <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0069.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0069.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mi mathvariant="normal">
      ∀
     </mi><mi>
      t
     </mi><mo>
      &gt;
     </mo><mn>
      0
     </mn><mo>
      :
     </mo>
    </math></span> <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_um0001.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_um0001.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi>
         ρ
        </mi>
        <mi>
         V
        </mi>
        <mi>
         c
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          1
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo>
         +
        </mo>
        <mn>
         1
        </mn>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          1
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <msub>
         <mi mathvariant="normal">
          Δ
         </mi>
         <mi>
          t
         </mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="1em"></mspace>
        <mo>
         =
        </mo>
        <mi>
         m
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <mi>
         c
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          2
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          1
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="2em"></mspace>
        <mo>
         +
        </mo>
        <msub>
         <mi>
          Q
         </mi>
         <mrow>
          <mi>
           h
          </mi>
          <mi>
           p
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           t
          </mi>
          <mi>
           s
          </mi>
         </mrow>
        </msub>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          1
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           t
          </mi>
          <mi>
           s
          </mi>
         </mrow>
        </msub>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          3
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="2em"></mspace>
        <mo>
         −
        </mo>
        <mi>
         U
        </mi>
        <mi>
         π
        </mi>
        <mi>
         d
        </mi>
        <mi>
         h
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          1
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mi>
          R
         </mi>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="2em"></mspace>
        <mo>
         +
        </mo>
        <mi>
         k
        </mi>
        <mi>
         A
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          2
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          1
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <mn>
         0.2
        </mn>
        <mspace width="thinmathspace"></mspace>
        <mrow>
         <mi mathvariant="normal">
          h
         </mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
    </math></span> <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0008.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0008.gif&quot;}"><span class="mml-formula"><span class="disp_formula_label_div"><span id="M0008" class="disp-formula-label">(8) </span></span></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi>
         ρ
        </mi>
        <mi>
         V
        </mi>
        <mi>
         c
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          2
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo>
         +
        </mo>
        <mn>
         1
        </mn>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          2
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <msub>
         <mi mathvariant="normal">
          Δ
         </mi>
         <mi>
          t
         </mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="1em"></mspace>
        <mo>
         =
        </mo>
        <mi>
         m
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <mi>
         c
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          3
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          2
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="2em"></mspace>
        <mo>
         +
        </mo>
        <msub>
         <mi>
          Q
         </mi>
         <mrow>
          <mi>
           h
          </mi>
          <mi>
           p
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          1
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          2
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           t
          </mi>
          <mi>
           s
          </mi>
         </mrow>
        </msub>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          3
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="2em"></mspace>
        <mo>
         −
        </mo>
        <mi>
         U
        </mi>
        <mi>
         π
        </mi>
        <mi>
         d
        </mi>
        <mi>
         h
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          2
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mi>
          R
         </mi>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="2em"></mspace>
        <mo>
         +
        </mo>
        <mi>
         k
        </mi>
        <mi>
         A
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          3
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         +
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          1
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <mn>
         2
        </mn>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          2
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <mn>
         0.2
        </mn>
        <mspace width="thinmathspace"></mspace>
        <mrow>
         <mi mathvariant="normal">
          h
         </mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
    </math><span class="mathjaxLabel"><span class="disp_formula_label_div"><span id="M0008" class="disp-formula-label">(8) </span></span></span></span> <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_um0002.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_um0002.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi>
         ρ
        </mi>
        <mi>
         V
        </mi>
        <mi>
         c
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          3
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo>
         +
        </mo>
        <mn>
         1
        </mn>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          3
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <msub>
         <mi mathvariant="normal">
          Δ
         </mi>
         <mi>
          t
         </mi>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="1em"></mspace>
        <mo>
         =
        </mo>
        <mi>
         m
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <mi>
         c
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mi>
          R
         </mi>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          3
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="2em"></mspace>
        <mo>
         +
        </mo>
        <msub>
         <mi>
          Q
         </mi>
         <mrow>
          <mi>
           h
          </mi>
          <mi>
           p
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          2
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          3
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mrow>
          <mi>
           t
          </mi>
          <mi>
           s
          </mi>
         </mrow>
        </msub>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          3
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="2em"></mspace>
        <mo>
         −
        </mo>
        <mi>
         U
        </mi>
        <mi>
         π
        </mi>
        <mi>
         d
        </mi>
        <mi>
         h
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          3
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mi>
          R
         </mi>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="2em"></mspace>
        <mo>
         +
        </mo>
        <mi>
         k
        </mi>
        <mi>
         A
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          2
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          3
         </mn>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <mrow>
         <mo>
          /
         </mo>
        </mrow>
        <mn>
         0.2
        </mn>
        <mspace width="thinmathspace"></mspace>
        <mrow>
         <mi mathvariant="normal">
          h
         </mi>
        </mrow>
       </mtd>
      </mtr>
     </mtable>
    </math></span> and where <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0070.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0070.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mn>
       1
      </mn>
     </msub><mo stretchy="false">
      (
     </mo><mn>
      0
     </mn><mo stretchy="false">
      )
     </mo><mo>
      ,
     </mo><msub>
      <mi>
       T
      </mi>
      <mn>
       2
      </mn>
     </msub><mo stretchy="false">
      (
     </mo><mn>
      0
     </mn><mo stretchy="false">
      )
     </mo>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0071.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0071.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mn>
       3
      </mn>
     </msub><mo stretchy="false">
      (
     </mo><mn>
      0
     </mn><mo stretchy="false">
      )
     </mo>
    </math></span> are the thermal storage temperature readings.</p>
  <p>In all three models, the main idea is to equate the change in usable water with the heat added by the heat pump (<span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0072.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0072.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       Q
      </mi>
      <mrow>
       <mi>
        h
       </mi>
       <mi>
        p
       </mi>
      </mrow>
     </msub>
    </math></span>) and electric heater (<span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0073.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0073.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       Q
      </mi>
      <mrow>
       <mi>
        e
       </mi>
       <mi>
        h
       </mi>
      </mrow>
     </msub>
    </math></span>), minus the hot water demand (<i>m</i>), and heat lost to the environment. Note that the notation <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0074.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0074.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        t
       </mi>
       <mi>
        s
       </mi>
      </mrow>
     </msub>
    </math></span> is used refer to the temperature set-point of the thermal storage tank in question. These values are given as <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0075.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0075.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        d
       </mi>
       <mi>
        h
       </mi>
       <mi>
        w
       </mi>
      </mrow>
     </msub>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0076.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0076.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       T
      </mi>
      <mrow>
       <mi>
        s
       </mi>
       <mi>
        h
       </mi>
      </mrow>
     </msub>
    </math></span> in Table&nbsp;<button class="ref showTableEventRef" data-id="T0003">3</button> for the domestic hot water and space heating tanks, respectively. It should also be noted that for Equations&nbsp;(<a href="#M0006">6</a>) and&nbsp;(<a href="#M0007">7</a>) the thermoclines <i>X</i> are further constrained by <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_um0003.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_um0003.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mn>
      0
     </mn><mo>
      ≤
     </mo><mi>
      X
     </mi><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo><mo>
      ≤
     </mo><mn>
      1
     </mn><mo>
      ,
     </mo>
    </math></span> where <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0077.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0077.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mi>
      X
     </mi><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo><mo>
      =
     </mo><mn>
      1
     </mn>
    </math></span> corresponds to a completely ‘charged’ hot water tank, while <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0078.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0078.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mi>
      X
     </mi><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo><mo>
      =
     </mo><mn>
      0
     </mn>
    </math></span> would correspond to a tank without any usable hot water.</p>
  <p>Figure&nbsp;<a href="#F0004">4</a> provides an illustrative example of the behaviour of the state <i>X</i> in the dynamics given by&nbsp;(<a href="#M0006">6</a>),&nbsp;(<a href="#M0007">7</a>) and&nbsp;(<a href="#M0008">8</a>). Here, the hot water demands and ambient temperature are as given in Table&nbsp;<button class="ref showTableEventRef" data-id="T0003">3</button>, however, no control actions are undertaken. The shaded cells use values taken from a detailed simulation of both tanks. Both the linear and nonlinear models seem to underestimate the heat losses for the thermal storages. Interestingly, the linear model (Equation&nbsp;(<a href="#M0006">6</a>)), seems to be the best predictor despite only relying on relatively simple dynamics.</p>
  <div class="figure figureViewer" id="F0004">
   <div class="hidden figureViewerArticleInfo">
    <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
    <div class="articleAuthors articleInfoSection">
     <div class="authorsHeading">
      All authors
     </div>
     <div class="authors">
      <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
     </div>
    </div>
    <div class="articleLowerInfo articleInfoSection">
     <div class="articleLowerInfoSection articleInfoDOI">
      <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
     </div>
     <div class="articleInfoPublicationDate articleLowerInfoSection border">
      <h6>Published online:</h6>05 November 2020
     </div>
    </div>
   </div>
   <div class="figureThumbnailContainer">
    <div class="figureInfo">
     <div class="short-legend">
      <p class="captionText"><span class="captionLabel">Figure 4. </span> The solid green line is the prediction of Model&nbsp;1 (Equation&nbsp;(<a href="#M0006">6</a>)). The dashed purple line depicts the prediction of Model&nbsp;2 (Equation&nbsp;<a href="#M0007">7</a>), and the dotted black line depicts what is predicted by the model defined by Model&nbsp;3 (Equations&nbsp;(<a href="#M0007">7</a>) and&nbsp;(<a href="#M0008">8</a>)). The plot depicts 1−<i>X</i> for each model in order to better demonstrate alignment with the thermocline.</p>
     </div>
    </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0004image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/medium/tbps_a_1838611_f0004_oc.jpg" loading="lazy" height="500" width="500"></a>
    <div class="figureDownloadOptions">
     <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
    </div>
   </div>
  </div>
  <div class="hidden rs_skip" id="fig-description-F0004">
   <p class="captionText"><span class="captionLabel">Figure 4. </span> The solid green line is the prediction of Model&nbsp;1 (Equation&nbsp;(<a href="#M0006">6</a>)). The dashed purple line depicts the prediction of Model&nbsp;2 (Equation&nbsp;<a href="#M0007">7</a>), and the dotted black line depicts what is predicted by the model defined by Model&nbsp;3 (Equations&nbsp;(<a href="#M0007">7</a>) and&nbsp;(<a href="#M0008">8</a>)). The plot depicts 1−<i>X</i> for each model in order to better demonstrate alignment with the thermocline.</p>
  </div>
  <div class="hidden rs_skip" id="figureFootNote-F0004">
   <div class="figureFootNote-F0004"></div>
  </div>
  <p></p>
 </div>
 <div id="S002-S2004" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i29">2.4. Models of battery</h3>
  <p>If the cost of electricity varies with time or local renewable generation exceeds local demand, then batteries can help to reduce long-term costs by storing excess energy. We assume that the battery has no self-discharge. It is further assumed that there are constant charging and discharging efficiencies, although this may not hold for some batteries when applied power is low (Belvedere et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0027" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2012</a></span>). Equation&nbsp;(<a href="#M0009">9</a>) models the dynamics of the state of charge of the battery, <i>E</i>, given these assumptions. <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0009.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0009.gif&quot;}"><span class="mml-formula"><span class="disp_formula_label_div"><span id="M0009" class="disp-formula-label">(9) </span></span></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
      <mtr>
       <mtd>
        <mi>
         E
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo>
         +
        </mo>
        <mn>
         1
        </mn>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         =
        </mo>
        <mi>
         E
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         +
        </mo>
        <mrow>
         <mo>
          (
         </mo>
         <mo stretchy="false">
          (
         </mo>
         <mn>
          1
         </mn>
         <mo>
          −
         </mo>
         <mi>
          η
         </mi>
         <mo stretchy="false">
          )
         </mo>
         <msubsup>
          <mi>
           P
          </mi>
          <mrow>
           <mi mathvariant="normal">
            bat
           </mi>
          </mrow>
          <mo>
           +
          </mo>
         </msubsup>
         <mo stretchy="false">
          (
         </mo>
         <mi>
          t
         </mi>
         <mo stretchy="false">
          )
         </mo>
         <mo>
          +
         </mo>
         <mo stretchy="false">
          (
         </mo>
         <mn>
          1
         </mn>
         <mo>
          +
         </mo>
         <mi>
          η
         </mi>
         <mo stretchy="false">
          )
         </mo>
         <msubsup>
          <mi>
           P
          </mi>
          <mrow>
           <mi mathvariant="normal">
            bat
           </mi>
          </mrow>
          <mo>
           −
          </mo>
         </msubsup>
         <mo stretchy="false">
          (
         </mo>
         <mi>
          t
         </mi>
         <mo stretchy="false">
          )
         </mo>
         <mo>
          )
         </mo>
        </mrow>
        <msub>
         <mi mathvariant="normal">
          Δ
         </mi>
         <mi>
          t
         </mi>
        </msub>
       </mtd>
      </mtr>
     </mtable>
    </math><span class="mathjaxLabel"><span class="disp_formula_label_div"><span id="M0009" class="disp-formula-label">(9) </span></span></span></span> where <i>η</i> denotes the charging efficiency of the battery, <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0079.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0079.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msubsup>
      <mi>
       P
      </mi>
      <mrow>
       <mi>
        b
       </mi>
       <mi>
        a
       </mi>
       <mi>
        t
       </mi>
      </mrow>
      <mo>
       +
      </mo>
     </msubsup><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo>
    </math></span> is the power injection to the battery at time <i>t</i> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0080.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0080.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msubsup>
      <mi>
       P
      </mi>
      <mrow>
       <mi>
        b
       </mi>
       <mi>
        a
       </mi>
       <mi>
        t
       </mi>
      </mrow>
      <mo>
       −
      </mo>
     </msubsup><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo>
    </math></span> is the power withdrawn from the battery at time <i>t</i>. In analogy to Section&nbsp;<a href="#S002-S2001">2.1</a>, we also introduce the following complementarity constraints on <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0081.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0081.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msubsup>
      <mi>
       P
      </mi>
      <mrow>
       <mi>
        b
       </mi>
       <mi>
        a
       </mi>
       <mi>
        t
       </mi>
      </mrow>
      <mo>
       +
      </mo>
     </msubsup><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0082.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0082.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msubsup>
      <mi>
       P
      </mi>
      <mrow>
       <mi>
        b
       </mi>
       <mi>
        a
       </mi>
       <mi>
        t
       </mi>
      </mrow>
      <mo>
       −
      </mo>
     </msubsup><mo stretchy="false">
      (
     </mo><mi>
      t
     </mi><mo stretchy="false">
      )
     </mo>
    </math></span>: <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_um0004.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_um0004.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
      <mtr>
       <mtd>
        <mrow>
         <mi mathvariant="normal">
          For
         </mi>
         <mspace width="thinmathspace"></mspace>
         <mi mathvariant="normal">
          all
         </mi>
        </mrow>
        <mspace width="thinmathspace"></mspace>
        <mi>
         t
        </mi>
       </mtd>
       <mtd>
        <mi></mi>
        <mo>
         ∈
        </mo>
        <mo fence="false" stretchy="false">
         {
        </mo>
        <mn>
         1
        </mn>
        <mo>
         ,
        </mo>
        <mo>
         …
        </mo>
        <mo>
         ,
        </mo>
        <mi>
         H
        </mi>
        <mo fence="false" stretchy="false">
         }
        </mo>
        <mo>
         :
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <munder>
         <mi>
          E
         </mi>
         <mo>
          _
         </mo>
        </munder>
       </mtd>
       <mtd>
        <mi></mi>
        <mo>
         ≤
        </mo>
        <mi>
         E
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         ≤
        </mo>
        <mover>
         <mi>
          E
         </mi>
         <mo accent="false">
          ¯
         </mo>
        </mover>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mn>
         0
        </mn>
       </mtd>
       <mtd>
        <mi></mi>
        <mo>
         ≤
        </mo>
        <msubsup>
         <mi>
          P
         </mi>
         <mrow>
          <mi mathvariant="normal">
           bat
          </mi>
         </mrow>
         <mo>
          +
         </mo>
        </msubsup>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         ≤
        </mo>
        <mo stretchy="false">
         (
        </mo>
        <mn>
         1
        </mn>
        <mo>
         −
        </mo>
        <msub>
         <mi>
          z
         </mi>
         <mrow>
          <mi mathvariant="normal">
           bat
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
        <msub>
         <mover>
          <mi>
           P
          </mi>
          <mo accent="false">
           ¯
          </mo>
         </mover>
         <mrow>
          <mi>
           b
          </mi>
          <mi>
           a
          </mi>
          <mi>
           t
          </mi>
         </mrow>
        </msub>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <msub>
         <mi>
          z
         </mi>
         <mrow>
          <mi mathvariant="normal">
           bat
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <msub>
         <munder>
          <mi>
           P
          </mi>
          <mo>
           _
          </mo>
         </munder>
         <mrow>
          <mi mathvariant="normal">
           bat
          </mi>
         </mrow>
        </msub>
       </mtd>
       <mtd>
        <mi></mi>
        <mo>
         ≤
        </mo>
        <msubsup>
         <mi>
          P
         </mi>
         <mrow>
          <mi mathvariant="normal">
           bat
          </mi>
         </mrow>
         <mo>
          −
         </mo>
        </msubsup>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         ≤
        </mo>
        <mn>
         0
        </mn>
       </mtd>
      </mtr>
      <mtr>
       <mtd>
        <mrow>
         <mi mathvariant="normal">
          where
         </mi>
        </mrow>
        <mspace width="thinmathspace"></mspace>
        <msub>
         <mi>
          z
         </mi>
         <mrow>
          <mi mathvariant="normal">
           bat
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
       <mtd>
        <mi></mi>
        <mo>
         ∈
        </mo>
        <mo fence="false" stretchy="false">
         {
        </mo>
        <mn>
         0
        </mn>
        <mo>
         ,
        </mo>
        <mn>
         1
        </mn>
        <mo fence="false" stretchy="false">
         }
        </mo>
       </mtd>
      </mtr>
     </mtable>
    </math></span> Additionally, the objective function may include a term that penalizes the emptiness of the battery at the end of the time horizon: <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0010.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0010.gif&quot;}"><span class="mml-formula"><span class="disp_formula_label_div"><span id="M0010" class="disp-formula-label">(10) </span></span></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
      <mtr>
       <mtd>
        <munder>
         <mo movablelimits="true" form="prefix">
          min
         </mo>
         <mrow>
          <msubsup>
           <mi>
            P
           </mi>
           <mrow>
            <mi mathvariant="normal">
             bat
            </mi>
           </mrow>
           <mo>
            +
           </mo>
          </msubsup>
          <mo>
           ,
          </mo>
          <msubsup>
           <mi>
            P
           </mi>
           <mrow>
            <mi mathvariant="normal">
             bat
            </mi>
           </mrow>
           <mo>
            −
           </mo>
          </msubsup>
         </mrow>
        </munder>
        <mspace width="thinmathspace"></mspace>
        <mi>
         γ
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mover>
         <mi>
          E
         </mi>
         <mo accent="false">
          ¯
         </mo>
        </mover>
        <mo>
         −
        </mo>
        <mi>
         E
        </mi>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         H
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
     </mtable>
    </math><span class="mathjaxLabel"><span class="disp_formula_label_div"><span id="M0010" class="disp-formula-label">(10) </span></span></span></span> for some penalty parameter <i>γ</i>. Augmenting the objective function by&nbsp;(<a href="#M0010">10</a>) can improve operation costs if unexpectedly high electricity demands occur, where a grid connection would otherwise have to be utilized.</p>
 </div>
 <div id="S002-S2005" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i33">2.5. Model of electricity balance</h3>
  <p>A balance between the power from each source and the power used by each device is necessary to obtain physically relevant solutions. This constraint is modelled as shown in Equation&nbsp;(<a href="#M0011">11</a>). It is assumed that the load forecasts are deterministic<span class="ref-lnk fn-ref-lnk lazy-ref"><a data-rid="EN0002" href="#" data-reflink="fn"><span class="off-screen">Footnote</span><sup>2</sup></a></span> <span class="NLM_disp-formula-image disp-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0011.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0011.gif&quot;}"><span class="mml-formula"><span class="disp_formula_label_div"><span id="M0011" class="disp-formula-label">(11) </span></span></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
      <mtr>
       <mtd></mtd>
       <mtd>
        <msub>
         <mi>
          P
         </mi>
         <mi>
          L
         </mi>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         +
        </mo>
        <msub>
         <mi>
          P
         </mi>
         <mrow>
          <mi mathvariant="normal">
           hp
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         +
        </mo>
        <msubsup>
         <mi>
          P
         </mi>
         <mi>
          G
         </mi>
         <mo>
          +
         </mo>
        </msubsup>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         +
        </mo>
        <msubsup>
         <mi>
          P
         </mi>
         <mrow>
          <mi mathvariant="normal">
           bat
          </mi>
         </mrow>
         <mo>
          +
         </mo>
        </msubsup>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         +
        </mo>
        <msub>
         <mi>
          P
         </mi>
         <mrow>
          <mi>
           e
          </mi>
          <mi>
           h
          </mi>
          <mo stretchy="false">
           →
          </mo>
          <mi>
           d
          </mi>
          <mi>
           h
          </mi>
          <mi>
           w
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
      <mtr>
       <mtd></mtd>
       <mtd>
        <mi></mi>
        <mspace width="1em"></mspace>
        <mo>
         +
        </mo>
        <msub>
         <mi>
          P
         </mi>
         <mrow>
          <mi>
           e
          </mi>
          <mi>
           h
          </mi>
          <mo stretchy="false">
           →
          </mo>
          <mi>
           s
          </mi>
          <mi>
           h
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         =
        </mo>
        <msub>
         <mi>
          P
         </mi>
         <mrow>
          <mi mathvariant="normal">
           pv
          </mi>
         </mrow>
        </msub>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         +
        </mo>
        <msubsup>
         <mi>
          P
         </mi>
         <mi>
          G
         </mi>
         <mo>
          −
         </mo>
        </msubsup>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
        <mo>
         +
        </mo>
        <msubsup>
         <mi>
          P
         </mi>
         <mrow>
          <mi mathvariant="normal">
           bat
          </mi>
         </mrow>
         <mo>
          −
         </mo>
        </msubsup>
        <mo stretchy="false">
         (
        </mo>
        <mi>
         t
        </mi>
        <mo stretchy="false">
         )
        </mo>
       </mtd>
      </mtr>
     </mtable>
    </math><span class="mathjaxLabel"><span class="disp_formula_label_div"><span id="M0011" class="disp-formula-label">(11) </span></span></span></span> where <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0083.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0083.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       P
      </mi>
      <mrow>
       <mi>
        e
       </mi>
       <mi>
        h
       </mi>
       <mo stretchy="false">
        →
       </mo>
       <mi>
        d
       </mi>
       <mi>
        h
       </mi>
       <mi>
        w
       </mi>
      </mrow>
     </msub>
    </math></span> is the power used by the electric heater at time <i>t</i> to heat the domestic hot water tank and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0084.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0084.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       P
      </mi>
      <mrow>
       <mi>
        e
       </mi>
       <mi>
        h
       </mi>
       <mo stretchy="false">
        →
       </mo>
       <mi>
        s
       </mi>
       <mi>
        h
       </mi>
      </mrow>
     </msub>
    </math></span> is the power used by the electric heater at time <i>t</i> to heat the space heating tank. The parameters <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0085.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0085.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       P
      </mi>
      <mi>
       L
      </mi>
     </msub>
    </math></span> and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0086.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0086.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       P
      </mi>
      <mrow>
       <mi>
        p
       </mi>
       <mi>
        v
       </mi>
      </mrow>
     </msub>
    </math></span> are the local demand and generation of electricity (cf. Table&nbsp;<button class="ref showTableEventRef" data-id="T0004">4</button>).</p>
  <div class="tableViewerArticleInfo hidden">
   <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>05 November 2020
    </div>
   </div>
  </div>
  <div class="tableView">
   <div class="tableCaption">
    <div class="short-legend">
     <h3><b>Table 4. Load and demand.</b></h3>
    </div>
   </div>
   <div class="tableDownloadOption" data-hascsvlnk="false" id="T0004-table-wrapper">
    <a data-id="T0004" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
   </div>
  </div>
  <p></p>
 </div>
</div>
<div id="S003" class="NLM_sec NLM_sec_level_1">
 <h2 id="_i36" class="section-heading-2">3. Simulation results</h2>
 <p>The values listed in the tables of Section&nbsp;<a href="#S002">2</a> are those that were used for the simulation. Recall that <i>γ</i> is the penalization factor for the emptiness of the battery at the final time step and recall the definitions of the following equations:</p>
 <ul class="NLM_list NLM_list-list_type-bullet">
  <li><p class="inline">Equation&nbsp;(<a href="#M0002">2</a>): Mixed-integer linear grid connection complementary constraints.</p></li>
  <li><p class="inline">Equation&nbsp;(<a href="#M0003">3</a>): Continuous, non-convex grid connection complementary constraints.</p></li>
  <li><p class="inline">Equation&nbsp;(<a href="#M0004">4</a>): Mixed-integer linear heat pump dynamics.</p></li>
  <li><p class="inline">Equation&nbsp;(<a href="#M0005">5</a>): Linear heat pump dynamics (continuous relaxation of Equation&nbsp;(<a href="#M0004">4</a>)).</p></li>
  <li><p class="inline">Equation&nbsp;(<a href="#M0006">6</a>): Linear thermal storage dynamics.</p></li>
  <li><p class="inline">Equation&nbsp;(<a href="#M0007">7</a>): Alternative linear thermal storage dynamics.</p></li>
  <li><p class="inline">Equation&nbsp;(<a href="#M0008">8</a>): Nonlinear thermal storage dynamics.</p></li>
 </ul>
 <div class="figure figureViewer" id="F0005">
  <div class="hidden figureViewerArticleInfo">
   <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>05 November 2020
    </div>
   </div>
  </div>
  <div class="figureThumbnailContainer">
   <div class="figureInfo">
    <div class="short-legend">
     <p class="captionText"><span class="captionLabel">Figure 5. </span> The solid yellow line denotes the photovoltaic power generation and is taken from Dubey, Sarvaiya, and Seshadri&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0028" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2013</a></span>). The dotted green line denotes household electricity demand data and is taken from Richardson et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0029" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2010</a></span>).</p>
    </div>
   </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0005image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/medium/tbps_a_1838611_f0005_oc.jpg" loading="lazy" height="201" width="500"></a>
   <div class="figureDownloadOptions">
    <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
   </div>
  </div>
 </div>
 <div class="hidden rs_skip" id="fig-description-F0005">
  <p class="captionText"><span class="captionLabel">Figure 5. </span> The solid yellow line denotes the photovoltaic power generation and is taken from Dubey, Sarvaiya, and Seshadri&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0028" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2013</a></span>). The dotted green line denotes household electricity demand data and is taken from Richardson et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0029" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2010</a></span>).</p>
 </div>
 <div class="hidden rs_skip" id="figureFootNote-F0005">
  <div class="figureFootNote-F0005"></div>
 </div>
 <p></p>
 <p>The space heating demand data is calculated for a typical one-family dwelling with 2 storeys, 150 m<span class="NLM_disp-formula-image inline-formula rs_preserve">
   <noscript>
    <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0089.gif" alt="">
   </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0089.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
   <math>
    <msup>
     <mi></mi>
     <mn>
      2
     </mn>
    </msup>
   </math></span> living area and a saddle roof. The building is located in Aachen, Germany, and has a building construction that complies with the German energy savings ordinance from 1984 (Constantin, Streblow, and Müller&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0030" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2014</a></span>). Specifically, the model considers thermal mass by modelling each of the nine rooms of the two-storey building separately. Thereby, each wall, ceiling and ground floor are composed of multiple layers that each have a different thermal capacitance and resistance. The thermal capacitances of windows and doors are not considered in this model, however, the capacitance of these elements is negligible compared to the other building elements. Furthermore, the model accounts for a quite detailed set point management including night setback. During operation, the set point temperature is guaranteed by a standard P-controller .<span class="ref-lnk fn-ref-lnk lazy-ref"><a data-rid="EN0003" href="#" data-reflink="fn"><span class="off-screen">Footnote</span><sup>3</sup></a></span></p>
 <p>The electrical consumption profile for a 4-person household (where hot water is not generated electrically) living in a one-family dwelling is based on Richardson et al.&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0029" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2010</a></span>), but with total consumption of 4000 kWh/a, which represents a typical consumption for such a household in 2017.<span class="ref-lnk fn-ref-lnk lazy-ref"><a data-rid="EN0004" href="#" data-reflink="fn"><span class="off-screen">Footnote</span><sup>4</sup></a></span> The domestic hot water consumption is based on the occupancy profile used for determining the electrical demand (Richardson et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0029" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2010</a></span>). Likewise, the hourly space heating profiles are computed with the freely available building simulation library Aixlib (Müller et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0031" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2016</a></span>). PV output is determined for 21 modules, which corresponds to 7.6 kW peak PV output. The implemented PV model is based on Dubey, Sarvaiya, and Seshadri&nbsp;(<span class="ref-lnk lazy-ref"><a data-rid="CIT0028" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2013</a></span>). Weather data is obtained from the German Weather Service at 10-minute resolution for Aachen (Deutscher Wetterdienst&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0024" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2017</a></span>). It is assumed that the PV modules are facing south and have a pitch angle of 30<span class="NLM_disp-formula-image inline-formula rs_preserve">
   <noscript>
    <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0090.gif" alt="">
   </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0090.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
   <math>
    <msup>
     <mi></mi>
     <mrow>
      <mo>
       ∘
      </mo>
     </mrow>
    </msup>
   </math></span>.</p>
 <p>The results using the aforementioned parameters are shown in Tables&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button>,&nbsp;<button class="ref showTableEventRef" data-id="T0006">6</button>, and&nbsp;<button class="ref showTableEventRef" data-id="T0007">7</button>, where the final cost and error are computed using a detailed simulation of the system using the Aixlib library. Table&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button> shows the results for all mixed integer linear programming (MILP) models, Table&nbsp;<button class="ref showTableEventRef" data-id="T0006">6</button> shows the results for all mixed integer nonlinear programming (MINLP) models, and Table&nbsp;<button class="ref showTableEventRef" data-id="T0007">7</button> shows the results for all nonlinear programming (NLP) models. Each of these problems are non-convex and generally classified as NP-complete. The difference lies in the solvers which are available for each, and the curvature of each problem. The NLPs are solved with IPOPT (Wächter and Biegler&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0032" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2005</a></span>), and the mixed-integer problems are solved with Bonmin (Bonami et al.&nbsp;<span class="ref-lnk lazy-ref"><a data-rid="CIT0033" data-reflink="_i54 _i55" href="#"><span class="off-screen">Citation</span>2008</a></span>), which itself uses IPOPT to solve its continuous subproblems.</p>
 <div class="tableViewerArticleInfo hidden">
  <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
  <div class="articleAuthors articleInfoSection">
   <div class="authorsHeading">
    All authors
   </div>
   <div class="authors">
    <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
   </div>
  </div>
  <div class="articleLowerInfo articleInfoSection">
   <div class="articleLowerInfoSection articleInfoDOI">
    <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
   </div>
   <div class="articleInfoPublicationDate articleLowerInfoSection border">
    <h6>Published online:</h6>05 November 2020
   </div>
  </div>
 </div>
 <div class="tableView">
  <div class="tableCaption">
   <div class="short-legend">
    <h3><b>Table 5. Model comparison part 1: MILP models.</b></h3>
   </div>
  </div>
  <div class="tableDownloadOption" data-hascsvlnk="true" id="T0005-table-wrapper">
   <a class="downloadButton btn btn-sm" role="button" href="/action/downloadTable?id=T0005&amp;doi=10.1080%2F19401493.2020.1838611&amp;downloadType=CSV"> Download CSV</a><a data-id="T0005" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
  </div>
 </div>
 <div class="tableViewerArticleInfo hidden">
  <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
  <div class="articleAuthors articleInfoSection">
   <div class="authorsHeading">
    All authors
   </div>
   <div class="authors">
    <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
   </div>
  </div>
  <div class="articleLowerInfo articleInfoSection">
   <div class="articleLowerInfoSection articleInfoDOI">
    <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
   </div>
   <div class="articleInfoPublicationDate articleLowerInfoSection border">
    <h6>Published online:</h6>05 November 2020
   </div>
  </div>
 </div>
 <div class="tableView">
  <div class="tableCaption">
   <div class="short-legend">
    <h3><b>Table 6. Model comparison part 2: NLP models.</b></h3>
   </div>
  </div>
  <div class="tableDownloadOption" data-hascsvlnk="true" id="T0006-table-wrapper">
   <a class="downloadButton btn btn-sm" role="button" href="/action/downloadTable?id=T0006&amp;doi=10.1080%2F19401493.2020.1838611&amp;downloadType=CSV"> Download CSV</a><a data-id="T0006" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
  </div>
 </div>
 <div class="tableViewerArticleInfo hidden">
  <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
  <div class="articleAuthors articleInfoSection">
   <div class="authorsHeading">
    All authors
   </div>
   <div class="authors">
    <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
   </div>
  </div>
  <div class="articleLowerInfo articleInfoSection">
   <div class="articleLowerInfoSection articleInfoDOI">
    <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
   </div>
   <div class="articleInfoPublicationDate articleLowerInfoSection border">
    <h6>Published online:</h6>05 November 2020
   </div>
  </div>
 </div>
 <div class="tableView">
  <div class="tableCaption">
   <div class="short-legend">
    <h3><b>Table 7. Model comparison part 3: MINLP models.</b></h3>
   </div>
  </div>
  <div class="tableDownloadOption" data-hascsvlnk="false" id="T0007-table-wrapper">
   <a data-id="T0007" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
  </div>
 </div>
 <p></p>
 <p>The final cost for each model is based on the actual power usage as calculated in the Aixlib simulation model. The DHW and SH errors are taken as a sum of squares of the difference between the energy states of the thermal storage model and the simulation model over the entire time horizon <i>H</i>. <span class="NLM_disp-formula-image disp-formula rs_preserve">
   <noscript>
    <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0012.gif" alt="">
   </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_m0012.gif&quot;}"><span class="mml-formula"><span class="disp_formula_label_div"><span id="M0012" class="disp-formula-label">(12) </span></span></span></span><span class="NLM_disp-formula disp-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
   <math>
    <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
     <mtr>
      <mtd>
       <mi>
        E
       </mi>
       <mi>
        r
       </mi>
       <mi>
        r
       </mi>
       <mi>
        o
       </mi>
       <mi>
        r
       </mi>
       <mo>
        =
       </mo>
       <munderover>
        <mo>
         ∑
        </mo>
        <mrow>
         <mi>
          t
         </mi>
         <mo>
          =
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <mrow>
         <mi>
          H
         </mi>
        </mrow>
       </munderover>
       <msup>
        <mrow>
         <mo>
          (
         </mo>
         <mi>
          X
         </mi>
         <mo stretchy="false">
          (
         </mo>
         <mi>
          t
         </mi>
         <mo stretchy="false">
          )
         </mo>
         <mo>
          −
         </mo>
         <msub>
          <mi>
           X
          </mi>
          <mrow>
           <mi>
            s
           </mi>
           <mi>
            i
           </mi>
           <mi>
            m
           </mi>
          </mrow>
         </msub>
         <mo stretchy="false">
          (
         </mo>
         <mi>
          t
         </mi>
         <mo stretchy="false">
          )
         </mo>
         <mo>
          )
         </mo>
        </mrow>
        <mn>
         2
        </mn>
       </msup>
      </mtd>
     </mtr>
    </mtable>
   </math><span class="mathjaxLabel"><span class="disp_formula_label_div"><span id="M0012" class="disp-formula-label">(12) </span></span></span></span> where <span class="NLM_disp-formula-image inline-formula rs_preserve">
   <noscript>
    <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0092.gif" alt="">
   </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0092.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
   <math>
    <mi>
     X
    </mi><mo stretchy="false">
     (
    </mo><mi>
     t
    </mi><mo stretchy="false">
     )
    </mo>
   </math></span> is what is predicted for the next time step based on the relevant thermal storage model from Section&nbsp;<a href="#S002">2</a>, and <span class="NLM_disp-formula-image inline-formula rs_preserve">
   <noscript>
    <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0093.gif" alt="">
   </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0093.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
   <math>
    <msub>
     <mi>
      X
     </mi>
     <mrow>
      <mi>
       s
      </mi>
      <mi>
       i
      </mi>
      <mi>
       m
      </mi>
     </mrow>
    </msub><mo stretchy="false">
     (
    </mo><mi>
     t
    </mi><mo stretchy="false">
     )
    </mo>
   </math></span> is what actually occurred. This is computed via <span class="NLM_disp-formula-image inline-formula rs_preserve">
   <noscript>
    <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0094.gif" alt="">
   </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0094.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
   <math>
    <msub>
     <mi>
      X
     </mi>
     <mrow>
      <mi>
       s
      </mi>
      <mi>
       i
      </mi>
      <mi>
       m
      </mi>
     </mrow>
    </msub><mo stretchy="false">
     (
    </mo><mi>
     t
    </mi><mo stretchy="false">
     )
    </mo><mo>
     =
    </mo><msub>
     <mi>
      V
     </mi>
     <mrow>
      <mi>
       u
      </mi>
      <mi>
       s
      </mi>
      <mi>
       a
      </mi>
      <mi>
       b
      </mi>
      <mi>
       l
      </mi>
      <mi>
       e
      </mi>
     </mrow>
    </msub><mo stretchy="false">
     (
    </mo><mi>
     t
    </mi><mo stretchy="false">
     )
    </mo><mrow>
     <mo>
      /
     </mo>
    </mrow><mi>
     V
    </mi>
   </math></span>, where <span class="NLM_disp-formula-image inline-formula rs_preserve">
   <noscript>
    <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0095.gif" alt="">
   </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0095.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
   <math>
    <msub>
     <mi>
      V
     </mi>
     <mrow>
      <mi>
       u
      </mi>
      <mi>
       s
      </mi>
      <mi>
       a
      </mi>
      <mi>
       b
      </mi>
      <mi>
       l
      </mi>
      <mi>
       e
      </mi>
     </mrow>
    </msub>
   </math></span> is the volume of water above <span class="NLM_disp-formula-image inline-formula rs_preserve">
   <noscript>
    <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0096.gif" alt="">
   </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0096.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
   <math>
    <msub>
     <mi>
      T
     </mi>
     <mrow>
      <mi>
       s
      </mi>
      <mi>
       h
      </mi>
     </mrow>
    </msub>
   </math></span> or <span class="NLM_disp-formula-image inline-formula rs_preserve">
   <noscript>
    <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0097.gif" alt="">
   </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0097.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
   <math>
    <msub>
     <mi>
      T
     </mi>
     <mrow>
      <mi>
       d
      </mi>
      <mi>
       h
      </mi>
      <mi>
       w
      </mi>
     </mrow>
    </msub>
   </math></span>, depending on the thermal storage tank in question.</p>
 <p>The errors for the domestic how water tank are on average 2.53 times higher than the errors for the space heating storage tank. This finding is also supported by Figure&nbsp;<a href="#F0004">4</a>. In these figures, the dynamics of the space heating tank are more accurately modelled than the smaller domestic hot water tank. However, both models are still fairly accurate in the short term, and thus don't result in particularly large errors overall.</p>
 <div id="S003-S2001" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i42">3.1. Sensitivity analysis</h3>
  <p>To assess the extent to which the results of Section&nbsp;<a href="#S003">3</a> are dependent on the fixed parameters described in Section&nbsp;<a href="#S002">2</a>, the following problem variants are tested:</p>
  <ul class="NLM_list NLM_list-list_type-bullet">
   <li><p class="inline">Battery capacity increased by 20%</p></li>
   <li><p class="inline">Battery capacity decreased by 20%</p></li>
   <li><p class="inline">Thermal storage capacity increased by 20%</p></li>
   <li><p class="inline">Thermal storage capacity decreased by 20%</p></li>
   <li><p class="inline">Heating and electrical loads increased by 20%</p></li>
   <li><p class="inline">Heating and electrical loads decreased by 20%</p></li>
  </ul>
  <p></p>
  <p>The maximum and minimum results from these tests are shown in Tables&nbsp;<button class="ref showTableEventRef" data-id="T0008">8</button>,&nbsp;<button class="ref showTableEventRef" data-id="T0009">9</button>, and&nbsp;<button class="ref showTableEventRef" data-id="T0010">10</button>. The model numbers shown in these tables correspond with those shown in Tables&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button>, <button class="ref showTableEventRef" data-id="T0006">6</button>, and&nbsp;<button class="ref showTableEventRef" data-id="T0007">7</button>.</p>
  <div class="tableViewerArticleInfo hidden">
   <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>05 November 2020
    </div>
   </div>
  </div>
  <div class="tableView">
   <div class="tableCaption">
    <div class="short-legend">
     <h3><b>Table 8. Model comparison part 1: MILP models.</b></h3>
    </div>
   </div>
   <div class="tableDownloadOption" data-hascsvlnk="true" id="T0008-table-wrapper">
    <a class="downloadButton btn btn-sm" role="button" href="/action/downloadTable?id=T0008&amp;doi=10.1080%2F19401493.2020.1838611&amp;downloadType=CSV"> Download CSV</a><a data-id="T0008" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
   </div>
  </div>
  <div class="tableViewerArticleInfo hidden">
   <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>05 November 2020
    </div>
   </div>
  </div>
  <div class="tableView">
   <div class="tableCaption">
    <div class="short-legend">
     <h3><b>Table 9. Model comparison part 2: NLP models.</b></h3>
    </div>
   </div>
   <div class="tableDownloadOption" data-hascsvlnk="true" id="T0009-table-wrapper">
    <a class="downloadButton btn btn-sm" role="button" href="/action/downloadTable?id=T0009&amp;doi=10.1080%2F19401493.2020.1838611&amp;downloadType=CSV"> Download CSV</a><a data-id="T0009" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
   </div>
  </div>
  <div class="tableViewerArticleInfo hidden">
   <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>05 November 2020
    </div>
   </div>
  </div>
  <div class="tableView">
   <div class="tableCaption">
    <div class="short-legend">
     <h3><b>Table 10. Model comparison part 3: MINLP models.</b></h3>
    </div>
   </div>
   <div class="tableDownloadOption" data-hascsvlnk="true" id="T0010-table-wrapper">
    <a class="downloadButton btn btn-sm" role="button" href="/action/downloadTable?id=T0010&amp;doi=10.1080%2F19401493.2020.1838611&amp;downloadType=CSV"> Download CSV</a><a data-id="T0010" class="downloadButton btn btn-sm displaySizeTable" href="#" role="button">Display Table</a>
   </div>
  </div>
  <p></p>
  <p>The negative cost is due to the case where load is decreased (but pv generation is unaffected) and excess generated power is sold to the grid. Interestingly, the runtime for models which include a continuous heat pump seems to be largely unaffected by the parameter changes, while there is significant deviation amongst the models which include discrete heat pump dynamics. The model error varies consistently amongst all models. Furthermore, none of the tests result in a consistent increase or decrease in model error. For example, the minimum SH tank error for Model 18 occurs in the case of increased load, while the SH tank error for Model 1 is highest in this case. Overall, there is a slight increase in DHW error in the case of increased loads, and a slight decrease for both TS tank errors in the case of decreased loads.</p>
 </div>
</div>
<div id="S004" class="NLM_sec NLM_sec_level_1">
 <h2 id="_i46" class="section-heading-2">4. Analysis of results</h2>
 <p>The results from Section&nbsp;<a href="#S003">3</a> are grouped into three categories: MILP, NLP and MINLP models. There are a number of interesting insights to be gleaned from Tables&nbsp;<button class="ref showTableEventRef" data-id="T0005">5</button>,&nbsp;<button class="ref showTableEventRef" data-id="T0006">6</button>, and <button class="ref showTableEventRef" data-id="T0007">7</button>. The first of which is that using a discrete heat pump model leads to runtimes that are 2 orders of magnitude longer than the same model with a continuous heat pump model. As the error for the space heating and domestic hot water tanks indicate, the continuous model does not have a sizable impact on accuracy. As shown in Section&nbsp;<a href="#S003-S2001">3.1</a>, the runtime of models which include discrete heat pump dynamics has some sensitivity with respect to the input parameters and load profiles, however, even in the best case the problem is not solved nearly as quickly as an equivalent model with continuous heat pump dynamics.</p>
 <p>Second, penalizing the emptiness of the battery in the final time step of the optimization subproblems generally has an unpredictable effect on the overall cost of system operation. For example, both the most and least expensive models have <span class="NLM_disp-formula-image inline-formula rs_preserve">
   <noscript>
    <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0098.gif" alt="">
   </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0098.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
   <math>
    <mi>
     γ
    </mi><mo>
     =
    </mo><mn>
     0.5
    </mn>
   </math></span>. On average, a penalty term of 0 or 0.1 seemed to result in the lowest costs. This could be due in part to the specific electricity and heating demands, as this penalty can sometimes help mitigate the costs of unexpected peaks in electricity or heating demand, while leading to some suboptimality otherwise.</p>
 <p>Third, whether or not the grid connection is modelled using mixed-integer or continuous, nonlinear dynamics did not seem to significantly affect the runtime, cost or accuracy of the modelled system. This is particularly interesting given the huge impact caused by the choice of continuous vs. discrete heat pump activation.</p>
 <p>Overall, using thermal storages modelled with&nbsp;(<a href="#M0006">6</a>) or&nbsp;(<a href="#M0008">8</a>) lead to the slightly faster runtime and also slightly higher cost. The lowest operational cost ($1.73) is achieved by using&nbsp;(<a href="#M0002">2</a>) as the grid connection,&nbsp;(<a href="#M0005">5</a>) for the heat pump and&nbsp;(<a href="#M0007">7</a>) for the thermal storage model. Doing so also results in one of the slowest runtime amongst the models with continuous heat pumps (4.51 s). However, as the scale of the problem is in the order of hours and days, the difference between runtimes is quite trivial but the difference in cost is much more significant.</p>
 <p>The solution trajectories output by the models can also offer some insight into the effects of each modelling choice. To this end, the results for the most and least expensive models from Section&nbsp;<a href="#S003">3</a> are shown in Figures&nbsp;<a href="#F0006">6</a> and&nbsp;<a href="#F0007">7</a>.</p>
 <div class="figure figureViewer" id="F0006">
  <div class="hidden figureViewerArticleInfo">
   <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>05 November 2020
    </div>
   </div>
  </div>
  <div class="figureThumbnailContainer">
   <div class="figureInfo">
    <div class="short-legend">
     <p class="captionText"><span class="captionLabel">Figure 6. </span> Thermal storage trajectories for the most and least expensive models of Section&nbsp;<a href="#S004">4</a>. <span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0099.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0099.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msub>
         <mi>
          X
         </mi>
         <mrow>
          <mi>
           d
          </mi>
          <mi>
           h
          </mi>
          <mi>
           w
          </mi>
         </mrow>
        </msub>
       </math></span> denotes the proportion of usable water in the domestic hot water tank and <span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0100.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0100.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msub>
         <mi>
          X
         </mi>
         <mrow>
          <mi>
           s
          </mi>
          <mi>
           h
          </mi>
         </mrow>
        </msub>
       </math></span> is the proportion of usable water in the space heating tank.</p>
    </div>
   </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0006image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/medium/tbps_a_1838611_f0006_oc.jpg" loading="lazy" height="355" width="500"></a>
   <div class="figureDownloadOptions">
    <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
   </div>
  </div>
 </div>
 <div class="hidden rs_skip" id="fig-description-F0006">
  <p class="captionText"><span class="captionLabel">Figure 6. </span> Thermal storage trajectories for the most and least expensive models of Section&nbsp;<a href="#S004">4</a>. <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0099.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0099.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       X
      </mi>
      <mrow>
       <mi>
        d
       </mi>
       <mi>
        h
       </mi>
       <mi>
        w
       </mi>
      </mrow>
     </msub>
    </math></span> denotes the proportion of usable water in the domestic hot water tank and <span class="NLM_disp-formula-image inline-formula rs_preserve">
    <noscript>
     <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0100.gif" alt="">
    </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0100.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
    <math>
     <msub>
      <mi>
       X
      </mi>
      <mrow>
       <mi>
        s
       </mi>
       <mi>
        h
       </mi>
      </mrow>
     </msub>
    </math></span> is the proportion of usable water in the space heating tank.</p>
 </div>
 <div class="hidden rs_skip" id="figureFootNote-F0006">
  <div class="figureFootNote-F0006"></div>
 </div>
 <div class="figure figureViewer" id="F0007">
  <div class="hidden figureViewerArticleInfo">
   <span class="figViewerTitle">On modelling effects in the battery and thermal storage scheduling problem</span>
   <div class="articleAuthors articleInfoSection">
    <div class="authorsHeading">
     All authors
    </div>
    <div class="authors">
     <a class="entryAuthor" href="/action/doSearch?Contrib=Murray%2C+Alexander"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Murray%2C+Alexander"><span class="NLM_given-names">Alexander</span> Murray</a> <a href="https://orcid.org/0000-0002-9436-0407"><img src="/templates/jsp/images/orcid.png"></a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Sch%C3%BCtz%2C+Thomas"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Sch%C3%BCtz%2C+Thomas"><span class="NLM_given-names">Thomas</span> Schütz</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=Pan%2C+Guanru"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Pan%2C+Guanru"><span class="NLM_given-names">Guanru</span> Pan</a>, <a class="entryAuthor" href="/action/doSearch?Contrib=M%C3%BCller%2C+Dirk"><span class="hlFld-ContribAuthor"></span></a><a href="/author/M%C3%BCller%2C+Dirk"><span class="NLM_given-names">Dirk</span> Müller</a> &amp; <a class="entryAuthor" href="/action/doSearch?Contrib=Hagenmeyer%2C+Veit"><span class="hlFld-ContribAuthor"></span></a><a href="/author/Hagenmeyer%2C+Veit"><span class="NLM_given-names">Veit</span> Hagenmeyer</a>
    </div>
   </div>
   <div class="articleLowerInfo articleInfoSection">
    <div class="articleLowerInfoSection articleInfoDOI">
     <a href="https://doi.org/10.1080/19401493.2020.1838611">https://doi.org/10.1080/19401493.2020.1838611</a>
    </div>
    <div class="articleInfoPublicationDate articleLowerInfoSection border">
     <h6>Published online:</h6>05 November 2020
    </div>
   </div>
  </div>
  <div class="figureThumbnailContainer">
   <div class="figureInfo">
    <div class="short-legend">
     <p class="captionText"><span class="captionLabel">Figure 7. </span> Solution trajectories for the most and least expensive models of Section&nbsp;<a href="#S004">4</a>.</p>
    </div>
   </div><a href="#" class="thumbnail" aria-label="thumbnail image"><img id="F0007image" src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/medium/tbps_a_1838611_f0007_oc.jpg" loading="lazy" height="500" width="362"></a>
   <div class="figureDownloadOptions">
    <a href="#" class="downloadBtn btn btn-sm" role="button">Display full size</a>
   </div>
  </div>
 </div>
 <div class="hidden rs_skip" id="fig-description-F0007">
  <p class="captionText"><span class="captionLabel">Figure 7. </span> Solution trajectories for the most and least expensive models of Section&nbsp;<a href="#S004">4</a>.</p>
 </div>
 <div class="hidden rs_skip" id="figureFootNote-F0007">
  <div class="figureFootNote-F0007"></div>
 </div>
 <p></p>
 <p>Despite the fact that both models use <span class="NLM_disp-formula-image inline-formula rs_preserve">
   <noscript>
    <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0101.gif" alt="">
   </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0101.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
   <math>
    <mi>
     γ
    </mi><mo>
     =
    </mo><mn>
     0.5
    </mn>
   </math></span>, the final state of charge for the batteries is quite different. The more expensive model has a last minute charging of the battery, which increases costs, while the least expensive ends with the battery completely depleted. Another significant factor in the cost difference is the fact that the more expensive case uses a discrete heat pump model and thus must rely on the electric heater at times. As can be observed in Figure&nbsp;<a href="#F0007">7</a>, the heat pump usage is the biggest difference between both models. The least expensive case has a continuous heat pump model and thus can charge the thermal storage tanks without ever relying on the inefficient electric heater. An implementation of the continuous heat pump solution could lead to chattering behaviour as it is rapidly switched on and off to only provide limited heating. This could lead to hidden costs in maintenance which are not accounted for in the presented results.</p>
</div>
<div id="S005" class="NLM_sec NLM_sec_level_1">
 <h2 id="_i49" class="section-heading-2">5. Conclusion</h2>
 <p>In this paper, multiple linear and nonlinear mixed-integer problem formulations for the cost-optimal control of a multi-model home energy system are compared. Several models for each component of the combined battery, heat pump and thermal storage system are given and compared within an MPC framework.</p>
 <p>Overall, for the given inputs, the continuous heat pump model leads to faster computing times without significantly affecting the model accuracy. The continuous heat pump is also shown to be better able to handle increased loads compared to the discrete case. However, as mentioned, there may be additional difficulties involved with implementing and using the solution to such a model. The linear thermocline-based thermal storage model yields the most cost-effective model on average while staying within reasonable runtime limits. The grid connection can be freely modelled as either a mixed-integer linear or continuous, non-convex equality constraint without loss of accuracy or speed. This choice will likely depend more on the algorithmic limitations of the user. Finally, some small penalty for the emptiness of the battery at the end of the scheduling horizon can be beneficial, although not in every case. The lowest-cost model includes a mixed-integer grid connection, continuous heat pump dynamics, a linear thermocline-based thermal storage model and a large penalty on battery emptiness at the end of the time horizon.</p>
 <p>Future works will be conducted in multiple facets. From an optimization point of view, future studies will seek to quantify and develop heuristics for choosing the penalty for storage emptiness at the end of the scheduling horizon depending on forecast data. Regarding application, future works will also include an examination of other scenarios, such as industrial settings or atypical weather. Furthermore, future work will attempt to solve the stochastic version of the BATSS problem with chance constraints and/or flexible loads.</p>
 <p>Furthermore, while the focus of the paper is on the modelling of heat pumps, thermal storages, and batteries, it would also be interesting to take temperature variations and room comfort into account. This could take the form of specific building topology or additional objective function terms.</p>
</div>
<div id="S006" class="NLM_sec NLM_sec_level_1">
 <h2 id="_i50" class="section-heading-2">6. Nomenclature</h2>
 <div id="S006-S2001" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i51">6.1. Control variables</h3>
  <table summary="" class="NLM_def-list">
   <tbody>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0102.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0102.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msubsup>
         <mi>
          P
         </mi>
         <mi>
          G
         </mi>
         <mo>
          +
         </mo>
        </msubsup><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>power fed to main grid at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0103.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0103.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msubsup>
         <mi>
          P
         </mi>
         <mi>
          G
         </mi>
         <mo>
          −
         </mo>
        </msubsup><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>power drawn from main grid at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0104.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0104.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <mi>
         z
        </mi><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>indicator variable for power flow direction at the grid connection at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0105.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0105.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msub>
         <mi>
          y
         </mi>
         <mrow>
          <mi>
           d
          </mi>
          <mi>
           h
          </mi>
          <mi>
           w
          </mi>
         </mrow>
        </msub><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>indicator variable for heat pump to warm the domestic hot water tank at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0106.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0106.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msub>
         <mi>
          y
         </mi>
         <mrow>
          <mi>
           s
          </mi>
          <mi>
           h
          </mi>
         </mrow>
        </msub><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>indicator variable for heat pump to warm the space heating tank at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0107.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0107.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msubsup>
         <mi>
          P
         </mi>
         <mrow>
          <mi>
           b
          </mi>
          <mi>
           a
          </mi>
          <mi>
           t
          </mi>
         </mrow>
         <mo>
          +
         </mo>
        </msubsup><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>power sent to battery at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0108.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0108.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msubsup>
         <mi>
          P
         </mi>
         <mrow>
          <mi>
           b
          </mi>
          <mi>
           a
          </mi>
          <mi>
           t
          </mi>
         </mrow>
         <mo>
          −
         </mo>
        </msubsup><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>power drawn from battery at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0109.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0109.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msub>
         <mi>
          z
         </mi>
         <mrow>
          <mi>
           b
          </mi>
          <mi>
           a
          </mi>
          <mi>
           t
          </mi>
         </mrow>
        </msub><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>indicator variable for power flow direction at the battery at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0110.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0110.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msub>
         <mi>
          P
         </mi>
         <mrow>
          <mi>
           e
          </mi>
          <mi>
           h
          </mi>
          <mo stretchy="false">
           →
          </mo>
          <mi>
           d
          </mi>
          <mi>
           h
          </mi>
          <mi>
           w
          </mi>
         </mrow>
        </msub><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>power used by electric heater in domestic hot water tank at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0111.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0111.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msub>
         <mi>
          P
         </mi>
         <mrow>
          <mi>
           e
          </mi>
          <mi>
           h
          </mi>
          <mo stretchy="false">
           →
          </mo>
          <mi>
           s
          </mi>
          <mi>
           h
          </mi>
         </mrow>
        </msub><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>power used by electric heater in space heating tank at time <i>t</i>.</p></td>
    </tr>
   </tbody>
  </table>
 </div>
 <div id="S006-S2002" class="NLM_sec NLM_sec_level_2">
  <h3 class="section-heading-3" id="_i52">6.2. State variables</h3>
  <table summary="" class="NLM_def-list">
   <tbody>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0112.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0112.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msub>
         <mi>
          P
         </mi>
         <mrow>
          <mi>
           h
          </mi>
          <mi>
           p
          </mi>
         </mrow>
        </msub><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>power used by heat pump at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0113.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0113.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msub>
         <mi>
          Q
         </mi>
         <mrow>
          <mi>
           h
          </mi>
          <mi>
           p
          </mi>
         </mrow>
        </msub><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>heat output of heat pump at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0114.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0114.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <mi>
         X
        </mi><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>thermal storage tank thermocline at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0115.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0115.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          1
         </mn>
        </msub><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>temperature at the bottom of the thermal storage tank at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0116.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0116.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          2
         </mn>
        </msub><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>temperature in the middle of the thermal storage tank at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0117.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0117.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <msub>
         <mi>
          T
         </mi>
         <mn>
          3
         </mn>
        </msub><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>temperature at the top of the thermal storage tank at time <i>t</i>.</p></td>
    </tr>
    <tr>
     <td class="NLM_term"><span class="NLM_disp-formula-image inline-formula rs_preserve">
       <noscript>
        <img src="/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0118.gif" alt="">
       </noscript><img src="//:0" alt="" class="mml-formula" data-formula-source="{&quot;type&quot; : &quot;image&quot;, &quot;src&quot; : &quot;/na101/home/literatum/publisher/tandf/journals/content/tbps20/2021/tbps20.v014.i01/19401493.2020.1838611/20210527/images/tbps_a_1838611_ilm0118.gif&quot;}"><span class="mml-formula"></span></span><span class="NLM_disp-formula inline-formula rs_preserve"><img src="//:0" alt="" data-formula-source="{&quot;type&quot; : &quot;mathjax&quot;}">
       <math>
        <mi>
         E
        </mi><mo stretchy="false">
         (
        </mo><mi>
         t
        </mi><mo stretchy="false">
         )
        </mo>
       </math></span></td>
     <td class="NLM_def"><p>state of charge of the battery at time <i>t</i>.</p></td>
    </tr>
   </tbody>
  </table>
 </div>
</div>