<div>
 <div class="article-formatted-body article-formatted-body article-formatted-body_version-2">
  <div xmlns="http://www.w3.org/1999/xhtml">
   <p>Применение искусственного интеллекта и машинного обучения в задачах промышленности не настолько распространено, как в других сферах и отраслях экономики вроде банкинга, ритейла, телекома. При этом современные промышленные объекты часто генерируют и собирают большое количество данных, а методы машинного обучения обеспечивают эффективное использование этих данных для решения различных устоявшихся типовых задач: выявления неисправностей и отказов, прогноз качества продукции, определения остаточного срока службы оборудования и многих других.</p>
   <p>Как раз про решение одной из типовых задач - задачи определения остаточного ресурса я и рассказывал на конференции <a href="https://datastart.ru/" rel="noopener noreferrer nofollow"><u>https://datastart.ru</u></a> в ноябре 2022 года, а также на митапе ИИшницы “ИИ в индустрии”, откуда даже сохранилось видео <a href="https://www.youtube.com/watch?v=vs2np-wGCYU" rel="noopener noreferrer nofollow"><u>Юрий Кацер | Задача определения остаточного ресурса оборудования</u></a>. В этом посте я соберу, структурирую и немного дополню информацию из докладов.</p>
   <h2>О технической диагностике</h2>
   <p>На основании ГОСТов и международных стандартов в процессе диагностирования машин можно выделить 4 основных этапа: <em>Обнаружение аномалий в работе </em>или неисправностей, <em>Локализация неисправности</em> или выход на конкретные сигналы, вносящие наибольший вклад в обнаружение неисправности, <em>Выход на диагноз</em>, представляющий собой определение коренных причин возникновения неисправности, а также <em>Прогноз развития неисправности</em> или, другими словами, оценка (прогноз) остаточного ресурса оборудования. Высокое качество решения этих задач, благодаря эффективному внедрению технологий анализа данных позволяет промышленным предприятиям перейти на стратегию технического обслуживания по состоянию (condition-based maintenance). Типичная схема цикла диагностирования оборудования представлена на рисунке ниже.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/d1d/d3e/038/d1dd3e038f3aae8c8b0dd86794dca8eb.png" alt="Схема цикла диагностирования оборудования" title="Схема цикла диагностирования оборудования" width="1600" height="272" data-src="https://habrastorage.org/getpro/habr/upload_files/d1d/d3e/038/d1dd3e038f3aae8c8b0dd86794dca8eb.png">
    <figcaption>
     Схема цикла диагностирования оборудования
    </figcaption>
   </figure>
   <p>В этом посте речь идет о задаче оценки остаточного ресурса, при этом результат решения задач обнаружения неисправностей, локализации и выхода на диагноз могут как использоваться, так и не использоваться при прогнозе остаточного ресурса, но все зависит от применяемого подхода.</p>
   <h2>О задаче определения остаточного ресурса</h2>
   <p>Для начала давайте дадим определение (согласно ГОСТ Р ИСО 13381-1-2016. Контроль состояния и диагностика машин. ПРОГНОЗИРОВАНИЕ ТЕХНИЧЕСКОГО СОСТОЯНИЯ. Часть 1. Общее руководство):</p>
   <p><code>Остаточный ресурс - оставшееся время до перехода машины в неработоспособное состояние (или до перехода в состояние, при котором машине потребуется ремонт или замена).</code></p>
   <p>Проиллюстрировать определение можно следующим образом:</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/fab/32d/290/fab32d2902fa070207dec3355cc92622.png" alt="Иллюстративный пример задачи определения остаточного ресурса" title="Иллюстративный пример задачи определения остаточного ресурса" width="1600" height="683" data-src="https://habrastorage.org/getpro/habr/upload_files/fab/32d/290/fab32d2902fa070207dec3355cc92622.png">
    <figcaption>
     Иллюстративный пример задачи определения остаточного ресурса
    </figcaption>
   </figure>
   <p>То есть в каждый момент времени мы можем оценить время до возникновения критического состояния, обозначенного красной точкой. При этом время может быть оценено в днях, полетах, циклах, пробегах, плавках или каких-то других величинах, все зависит от постановки задачи и доступных данных.</p>
   <p>Решение задачи определения остаточного ресурса дополнительно позволяет выявлять факторы, влияющие на сокращение остаточного ресурса (если вдруг красная точки согласно нашему прогнозу начинает двигаться влево, то есть расстояние до нее сокращается), и устранять нежелательное воздействие факторов в настоящем и будущем. Кстати, появление аномального состояние (не путать с неработоспособным, ведь с незначительными аномалиями оборудование иногда может работать годами) может являться одним из факторов, учитываемым в модели, например, в виде времени работы узла оборудования в аномальном состоянии.</p>
   <p>Также важно немного разобраться с терминологией, поэтому перечислю различные синонимы остаточного ресурса, которые я встречал в литературе (означают они примерно одно и то же):</p>
   <ul>
    <li><p>Remaining useful life (RUL)</p></li>
    <li><p>Time to failure (TTF)</p></li>
    <li><p>Оставшееся время жизни</p></li>
    <li><p>Residual useful life</p></li>
    <li><p>Remaining lifetime</p></li>
   </ul>
   <h2>Почему эта задача важна?</h2>
   <p>Зная остаточный ресурс, технологический персонал, инженеры, операторы, ремонтные службы, диагносты могут:</p>
   <ul>
    <li><p>планировать ремонты</p></li>
    <li><p>оптимизировать стратегию технического обслуживания оборудования (заменять большие ремонты мелкими, сокращать количество процедур и манипуляций с оборудованием и тд)</p></li>
    <li><p>оптимизировать режимы работы и загрузку оборудования</p></li>
    <li><p>избегать и сокращать количество и длительность внеплановых остановок&nbsp;</p></li>
   </ul>
   <p>Поэтому данная задача является одной из важнейших в диагностике и критической для перехода к стратегии обслуживания по состоянию.</p>
   <h2>Данные</h2>
   <p>При решении задачи нам могут быть доступны различные данные, поэтому некоторые подходы и методы могут быть неприменимы. Давайте классифицируем потенциально доступные данные, чтобы при представлении методов опираться на то, какие данные необходимы:</p>
   <ul>
    <li><p>Данные о работе оборудования (технологические параметры, сигналы с датчиков за весь срок работы оборудования с момента запуска до моментов отказа):</p></li>
   </ul>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/6dc/6eb/ce8/6dc6ebce8198f765484fa68cbba59460.png" width="1498" height="716" data-src="https://habrastorage.org/getpro/habr/upload_files/6dc/6eb/ce8/6dc6ebce8198f765484fa68cbba59460.png">
    <figcaption></figcaption>
   </figure>
   <ul>
    <li><p>Данные о времени работы оборудования до отказа (длительность “пробегов” до отказа)</p></li>
   </ul>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/f26/721/32e/f2672132e69ad4a806d6a9c6fb220e43.png" width="1600" height="450" data-src="https://habrastorage.org/getpro/habr/upload_files/f26/721/32e/f2672132e69ad4a806d6a9c6fb220e43.png">
    <figcaption></figcaption>
   </figure>
   <ul>
    <li><p>Информация о допустимых значениях (контрольные пределы) для отдельных сигналов или индикаторов технического состояния, достижение которых сигнализирует выход из строя</p></li>
   </ul>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/c37/081/b14/c37081b140e6a054361b01d8a0a406aa.png" width="1600" height="411" data-src="https://habrastorage.org/getpro/habr/upload_files/c37/081/b14/c37081b140e6a054361b01d8a0a406aa.png">
    <figcaption></figcaption>
   </figure>
   <h3>Подходы к решению задачи</h3>
   <ol>
    <li><p>Статистическая оценка</p></li>
   </ol>
   <p>Мы можем использовать функцию распределения времени до отказа, построенную на исторических данных, для оценки остаточного ресурса оборудования:</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/0ec/ae7/7fd/0ecae77fd509e7b5627ef7ceee3f652b.png" alt="Схема оценки остаточного ресурса через статистическую оценку" title="Схема оценки остаточного ресурса через статистическую оценку" width="1600" height="808" data-src="https://habrastorage.org/getpro/habr/upload_files/0ec/ae7/7fd/0ecae77fd509e7b5627ef7ceee3f652b.png">
    <figcaption>
     Схема оценки остаточного ресурса через статистическую оценку
    </figcaption>
   </figure>
   <p>Это один из самых простых методов, для которого нужны лишь множество <em>данных о длительности работы оборудования до отказа</em>. Также можно рассчитать характеристику “функция выживания” (survival function или survival model) = 1 - cdf. Добавляя какие-то дополнительные (косвенные) данные о работе оборудования, можно повышать качество работы метода, например, выделяя различные режимы и строя для каждого режима свою функцию распределения (скорость деградации).</p>
   <ol start="2">
    <li><p>Прогноз параметров</p></li>
   </ol>
   <p>Оценка остаточного ресурса основана на прогнозе параметров до пересечения контрольного предела. Такой подход также называют подходом оценки деградации (degradation model) и различают 2 основных закона деградации:</p>
   <ol>
    <li><p>Линейная деградация: прогноз представляет собой прямую, угол наклона которой определяется историческими данными. Как правило, применяется, если система не накапливает повреждения (деградацию).</p></li>
    <li><p>Экспоненциальная деградация: прогноз представляет собой экспоненту. Как правило, применяется, если система может кумулятивно накапливать повреждения.</p></li>
   </ol>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/9b0/bdd/3b6/9b0bdd3b68679f0dc6efd3f3bf88b905.png" alt="Схема оценки остаточного ресурса через прогнозирование параметров" title="Схема оценки остаточного ресурса через прогнозирование параметров" width="1600" height="855" data-src="https://habrastorage.org/getpro/habr/upload_files/9b0/bdd/3b6/9b0bdd3b68679f0dc6efd3f3bf88b905.png">
    <figcaption>
     Схема оценки остаточного ресурса через прогнозирование параметров
    </figcaption>
   </figure>
   <p>&nbsp;В данном случае есть 2 варианта выбора параметров для прогноза:</p>
   <ol>
    <li><p>Прогноз сигнала с датчика</p></li>
    <li><p>Прогноз индекса технического состояния</p></li>
   </ol>
   <p>Для обоих вариантов необходимы <em>данные о работе оборудования (технологические параметры, сигналы с датчиков)</em>, но для второго случая на их основе строится индекс или индикатор технического состояния (health indicator), который далее прогнозируется. Индикатор технического состояния может представлять из себя компоненту из PCA, результат агрегации различных показателей, невязку между моделью нормального режима работы и реальными данными и тд, вбирая в себя как можно больше информации, не основываясь только на одном сигнале. Также необходимы <em>контрольные пределы</em> или информация о времени работы оборудования до отказа (длительность “пробегов” до отказа), с помощью которых вместе данными о работе оборудования можно рассчитать контрольные пределы самостоятельно (при достаточной статистике). Прогнозировать параметры можно разными методами, некоторые подробно разобраны в лекции от ODS по <a href="https://github.com/Yorko/mlcourse.ai/blob/main/jupyter_russian/topic09_time_series/topic9_part1_time_series_python.ipynb" rel="noopener noreferrer nofollow">ссылке</a> (с кодом!).</p>
   <ol start="3">
    <li><p>На основе моделей регрессии</p></li>
   </ol>
   <p>В данном случае мы приводим задачу к классической регрессионной постановке. Для этого мы выделяем из временных рядов (технологических параметров или индексов технического состояния) признаки, например, с помощью библиотеки <a href="https://tsfresh.readthedocs.io/en/latest/" rel="noopener noreferrer nofollow"><u>TSFresh</u></a>. Схема выделения признаков представлена на рисунке ниже:</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/d70/4a6/e7f/d704a6e7fa6e0c7f6c68ee63bebefddf.png" alt="Схема оценки остаточного ресурса с помощью модели регрессии" title="Схема оценки остаточного ресурса с помощью модели регрессии" width="1600" height="1310" data-src="https://habrastorage.org/getpro/habr/upload_files/d70/4a6/e7f/d704a6e7fa6e0c7f6c68ee63bebefddf.png">
    <figcaption>
     Схема оценки остаточного ресурса с помощью модели регрессии
    </figcaption>
   </figure>
   <p>В результате чего у нас формируется выборка признаков - X, и нам нужна выборка ответов (времен до отказа) - y. Таким образом, для данного подхода нужны <em>данные о работе оборудования (технологические параметры, сигналы с датчиков)</em> и <em>данные о длительности работы оборудования до отказа (длительность)</em>, а задача может решаться как классическая задача регрессии на табличных данных любыми SOTA (читай, ансамблевыми) методами.</p>
   <ol start="4">
    <li><p>На основе схожести с паттернами из прошлого</p></li>
   </ol>
   <p>Последний из наиболее распространенных подходов к оценке остаточного ресурса основан на сопоставлении текущего пробега или состояния с историческими данными. Исторические пробеги мы можем обрезать до того же момента времени, что есть у текущего пробега. Подход также известен как модель близости (similarity model).</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/90e/85a/3d3/90e85a3d3d764964d3449c0ee93b2d66.png" alt="Схема оценки остаточного ресурса на основе схожести с паттернами из прошлого" title="Схема оценки остаточного ресурса на основе схожести с паттернами из прошлого" width="1600" height="835" data-src="https://habrastorage.org/getpro/habr/upload_files/90e/85a/3d3/90e85a3d3d764964d3449c0ee93b2d66.png">
    <figcaption>
     Схема оценки остаточного ресурса на основе схожести с паттернами из прошлого
    </figcaption>
   </figure>
   <p>Для данного подхода есть 2 основных варианта реализации:</p>
   <ul>
    <li><p>Прямое сравнение временных рядов, используя метрики близости, например, Dynamic Time Warping (DTW) или методы кластеризации/классификации, основанные на близости. Примеры с кодом можно найти <a href="https://nbviewer.org/github/alexminnaar/time-series-classification-and-clustering/blob/master/Time%20Series%20Classification%20and%20Clustering.ipynb" rel="noopener noreferrer nofollow"><u>здесь</u></a>, также можно воспользоваться готовыми библиотеками, например, <a href="https://tslearn.readthedocs.io/en/stable/variablelength.html" rel="noopener noreferrer nofollow"><u>tslearn</u></a>.</p></li>
    <li><p>Выделение признаков из временного ряда и дальнейшее сравнение полученных векторов признаков (метрики близости, кластеризация).</p></li>
   </ul>
   <p>В результате в качестве остаточного ресурса мы выбираем значение ближайшего из истории пробега или осредненного (или любая другая агрегация) по группе (кластеру) пробегов. Для реализации подхода требуются<em> данные о работе оборудования (технологические параметры, сигналы с датчиков)</em> и <em>данные о длительности работы оборудования до отказа (длительность).</em></p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/c2f/d0a/6dd/c2fd0a6dd3d760fc9fbce3b85efa7771.png" alt="Итоговая схема выбора подхода в зависимости от доступных данных" title="Итоговая схема выбора подхода в зависимости от доступных данных" width="1976" height="646" data-src="https://habrastorage.org/getpro/habr/upload_files/c2f/d0a/6dd/c2fd0a6dd3d760fc9fbce3b85efa7771.png">
    <figcaption>
     Итоговая схема выбора подхода в зависимости от доступных данных
    </figcaption>
   </figure>
   <h2>Выявление факторов, влияющих на износ</h2>
   <p>Как мы выяснили ранее, важной сопутствующей задачей при оценке остаточного ресурса является определение факторов, которые на этот ресурс влияют и влияют в первую очередь негативно, вызывая повышенный износ. Под факторами, вызывающими износ оборудования, стоит в первую очередь понимать конкретные сигналы, указывающие на локализацию проблемы, приводящей к аномальному состоянию и износу оборудования. Эта информация может быть передана персоналу для указания, например, на нежелательные режимы работы. Далее можно совместно с экспертами в доменной области проводить анализ и выяснять, что становится причиной отклонения тех или иных сигналов от нормальных значений и деградации оборудования на основе этих показаний.</p>
   <p>Стоит разделить 2 понятия:</p>
   <ol>
    <li><p>Важные признаки для модели в целом: Факторы, оказывающие наибольшее влияние на результат оценки остаточного ресурса (самые важные признаки модели).</p></li>
    <li><p>Вклад признаков на данном показании модели: Факторы, оказавшие наибольшее влияние (объясняющие) на текущее оценку остаточного ресурса.</p></li>
   </ol>
   <p>То есть влияющими на износ в терминах первого понятия являются факторы, уменьшающие прогноз модели, а в рамках второго понятия - факторы, повлиявшие на низкое значение текущего прогноза. Для моделей машинного обучения такие библиотеки как Shap могут выдавать как первые, так и вторые факторы.&nbsp;</p>
   <p>Для каждого из перечисленных подходов выявление факторов производится по-своему:</p>
   <ol>
    <li><p><strong>Статистическая оценка:</strong> возможно только при наличии дополнительных косвенных данных, например, разные наклоны кривой распределения (=скорость деградации) для разных режимов работы.</p></li>
    <li><p><strong>Прогноз параметров:</strong> в качестве факторов, влияющих на износ оборудования, могут выбираться именно те сигналы, которые раньше других пересекли контрольные пределы.</p></li>
    <li><p><strong>На основе моделей регрессии:</strong> feature importance для моделей машинного обучения, Shap и другие методы оценки важности признаков и объяснения показаний моделей.</p></li>
    <li><p><strong>На основе схожести с паттернами из прошлого:</strong> может быть как в предыдущем пункте (если строятся модели машинного обучения), либо в качестве факторов, повлиявших на износ оборудования, берутся те, которые в итоге повлияли на фактический износ оборудования для отказа оборудования из прошлого, с которым схож текущий цикл/прогон. Эта информация может быть доступна по итогам анализа отделом диагностики.</p></li>
   </ol>
   <h2>Кейсы решения задачи</h2>
   <p>Расскажу о паре практических кейсов по решению задачи определения остаточного ресурса их своего опыта.</p>
   <h3>Кейс 1 - остаточный ресурс гильз МНЛЗ</h3>
   <p>Начнем с пары терминов:</p>
   <p><code>Машина непрерывного литья заготовки (МНЛЗ) – это агрегат, который позволяет преобразовать жидкую сталь в твердую заготовку заданного сечения, из которой в дальнейшем производится прокат, например, арматура.</code></p>
   <p><code>Гильза кристаллизатора – наиболее ответственная и быстроизнашиваемая часть кристаллизатора МНЛЗ. Гильза представляет собой водоохлаждаемую медную трубу круглого или профильного сечения. Расплавленный металл, контактируя со стенками гильзы, кристаллизуется и, тем самым, формируется первичная твердая оболочка слитка.</code></p>
   <p>Более подробно об установке и процессе можно почитать в <a href="https://habr.com/ru/company/evraz/blog/656795/" rel="noopener noreferrer nofollow"><u>статье от Евраза</u></a>.</p>
   <p>Основная проблема, с которой сталкивается производство при эксплуатации гильз, это образование дефектов поверхности медной трубы гильзы, искажение профиля её внутренней полости. При этом нарушается тепловой режим работы, что, в свою очередь, отражается на качестве получаемых слитков: появляются дефекты формы (например, диагонали квадратного слитка оказываются неравны, возникает так называемый дефект “ромбичность”), изменяются размеры сторон, могут появиться трещины в углах. Указанные дефекты приводят к проблемам в следующем переделе (в прокатке): снижается качество продукции, растет количество брака, что неблагоприятно влияет на экономику производства.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/88d/cec/b60/88dcecb60df2e74a1f9e1dc521bffa86.png" alt="Пайплайн решения задачи" title="Пайплайн решения задачи" width="1600" height="276" data-src="https://habrastorage.org/getpro/habr/upload_files/88d/cec/b60/88dcecb60df2e74a1f9e1dc521bffa86.png">
    <figcaption>
     Пайплайн решения задачи
    </figcaption>
   </figure>
   <p>Размеры гильзы с определенной периодичностью измеряются по всей длине, при отклонении этих размеров от основных параметров происходит их отбраковка.</p>
   <p>Может наблюдаться уменьшение срока службы медных гильз кристаллизатора на производстве, что может быть связано с изменением параметров работы самой МНЛЗ (температура входящей стали, температура охлаждающей воды и пр.), поэтому данные признаки также включены в модель. Модель строится для оценки остаточного ресурса, изменяющегося в тоннах или оставшихся плавках.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/2c4/ee0/597/2c4ee0597efedf67e248811f812fa1e6.png" alt="Схема решения" title="Схема решения" width="1600" height="523" data-src="https://habrastorage.org/getpro/habr/upload_files/2c4/ee0/597/2c4ee0597efedf67e248811f812fa1e6.png">
    <figcaption>
     Схема решения
    </figcaption>
   </figure>
   <h3>Кейс 2 - остаточный ресурс силовых трансформаторов</h3>
   <p>Большое число трансформаторов имеют возраст более 25 лет. Это делает еще более актуальной задачу своевременного обнаружения неисправностей, так как техническое обслуживание и ремонт требует корректного планирования для снижения издержек. Как мы знаем, решение задачи оценки остаточного ресурса - важнейшее звено для корректного планирования ремонтов, особенно с учетом солидного возраста оборудования, часто превышающего установленные пределы эксплуатации (не пугайтесь, продление срока эксплуатации происходит только после тщательной диагностики).</p>
   <p>Кстати, про решение задачи поиска аномалий для трансформаторов можно почитать в нашей статье на <a href="https://arxiv.org/abs/2211.11013" rel="noopener noreferrer nofollow"><u>архиве</u></a>.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/465/5eb/0b6/4655eb0b6c4e5dad81175f49f1d59444.png" alt="Схема решения" title="Схема решения" width="1600" height="537" data-src="https://habrastorage.org/getpro/habr/upload_files/465/5eb/0b6/4655eb0b6c4e5dad81175f49f1d59444.png">
    <figcaption>
     Схема решения
    </figcaption>
   </figure>
   <p>В качестве исходных данных мы используем результаты ХАРГ (хроматографического анализа растворенных газов), то есть у нас есть концентрации четырех измеренных каждые 12 часов в трансформаторном масле газов (H2; CО; C2H4; C2H2), то есть данные о работе оборудования, и данные о времени работы оборудования до отказа (длительность пробегов). В итоге мы обучили модель со средней абсолютной ошибкой в 27 дней.</p>
   <p>Больше кейсов и датасетов для тренировки, как и общих кейсов применения машинного обучения в промышленности, можете найти в <a href="https://github.com/YKatser/Industrial-ML-cases" rel="noopener noreferrer nofollow"><u>моем обзорном репозитории</u></a>:</p>
   <figure class="bordered full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/281/ab0/06a/281ab006a70b3ad14337e353eb7328e3.png" width="1600" height="843" data-src="https://habrastorage.org/getpro/habr/upload_files/281/ab0/06a/281ab006a70b3ad14337e353eb7328e3.png">
    <figcaption></figcaption>
   </figure>
   <p></p>
  </div>
 </div>
</div> <!----> <!---->