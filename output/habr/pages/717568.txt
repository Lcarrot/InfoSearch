<div>
 <div class="article-formatted-body article-formatted-body article-formatted-body_version-2">
  <div xmlns="http://www.w3.org/1999/xhtml">
   <p>Привет, Хабр!</p>
   <p>Меня зовут Ксения Рысаева, я руковожу группой аналитиков в&nbsp;Центре противодействия киберугрозам Innostage CyberART. Мы с&nbsp;командой решили пофантазировать, а&nbsp;что&nbsp;может случиться, если хакер пробьет защиту регистратора доменов. Фантазии&nbsp;быстро улетучились, когда цепочка привела нас к&nbsp;неутешительным выводам&nbsp;— если положить регистратора, пострадают абсолютно все.</p>
   <p>Давайте вместе разберемся, что&nbsp;будет, если злоумышленник получит доступ к&nbsp;регистратору домена.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/5f6/44b/cc7/5f644bcc760eefa29cf0a73a6f0aff92.jpg" width="780" height="440" data-src="https://habrastorage.org/getpro/habr/upload_files/5f6/44b/cc7/5f644bcc760eefa29cf0a73a6f0aff92.jpg" data-blurred="true">
    <figcaption></figcaption>
   </figure>
   <p><strong>Регистратор доменов</strong>&nbsp;— это организация, предоставляющая возможность зарегистрировать пользователям новые домены и продлить срок регистрации уже заказанных доменных имен.</p>
   <p>Существует множество регистраторов, и все они обязаны пользоваться единой базой данных, чтобы избежать конфликтных ситуаций и сохранить уникальность доменного имени. Это довольно привлекательная мишень для&nbsp;хакеров, которые не&nbsp;любят сложные обходные пути и идут сразу на&nbsp;таран.</p>
   <p>Разберем на&nbsp;примерах, какие риски и последствия могут&nbsp;быть от&nbsp;таких атак.</p>
   <h4>Утечка конфиденциальной информации</h4>
   <p>Первый и очевидный риск&nbsp;— злоумышленник может получить конфиденциальные данные пользователей этого регистратора. Как&nbsp;это сделали 6&nbsp;сентября 2021&nbsp;года&nbsp;— хостинговая платформа «Wordpress» от&nbsp;регистратора доменных имён «GoDaddy» подверглась атаке хакеров. В&nbsp;руки злоумышленников попал пароль от&nbsp;панели управления «Wordpress», база данных пользователей и некоторые ключи SSL‑сертификатов. Таким образом хакеры получили доступ к&nbsp;адресам электронной почты и паролям 1,2&nbsp;миллиона активных и неактивных пользователей. 17&nbsp;октября «Go Daddy» обнаружил взлом и только тогда поменял пароль к&nbsp;панели управления «Wordpress» и попросил всех пользователей поменять свои пароли. Однако простой утечкой конфиденциальных данных дело не&nbsp;обошлось. В&nbsp;сентябре и октябре многие сайты на&nbsp;платформе «Wordpress» от «Go Daddy»&nbsp;были заражены вредоносным программным обеспечением. Конечно, компания предприняла меры и «почистила» сайты, но&nbsp;причина заражения выяснилась далеко не&nbsp;сразу. Каким образом пароль от «Wordpress» попал в&nbsp;руки хакеров&nbsp;— неизвестно. Эксперты не&nbsp;исключают, что&nbsp;причиной может&nbsp;быть обычный фишинг. В&nbsp;конце 2020&nbsp;года «Go Daddy» проверил бдительность своих сотрудников, отправив им ссылки на&nbsp;фишинговые сайты. Тест провалили более 500&nbsp;сотрудников.</p>
   <p><strong>Ещё один примером</strong> может служить взлом конструктора сайтов «Web.com» и двух регистраторов доменных имен, которыми он владеет&nbsp;— «NetworkSolutions.com» и «Register.com». «Web.com» выпустил уведомление о&nbsp;безопасности, в&nbsp;котором клиентам сообщалось, что&nbsp;они будут вынуждены сбросить свои пароли при&nbsp;следующем входе в&nbsp;систему. Такие нарушения вызывают особое беспокойство, поскольку клиенты регистраторов доменных имен являются владельцами веб‑сайтов, и, по&nbsp;данным Krebs on Security, около 8,7&nbsp;миллиона из&nbsp;них зарегистрированы в&nbsp;этих компаниях.</p>
   <p>Компания «Web.com» заявила, что «третья сторона получила несанкционированный доступ к&nbsp;ограниченному количеству ее компьютерных систем в&nbsp;конце августа 2019&nbsp;года, и в&nbsp;результате мог&nbsp;быть получен доступ к&nbsp;информации об&nbsp;учетной записи», добавив, что «данные кредитной карты не&nbsp;были скомпрометированы в&nbsp;результате этого инцидента». Однако имя, почтовый адрес, номер телефона, адрес электронной почты и информация об&nbsp;услугах, которые компания предлагала данному владельцу учетной записи,&nbsp;были раскрыты. По&nbsp;словам пострадавших регистраторов доменов, украденная информация включает контактные данные их клиентов, такие как:</p>
   <ul>
    <li><p>имена;</p></li>
    <li><p>адреса;</p></li>
    <li><p>телефонные номера;</p></li>
    <li><p>адрес электронной почты;</p></li>
    <li><p>информация об&nbsp;услугах, предлагаемых заказчику.</p></li>
   </ul>
   <p>Компании также подтвердили, что&nbsp;никакая информация о&nbsp;кредитных картах не&nbsp;была скомпрометирована в&nbsp;результате инцидента с&nbsp;нарушением безопасности, поскольку они утверждают, что&nbsp;шифруют номера кредитных карт своих клиентов перед сохранением в&nbsp;своих базах данных. Следует отметить, что&nbsp;пароли для&nbsp;входа в&nbsp;учетные записи затронутых клиентов также не&nbsp;были скомпрометированы, что&nbsp;в&nbsp;противном случае могло&nbsp;бы позволить злоумышленникам навсегда захватить доменные имена, передав их в&nbsp;учетную запись, принадлежащую злоумышленникам с&nbsp;отдельной службой. Все три затронутых регистратора доменов также связываются с&nbsp;пострадавшими клиентами по&nbsp;электронной почте и через свои веб‑сайты.</p>
   <p>В&nbsp;качестве меры предосторожности затронутым клиентам рекомендуется изменить пароли для&nbsp;своих учетных записей Web.com, Network Solutions и Register.com, а&nbsp;также для&nbsp;любой другой учетной записи в&nbsp;Интернете, где вы используете те&nbsp;же учетные данные.</p>
   <p>Поскольку раскрытые данные включают&nbsp;личную идентификационную информацию (PII), пострадавшие клиенты должны в&nbsp;основном с&nbsp;подозрением относиться к&nbsp;фишинговым электронным письмам, которые обычно являются следующим шагом киберпреступников в&nbsp;попытке обманом заставить пользователей выдать свои пароли и информацию о&nbsp;кредитных картах.</p>
   <p>Хотя утечка данных не&nbsp;привела к&nbsp;раскрытию какой‑либо финансовой информации, всегда полезно проявлять бдительность и внимательно следить за&nbsp;выписками своего банка и платежной карты на&nbsp;предмет любых необычных действий и сообщать в&nbsp;банк, если вы их обнаружите.</p>
   <p>Это не&nbsp;первый случай, когда Web.com сообщает об&nbsp;инциденте, связанном с&nbsp;безопасностью. В&nbsp;августе 2015&nbsp;года в&nbsp;компании произошла серьезная утечка данных, в&nbsp;результате которой&nbsp;были скомпрометированы&nbsp;личные данные и данные кредитных карт, принадлежащие почти 93&nbsp;000&nbsp;клиентов.</p>
   <h4>Потенциальный доступ к коду любого из сайтов</h4>
   <p>Следующий риск&nbsp;— злоумышленник может получить доступ к&nbsp;программному коду любого сайта, что&nbsp;позволит ему изменить код в&nbsp;своих целях. К&nbsp;примеру, хакер может подменить содержимое сайта, т.&nbsp;е. deface&nbsp;— тип взлома сайта, при&nbsp;котором главная (или любая другая) страница веб‑сайта заменяется на&nbsp;другую. Она, как&nbsp;правило, имеет вид рекламы, предупреждения, угрозы. Зачастую доступ ко всему остальному сайту блокируется, или&nbsp;же прежнее содержимое сайта вовсе удаляется. Длительная простойка сайта может нанести финансовый ущерб владельцу сайта.</p>
   <p><strong>Такой взлом</strong> может показаться относительно незначительным, но&nbsp;регистраторы доменных имен продают имена веб‑сайтов и присваивают им IP‑адреса. Таким образом, если злоумышленнику удастся изменить доменное имя, он может получить контроль над всем веб‑сайтом. Например, однажды хакеры взломали регистратора доменных имен бразильского банка и перенаправили пользователей на&nbsp;похожие сайты, которые украли их учетные данные и установили вредоносное ПО. Хакеры успешно скомпрометировали операции бразильского банка, получив контроль над каждым из 36&nbsp;доменов банка, корпоративной электронной почтой и DNS.</p>
   <p>Исследователи «Лаборатории Касперского» Фабио Ассолини и Дмитрий Бестужев обнаружили, что&nbsp;злоумышленники распространили атаку на&nbsp;девять других учреждений. На&nbsp;первый взгляд атака выглядела просто как&nbsp;угон сайта, но&nbsp;Ассолини и Бестужев обнаружили, что&nbsp;происходит гораздо больше. Стало очевидно, что&nbsp;веб‑сайт банка распространяет вредоносное ПО&nbsp;для&nbsp;каждого посетителя. Вредоносная программа представляла собой файл Java, спрятанный внутри ZIP‑архива, загруженного в&nbsp;индексный файл. Каждый посетитель сайта получал плагин с&nbsp;файлом JAR внутри, к&nbsp;тому&nbsp;же злоумышленники получили контроль над индексным файлом сайта. Внутри индекса&nbsp;был загружен iframe, который перенаправлял посетителей на&nbsp;веб‑сайт, с&nbsp;которого&nbsp;было сброшено вредоносное ПО. Копнув глубже, исследователи обнаружили, что&nbsp;на&nbsp;домашней странице отображается действующий сертификат SSL от&nbsp;Let's Encrypt, бесплатного центра сертификации. Все 36&nbsp;банковских доменов оказались под&nbsp;контролем злоумышленников, включая онлайн, мобильные, торговые точки, финансирование и приобретение и многое другое.</p>
   <p>Злоумышленники также находились внутри инфраструктуры корпоративной электронной почты и отключили ее, не&nbsp;позволив банку информировать клиентов об&nbsp;атаке или&nbsp;связаться с&nbsp;их регистратором и DNS‑провайдером.</p>
   <p>Ассолини сказал, что&nbsp;банк&nbsp;был основан в&nbsp;начале 20-го века и управляет 500&nbsp;отделениями в&nbsp;Бразилии, США, Аргентине и на&nbsp;Большом Каймане. Под&nbsp;контролем банка находится 5&nbsp;миллионов клиентов и активы на&nbsp;сумму 25&nbsp;миллиардов долларов.</p>
   <p>Разобрав вредоносное ПО&nbsp;на&nbsp;части, исследователи обнаружили восемь модулей, в&nbsp;том числе файлы конфигурации с&nbsp;URL‑адресами банков, модули обновлений, модули для&nbsp;кражи учетных данных для&nbsp;Microsoft Exchange, Thunderbird и локальной адресной книги, а&nbsp;также модули управления и расшифровки интернет‑банкинга. Исследователи заявили, что&nbsp;все модули общались с&nbsp;сервером управления и контроля в&nbsp;Канаде.</p>
   <p>Один из&nbsp;модулей, называемый Avenger, представляет собой законный инструмент для&nbsp;тестирования на&nbsp;проникновение, используемый для&nbsp;удаления руткитов. Но&nbsp;в&nbsp;данном случае он&nbsp;был изменен для&nbsp;удаления продуктов безопасности, работающих на&nbsp;скомпрометированных компьютерах. Именно с&nbsp;помощью Avenger исследователи определили, что&nbsp;девять других банков по&nbsp;всему миру подверглись аналогичным нападениям и&nbsp;были захвачены.</p>
   <p>Злоумышленники преследовали цель использовать эту возможность, чтобы захватить операции оригинального банка, а&nbsp;также сбросить вредоносное ПО, способное украсть деньги из&nbsp;банков других стран. Исследователи также сообщили об&nbsp;обнаружении фишинговых страниц, загруженных на&nbsp;банковские домены, пытающихся побудить&nbsp;жертв ввести информацию о&nbsp;платежной карте. Также&nbsp;были обнаружены фишинговые электронные письма, нацеленные на&nbsp;местные компании и использующие имя бразильского регистратора. Это может&nbsp;быть путь, который злоумышленники использовали для&nbsp;запуска настроек DNS банка; в&nbsp;какой‑то момент они смогли перенаправить банковский трафик на&nbsp;свои серверы.</p>
   <p>Исследователи подчеркнули <strong>важность защиты инфраструктуры DNS</strong> и необходимость использования таких функций, как&nbsp;двухфакторная аутентификация, которую предлагает большинство регистраторов, но&nbsp;используют&nbsp;лишь немногие клиенты.</p>
   <p><strong>Также</strong> в&nbsp;сети&nbsp;была информация о&nbsp;взломе веб‑сайт органа регистратора доменов Таджикистана (domain.tj), что&nbsp;позволило хакеру получить доступ к&nbsp;панели управления доменом. Иранскому хакеру «Mr.XHat» удалось изменить DNS‑записи атакованных веб‑сайтов и дефейсить их около суток. Хакер рассказал The Hacker News, что&nbsp;использовал уязвимость Directory Traversal для&nbsp;взлома веб‑сайта и по‑прежнему имеет доступ к&nbsp;панели управления.</p>
   <p>Обход каталога&nbsp;— это тип эксплойта HTTP, который используется злоумышленниками для&nbsp;получения несанкционированного доступа к&nbsp;каталогам и файлам с&nbsp;ограниченным доступом.</p>
   <p>На&nbsp;снимке экрана панели управления скомпрометированного регистратора доменов:</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/e8c/80f/ae4/e8c80fae41389b73a678d1aab606ac56.png" alt="Взломанная панель управления регистратором доменов" title="Взломанная панель управления регистратором доменов" width="624" height="342" data-src="https://habrastorage.org/getpro/habr/upload_files/e8c/80f/ae4/e8c80fae41389b73a678d1aab606ac56.png">
    <figcaption>
     Взломанная панель управления регистратором доменов
    </figcaption>
   </figure>
   <p>Хакер утверждал, что&nbsp;имеет Root‑доступ к&nbsp;базе данных Mysql сайта, где пароли клиентов хранятся в&nbsp;хешированном/зашифрованном формате. Чтобы получить доступ к&nbsp;панели домена клиента Twitter/Google, он умело изменил административный адрес электронной почты соответствующих учетных записей на&nbsp;свой собственный адрес электронной почты и приступил к&nbsp;опции восстановления пароля.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/ad6/9ef/840/ad69ef840a50a0ad4417990724fdffd1.png" width="624" height="281" data-src="https://habrastorage.org/getpro/habr/upload_files/ad6/9ef/840/ad69ef840a50a0ad4417990724fdffd1.png">
    <figcaption></figcaption>
   </figure>
   <p>На&nbsp;приведенном выше снимке экрана (предоставленном хакером) показано электронное письмо для&nbsp;восстановления пароля, полученное с&nbsp;новым паролем в&nbsp;виде простого текста, что&nbsp;позволило ему, наконец, получить доступ к&nbsp;панели домена клиента.</p>
   <p>Взломанный домен:</p>
   <p>google.com.tj</p>
   <p>yahoo.com.tj</p>
   <p>twitter.com.tj</p>
   <p>amazon.com.tj</p>
   <p>На&nbsp;момент написания статьи взломанные домены восстанавливаются обратно в&nbsp;исходный DNS, но&nbsp;доступны следующие дефейс‑зеркала:</p>
   <p>https://zone‑h.org/mirror/id/21&nbsp;452&nbsp;417</p>
   <p>https://zone‑h.org/mirror/id/21&nbsp;452&nbsp;420</p>
   <p>https://zone‑h.org/mirror/id/21&nbsp;452&nbsp;426</p>
   <p>https://zone‑h.org/mirror/id/21&nbsp;452&nbsp;428</p>
   <p><strong>Аналогичная </strong>ситуация произошла с&nbsp;Фондом регистрации интернет‑доменов (.NL) в&nbsp;Нидерландах (SIDN), который&nbsp;был скомпрометирован, и хакеры загрузили на&nbsp;их сервер несколько вредоносных файлов.</p>
   <p>Согласно сообщению в&nbsp;блоге, уязвимость SQL‑инъекции изначально использовалась для&nbsp;компрометации одного из&nbsp;веб‑сайтов (25jaarvan.nl ) на&nbsp;том&nbsp;же сервере, что&nbsp;позволило хакеру временно получить доступ к&nbsp;системе регистрации доменных имен.</p>
   <p><strong>В&nbsp;ходе</strong> другой кибератаки несколько бельгийских веб‑сайтов также&nbsp;были повреждены другой группой хакеров. Регистратор доменов за&nbsp;Бельгией, т.&nbsp;е. DNS.be,&nbsp;был скомпрометирован злоумышленниками. Хакеры смогли проникнуть и изменить DNS‑сервер, указав все веб‑сайты на&nbsp;один веб‑сайт, отображающий дефейс‑сообщение.</p>
   <p><strong>Также один их многочисленных хакеров</strong> заявил о&nbsp;взломе сервера nic.gp и утечке учетных данных (зашифрованных) 1271&nbsp;домена Гваделупы и учетных записей пользователей, включая имена пользователей, адреса электронной почты и номера телефонов с&nbsp;сервера и полную базу данных, загруженную на&nbsp;сайт обмена файлами.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/0de/9f4/b5d/0de9f4b5dfdba0baeea153c0a5d44efc.png" width="640" height="324" data-src="https://habrastorage.org/getpro/habr/upload_files/0de/9f4/b5d/0de9f4b5dfdba0baeea153c0a5d44efc.png">
    <figcaption></figcaption>
   </figure>
   <p>В&nbsp;качестве заключения следует отметить, если регистратор домена взломан, злоумышленники могут получить доступ к&nbsp;регистрационной информации домена, включая контактную информацию владельца домена. Это может позволить злоумышленникам передать домен другому регистратору без&nbsp;разрешения владельца домена. Кроме того, злоумышленники могут изменять записи DNS домена, перенаправляя трафик на&nbsp;вредоносные веб‑сайты или&nbsp;блокируя доступ к&nbsp;законным веб‑сайтам. Для&nbsp;регистраторов доменов важно иметь надежные меры безопасности для&nbsp;защиты данных своих клиентов.</p>
   <p>Регистраторы доменов могут защитить себя от&nbsp;хакерских атак, внедрив надежные методы обеспечения безопасности. Это включает в&nbsp;себя:</p>
   <ul>
    <li><p>использование надежных паролей, двухфакторную аутентификацию и регулярное обновление программного обеспечения;</p></li>
    <li><p>использование безопасных протоколов, таких как <strong>SSL/TLS или&nbsp;SSH</strong>, для&nbsp;защиты данных при&nbsp;передаче;</p></li>
    <li><p>необходимо следить за&nbsp;своими серверами на&nbsp;предмет любой подозрительной активности и регулярно создавать резервные копии своих данных на&nbsp;случай атаки;</p></li>
    <li><p>важно разработать комплексный план реагирования на&nbsp;инциденты, чтобы гарантировать, что&nbsp;любые нарушения будут обнаружены и устранены&nbsp;быстро и эффективно.</p></li>
   </ul>
   <p></p>
  </div>
 </div>
</div> <!----> <!---->