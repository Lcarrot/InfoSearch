<div>
 <div class="article-formatted-body article-formatted-body article-formatted-body_version-2">
  <div xmlns="http://www.w3.org/1999/xhtml">
   <p>В 2020&nbsp;году мы выпустили свою DCAP&nbsp;— «СёрчИнформ FileAuditor» для&nbsp;контроля и защиты данных в&nbsp;покое. С&nbsp;тех пор сотни раз презентовали заказчикам, как&nbsp;система полезна «в&nbsp;быту» и помогает держать в&nbsp;порядке корпоративные хранилища. У&nbsp;клиентов собрали статистику: аудит, мол, в 99% случаев выявляет ошибки в&nbsp;распределении прав доступа, неправильное хранение конфиденциальных файлов и перерасход ресурсов. Но&nbsp;прежде всего мы тестируем продукты на&nbsp;себе. Сегодня решили поделиться несколькими кейсами о&nbsp;том, как&nbsp;проверяли собственные файловые хранилища, и показать, что&nbsp;цифра&nbsp;— не&nbsp;преувеличение.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/537/bbe/6ba/537bbe6ba063ce6055c7efbf346dcaae.jpg" width="800" height="544" data-src="https://habrastorage.org/getpro/habr/upload_files/537/bbe/6ba/537bbe6ba063ce6055c7efbf346dcaae.jpg" data-blurred="true">
    <figcaption></figcaption>
   </figure>
   <p>Наш начИБ Алексей Дрозд (aka<a class="mention" href="/users/labyrinth">@labyrinth</a>) рассказывает, как&nbsp;мы поставили эксперимент на&nbsp;себе и что&nbsp;обнаружили.</p>
   <h2>Стартовые данные</h2>
   <p>Основных задач у&nbsp;любой DCAP две: поиск файлов и управление доступом к&nbsp;ним. В&nbsp;этом посте мы поговорим о&nbsp;первой. У&nbsp;нас стояла задача инвентаризации файловых хранилищ. Эксперимент начали с&nbsp;того, чтобы выяснить, как&nbsp;используется дисковое пространство и как&nbsp;хранятся критичные категории документов. Озадачили FileAuditor.</p>
   <p><strong>Он действует по следующей логике:</strong></p>
   <ul>
    <li><p>Сканирует все хранилища и классифицирует файлы в&nbsp;них по&nbsp;содержимому: например, «персданные» или «исходные коды», и присваивает соответствующие метки.</p></li>
    <li><p>Мониторит все операции с&nbsp;файлами: кто, когда и что&nbsp;именно делал с&nbsp;документом, например, перемещал или&nbsp;переименовывал.</p></li>
    <li><p>Вычитывает пользовательские права и находит ошибки в&nbsp;распределении доступов к&nbsp;файлам и папкам, позволяет управлять правами пользователей на&nbsp;совершение определенных операций: «чтение», «изменение», «удаление» и&nbsp;т.&nbsp;п.</p></li>
    <li><p>Блокирует нежелательные действия с&nbsp;файлами по&nbsp;заранее заданным правилам, например, запрещает открывать их с&nbsp;помощью выбранных приложений или&nbsp;прикреплять во&nbsp;вложения в&nbsp;переписке.</p></li>
    <li><p>«Бэкапирует» нужные категории файлов на&nbsp;случай их порчи или&nbsp;утери.</p></li>
   </ul>
   <p>Программа работает через агенты на&nbsp;пользовательских ПК, сетевые папки сканирует, что&nbsp;логично, с&nbsp;помощью сетевой службы. «Фронт работ» для&nbsp;системы составил 170&nbsp;ПК, на&nbsp;каждом в&nbsp;среднем по 750&nbsp;Гб памяти. Несколько подразделений, плюс общие сетевые папки по&nbsp;отделам.</p>
   <p>Заранее оговоримся, что&nbsp;описываем здесь в&nbsp;основном специфические задачи,&nbsp;либо актуальные конкретно для&nbsp;нашей компании,&nbsp;либо нечасто встречающиеся&nbsp;— чтобы показать, как&nbsp;именно настраивали систему. Подавляющее большинство типовых вопросов, вроде категоризации разных видов ПДн, корреспонденции, документов с&nbsp;грифами, договоров, актов, счетов и пр. еще до&nbsp;старта эксперимента «закрыли» с&nbsp;помощью предустановленных правил классификации в&nbsp;FileAuditor. Их в&nbsp;решении больше 80, если что, расскажем о&nbsp;них в&nbsp;комментариях. А&nbsp;пока к&nbsp;делу.</p>
   <h2>Перерасход ресурсов</h2>
   <p>Начали с&nbsp;прикладных задач&nbsp;— некоторые менеджеры жаловались на&nbsp;то, что&nbsp;на&nbsp;машинах мало места. Прежде чем выделять им допресурсы, решили проанализировать, чем забиты их компьютеры. Из&nbsp;клиентских кейсов мы знали, что&nbsp;с&nbsp;FileAuditor освобождают до 40% объема файловых хранилищ, в&nbsp;основном за&nbsp;счет удаления копий, устаревших документов и откровенного «мусора», не&nbsp;имеющего отношения к&nbsp;работе.&nbsp;Было подозрение, что&nbsp;здесь история та&nbsp;же.</p>
   <p>Для&nbsp;ревизии настроили несколько правил. Чтобы централизованно смотреть, сколько документов попали в&nbsp;категорию и сколько они весят, в&nbsp;каждом случае мы использовали отчет «Статистика по&nbsp;ПК» и уже по&nbsp;нему оценивали результаты.</p>
   <h4>1. Поиск тяжелых файлов</h4>
   <p>Самое весомое, что&nbsp;могло храниться у&nbsp;менеджеров&nbsp;— виртуальные машины с&nbsp;нашими продуктами, они используют их для&nbsp;живых демонстраций клиентам. У&nbsp;сейлов, работающих на&nbsp;внутренний рынок, должна&nbsp;была&nbsp;быть только последняя русскоязычная виртуалка. У&nbsp;зарубежных&nbsp;— соответственно, английская.</p>
   <p>Периодически мы выпускаем обновления в&nbsp;виде новых виртуалок, т.к. это более универсальный подход, чем писать инструкции, как&nbsp;перенастроить и что&nbsp;куда добавить в&nbsp;старые. Но&nbsp;менеджеры могли забыть или&nbsp;полениться удалить старые файлы&nbsp;— учитывая, что&nbsp;каждая виртуалка весит по 40–60&nbsp;Гб, это объяснило&nbsp;бы нехватку места.</p>
   <p>В&nbsp;FileAuditor создали «лобовое» правило классификации&nbsp;— по&nbsp;расширению для&nbsp;виртуальных машин «.vdi». Сканирование запустили на&nbsp;всех ПК, но&nbsp;при&nbsp;анализе результатов не&nbsp;учитывали машины тестировщиков и разработки&nbsp;— для&nbsp;них нормально хранить у&nbsp;себя по&nbsp;нескольку сред.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/d98/f55/05e/d98f5505e26055699a0e66c5d986e0ba.png" width="1919" height="1017" data-src="https://habrastorage.org/getpro/habr/upload_files/d98/f55/05e/d98f5505e26055699a0e66c5d986e0ba.png">
    <figcaption></figcaption>
   </figure>
   <p>Образы виртуалок нашли на 17&nbsp;компьютерах, в&nbsp;общей сложности на&nbsp;них лежало 33&nbsp;машины общим весом 1,39&nbsp;Тб. У&nbsp;четверых менеджеров их обнаружили по&nbsp;несколько штук, максимум&nbsp;было 8. Пришлось делать внушения и еще раз напоминать, что&nbsp;старые версии виртуальных машин нужно удалять.</p>
   <h4>2. Поиск мультимедиа</h4>
   <p>Исходили из&nbsp;того, что&nbsp;прямая необходимость работать с&nbsp;аудио и видео есть только у&nbsp;пиарщиков&nbsp;— они готовят медиаконтент. В&nbsp;остальных случаях это риск нерационального использования ресурсов компании: мультимедиа много весят, то есть снова забивают диски, а&nbsp;если их еще и качают в&nbsp;огромных количествах с&nbsp;рабочего Wi‑Fi&nbsp;— без&nbsp;надобности нагружают сеть.</p>
   <p>В&nbsp;FileAuditor создали правило классификации по&nbsp;расширениям файлов&nbsp;— mp4, wav, avi и пр. Сканирование запустили на&nbsp;всех ПК и в&nbsp;сетевых папках, но&nbsp;при&nbsp;анализе результатов не&nbsp;учитывали хранилища PR.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/getpro/habr/upload_files/39f/a9d/a3e/39fa9da3ecc307533939c9ba45e0c3e8.PNG" alt="Настройка правила классификации" title="Настройка правила классификации" width="777" height="480">
    <figcaption>
     Настройка правила классификации
    </figcaption>
   </figure>
   <p>Нашли больше 626&nbsp;Гб потенциального мусора, в&nbsp;топе нарушителей оказались разработчики и тестировщики. На&nbsp;двоих из&nbsp;них пришлась треть всего этого объема&nbsp;— у&nbsp;одного 144, у&nbsp;другого 75&nbsp;Гб музыки. Для&nbsp;сравнения, во&nbsp;всем PR‑отделе с&nbsp;их видеопродакшеном хранится только 25&nbsp;Гб медиа.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/c4c/f49/117/c4cf49117a9011d4391d190aba8f3964.png" alt="Аудиотека одного из сотрудников" title="Аудиотека одного из сотрудников" width="1229" height="663" data-src="https://habrastorage.org/getpro/habr/upload_files/c4c/f49/117/c4cf49117a9011d4391d190aba8f3964.png">
    <figcaption>
     Аудиотека одного из сотрудников
    </figcaption>
   </figure>
   <p>Остальное&nbsp;— условно‑легитимные находки, например, пару сотен Гб занял «ползучий бэкап» записей внутренних обучений. Это вебинары, которые мы проводим для&nbsp;сейлов и других нетехнических подразделений по&nbsp;обновлениям продуктов, потом по&nbsp;ним принимаем экзамен, так что&nbsp;записи выкладываем. Некоторые сохраняют их с&nbsp;NAS на&nbsp;локальные ПК и, опять&nbsp;же, забывают удалить. Из&nbsp;необычного: у&nbsp;сотрудников, которые работают 10+ лет, нашли древние презентации софта и фотки с&nbsp;первых корпоративов. Это настоящая историческая ценность, потому что&nbsp;общий архив стал формироваться позже и там этих данных не&nbsp;было. Находки перенесли туда во&nbsp;имя ностальгии.</p>
   <h4>3. Поиск устаревших документов</h4>
   <p>От&nbsp;топ‑менеджмента&nbsp;была задача&nbsp;— зачистить компы от&nbsp;неактуальной техдокументации. Например, описания с&nbsp;упоминанием продуктов, вышедших из&nbsp;продажи, неактуальных характеристик, старых названий&nbsp;— например, «контроллеры» в&nbsp;КИБ раньше назывались «снифферы», и пр. Если такие документы есть в&nbsp;обороте, это может ввести в&nbsp;заблуждение заказчиков, запутать рабочие процессы, создает простор для&nbsp;махинаций. А&nbsp;если такие файлы лежат, но&nbsp;не&nbsp;используются&nbsp;— это мертвый груз, от&nbsp;которого можно без&nbsp;потерь избавиться.</p>
   <p>Искали по&nbsp;двум параметрам. Во‑первых, в&nbsp;FileAuditor задали правила классификации по&nbsp;тексту: названиям продуктов, с&nbsp;одной стороны, и устаревшим значениям технических требований, с&nbsp;другой. Старыми мы признавали, например, то, где написано <em>sniffer</em>, а&nbsp;не <em>controller</em>. Но&nbsp;со <em>sniffer</em> могли встретиться разные слова, поэтому дополнили правило поиском по&nbsp;последовательности символов.</p>
   <p>Во‑вторых, задали правило классификации по&nbsp;атрибутам: последнее обращение к&nbsp;файлу более 5&nbsp;лет назад&nbsp;— чтобы найти неиспользуемые файлы.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/getpro/habr/upload_files/1c4/ebe/580/1c4ebe5805dd9c6995d9c0665f3a419b.PNG" alt="Настройка правила поиска неиспользуемых документов" title="Настройка правила поиска неиспользуемых документов" width="697" height="679">
    <figcaption>
     Настройка правила поиска неиспользуемых документов
    </figcaption>
   </figure>
   <p>В&nbsp;общей сложности нашлось 2726&nbsp;устаревших документов. У&nbsp;пиарщиков в&nbsp;сетевой папке обнаружился большой архив старых маркетинговых материалов, они&nbsp;же дублировались у&nbsp;менеджеров. Другое дело, что&nbsp;неактуальные технические описания нашлись у&nbsp;программистов, тестировщиков и даже инженеров техподдержки. Некоторые документы активно использовались: по&nbsp;истории операций видно, кто и когда с&nbsp;ними работал. К&nbsp;счастью, заказчикам устаревшие файлы не&nbsp;пересылали, но&nbsp;для&nbsp;подстраховки мы все равно сделали рассылку по&nbsp;компании с&nbsp;рекомендациями, где найти актуальную документацию по&nbsp;продуктам.</p>
   <p>Неиспользуемые файлы нашли абсолютно у&nbsp;всех, правда, в&nbsp;общей сложности всего 214&nbsp;Гб. В&nbsp;большинстве случаев это архивы документов. Часто&nbsp;— «наследство» от&nbsp;бывших сотрудников. По&nbsp;идее передача дел должна способствовать тому, чтобы не&nbsp;останавливались бизнес‑процессы, так что&nbsp;эти находки мы отнесли к&nbsp;условно‑легитимным, но&nbsp;по&nbsp;факту к&nbsp;ним никто не&nbsp;притрагивался. Так что&nbsp;мы кинули клич по&nbsp;начальникам подразделений, чтобы отделы «запарковали» нужные им архивы в&nbsp;сетевых папках. А&nbsp;хлам с&nbsp;ПК велели удалить.</p>
   <p>Дополнительно мы решили избавиться от&nbsp;всех документов в&nbsp;неактуальном дизайне&nbsp;— настоял PR. Несколько лет назад мы провели ребрендинг и сменили фирменный стиль, но&nbsp;по‑прежнему и во&nbsp;внутреннем документообороте, и в&nbsp;материалах для&nbsp;клиентов встречались файлы с&nbsp;устаревшим оформлением.</p>
   <p>Задача оказалась посложнее: в&nbsp;FileAuditor нужно&nbsp;было найти документы разных форматов, типов, содержания. Поэтому настроили поиск по&nbsp;фразе&nbsp;— слогану из&nbsp;старого логотипа, который раньше обязательно размещался в&nbsp;колонтитулах.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/getpro/habr/upload_files/032/4ea/43e/0324ea43e9d306d760e9fde7d0b04607.PNG" alt="Условия поиска документов с устаревшим слоганом" title="Условия поиска документов с устаревшим слоганом" width="982" height="599">
    <figcaption>
     Условия поиска документов с устаревшим слоганом
    </figcaption>
   </figure>
   <p>Документов на&nbsp;старых бланках нашлось порядочно, зато всего у&nbsp;двух сотрудников. Один из&nbsp;них при&nbsp;этом тестировал на «старье» возможности КИБ и самого FileAuditor&nbsp;— забивал ими тестовые машины. Со вторым достаточно&nbsp;было провести беседу, и он старые шаблоны просто удалил. Остальным для&nbsp;профилактики пиарщики напомнили про&nbsp;бренд‑бук.</p>
   <h2>Неправильное хранение</h2>
   <p>Главная цель&nbsp;была найти у&nbsp;сотрудников документы, которых у&nbsp;них&nbsp;быть не&nbsp;должно. Для&nbsp;этого можно&nbsp;было проанализировать бизнес‑процессы&nbsp;— кто задействован в&nbsp;тех или&nbsp;иных операциях, куда перемещаются документы и кому предназначаются. Ищем по&nbsp;сотрудникам, все несовпадения с «эталоном» записываем в&nbsp;нарушения. Второй путь&nbsp;— отталкиваться от&nbsp;документов и фиксировать нарушения, если эти документы обнаруживаются не&nbsp;там, где нужно. Второй путь проще, когда речь о&nbsp;больших массивах и большом количестве сотрудников.</p>
   <p>Когда ставили ТЗ, что&nbsp;искать, мы опирались на&nbsp;операционные риски. Например, любое хранение и обработка персданных строго регламентируются ФЗ-152, нарушения грозят штрафами. Еще учитывали вероятность мошенничества, «боковиков» и других угроз экономической безопасности. Итого искали документы из&nbsp;категории «ПД» и подозрительные файлы, которые указывали&nbsp;бы на&nbsp;махинации.</p>
   <h4>1. Поиск персданных</h4>
   <p>Проиллюстрируем задачу на&nbsp;поиске сканов паспортов. В&nbsp;эксперименте не&nbsp;участвовали ПК кадровиков и бухгалтерии, так что&nbsp;любая находка по&nbsp;этому правилу приравнивалась к&nbsp;нарушению&nbsp;— зачем другим сотрудникам хранить у&nbsp;себя паспорта?</p>
   <p>В&nbsp;FileAuditor настроили поиск по&nbsp;регулярным выражениям (номер паспорта), плюс подключили OCR, чтобы вычитывать текст с&nbsp;изображений. Для&nbsp;верности уточнили запрос фразовым поиском: задали слова «Паспорт», «Выдан» и пр. И выставили атрибуты, чтобы под&nbsp;правило попадали только файлы графических форматов.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/8f8/5ce/934/8f85ce934d0e4026b7563d03f9165e93.png" alt="Настройка правила классификации по поиску паспортов" title="Настройка правила классификации по поиску паспортов" width="1233" height="667" data-src="https://habrastorage.org/getpro/habr/upload_files/8f8/5ce/934/8f85ce934d0e4026b7563d03f9165e93.png">
    <figcaption>
     Настройка правила классификации по поиску паспортов
    </figcaption>
   </figure>
   <p>Коллектив у&nbsp;нас дисциплинированный, так что «сработок» по&nbsp;сути не&nbsp;было. Чужие персональные данные обнаружились у&nbsp;одного сотрудника, и у&nbsp;того по&nbsp;недоразумению. Выяснилось, проблема в&nbsp;общем сканере. В&nbsp;нем есть возможность сканировать сразу в&nbsp;папку определённого ПК. Компьютеры выбираются в&nbsp;МФУ из&nbsp;списка перед сканированием. Некоторые сотрудники ошибочно, на&nbsp;автомате, выбирали первый компьютер из&nbsp;списка. В&nbsp;итоге на&nbsp;этом ПК без&nbsp;ведома владельца (потому что&nbsp;сотрудники забывали ему сказать, а&nbsp;он сам в&nbsp;папку «Документы» не&nbsp;заглядывал) скопилась куча самых разных сканов. В&nbsp;том числе и паспорт, который мы нашли.</p>
   <h4>2. Поиск чужих уставов</h4>
   <p>Уставные документы сторонних компаний на&nbsp;ПК сотрудников&nbsp;— это риск, что&nbsp;они мошенничают: например, в&nbsp;сговоре с&nbsp;подрядчиком или&nbsp;ведут «боковой» бизнес.</p>
   <p>В&nbsp;FileAuditor настроили правило на&nbsp;поиск похожих. Загрузили в&nbsp;качестве образца пример устава, в&nbsp;исключения задали название и реквизиты нашей компании&nbsp;— вуаля.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/getpro/habr/upload_files/36c/d3d/a79/36cd3da793037d95c96bb518aef9b7be.PNG" alt="Настройка правила классификации" title="Настройка правила классификации" width="783" height="595">
    <figcaption>
     Настройка правила классификации
    </figcaption>
   </figure>
   <p>Нашлось несколько таких документов, все у&nbsp;тестировщиков. На&nbsp;проверку эти уставы оказались скачанными из&nbsp;сети «болванками» для&nbsp;ООО «Ромашка»&nbsp;— на&nbsp;них сотрудники тестировали поиск уставов в&nbsp;нашей&nbsp;же DLP и в&nbsp;самом FileAuditor.</p>
   <figure class="full-width ">
    <img src="https://habrastorage.org/r/w1560/getpro/habr/upload_files/222/44c/e3b/22244ce3b2c0d1ecbf57627d82508480.png" alt="Один из найденных тестовых уставов" title="Один из найденных тестовых уставов" width="1221" height="658" data-src="https://habrastorage.org/getpro/habr/upload_files/222/44c/e3b/22244ce3b2c0d1ecbf57627d82508480.png">
    <figcaption>
     Один из найденных тестовых уставов
    </figcaption>
   </figure>
   <p>Кстати, почти также настроены стандартные правила классификации, о&nbsp;которых мы говорили выше, с&nbsp;ними можно искать любые типовые документы&nbsp;— акты, счета‑фактуры и&nbsp;т.&nbsp;п., избегая ложно‑позитивных сработок. То есть решать с&nbsp;DCAP не&nbsp;только задачи безопасности (в данном случае экономической), но&nbsp;и обычной организации документооборота.</p>
   <h3>Немного выводов</h3>
   <p>Как&nbsp;и ожидалось, в&nbsp;ходе эксперимента недочеты у&nbsp;нас нашлись. Аудит пошел на&nbsp;пользу. Пусть не&nbsp;в&nbsp;гигантских объемах, но&nbsp;мы расчистили место на&nbsp;дисках, еще некоторый «буст» дали профилактические беседы&nbsp;— теперь, когда сотрудники в&nbsp;курсе, что&nbsp;мы проверяем хранение файлов, постараются держать их в&nbsp;порядке. К&nbsp;тому&nbsp;же аудит помог проверить «на прочность» бизнес‑процессы&nbsp;— некоторые мы скорректировали, получили пищу для&nbsp;ума на&nbsp;будущее.</p>
   <p>Бороться с&nbsp;перерасходом ресурсов&nbsp;— не&nbsp;типичная задача для&nbsp;ИБ, но&nbsp;это только первый шаг. В&nbsp;следующих постах расскажем, как&nbsp;провели аудит доступов и разобрались с&nbsp;правами пользователей. Если интересно, в&nbsp;комментариях покажем в&nbsp;деталях, как&nbsp;настраивали те или&nbsp;иные правила. А&nbsp;пока рекомендуем наведаться в&nbsp;блог к <a class="mention" href="/users/labyrinth">@labyrinth</a> : на&nbsp;примере <a href="https://habr.com/ru/company/searchinform/blog/694432/">поиска аддонов в&nbsp;браузеры</a> он в&nbsp;подробностях разбирал, как&nbsp;настраивается и работает наш DCAP.</p>
   <p>А&nbsp;если вдруг хотите попробовать его на&nbsp;себе&nbsp;— мы как&nbsp;раз раздаем&nbsp;лицензии бесплатно, принимаем заявки до 31&nbsp;марта. FileAuditor будет у&nbsp;вас в&nbsp;полном доступе и функционале на&nbsp;три месяца, как&nbsp;раз успеете навести в&nbsp;порядок. Все подробности <a href="https://searchinform.ru/landing/promotion-free-fileauditor/">тут</a>.</p>
   <p></p>
  </div>
 </div>
</div> <!----> <!---->